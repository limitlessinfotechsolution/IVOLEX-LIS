const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-DEuKUYMk.js","./ui-CD5jAkwB.js","./router-D6lRyHch.js","./vendor-C9RBa7uG.js","./ProductCard-CFoiyVgD.js","./products-CPcclmZv.js","./LoadingStates-D4v6MwSW.js","./forms-lfeZys1X.js","./toast-DoQNyf63.js","./index-RE76x7Xw.js","./index-DahDUUx4.js","./index-DiSeqCTk.js","./index-Wgj6KwTe.js","./index-BhYLaJ33.js","./index-BpR62VLZ.js","./index-DA7mI3mI.js","./index-7LxpwIIr.js","./index-BUYbulB-.js","./index-B6nXnTW6.js","./index-B1YrhCbm.js","./index-b-n7tYlV.js","./index-BtwGgWBW.js","./index-CDt0YFxk.js","./TrackingPage-CWhtBZv6.js","./AdminPanel-BH2IPLDL.js","./AdminAuthContext-DbkUnQi9.js","./AdminLogin-tkM5htSf.js","./AuthScreen-iLidhm7N.js","./index-0GozZ-s-.js"])))=>i.map(i=>d[i]);
import{j as e,S as t,a as r,P as s,m as i,A as n,b as a,X as o,F as c,c as l,C as d,T as u,B as h,d as m,I as p,e as f,f as g,U as y,g as v,M as b,G as w,h as x,i as _,k as S,l as E,n as T,o as k,p as A,Y as j,R as O,H as P,q as C}from"./ui-CD5jAkwB.js";import{r as R,R as N,u as I,B as D,a as L,b as $}from"./router-D6lRyHch.js";import{a as U,b as M,g as F}from"./vendor-C9RBa7uG.js";import{n as B,F as H}from"./toast-DoQNyf63.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var z,G={};var W=function(){if(z)return G;z=1;var e=U();return G.createRoot=e.createRoot,G.hydrateRoot=e.hydrateRoot,G}();const V={},q=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};const i=document.getElementsByTagName("link"),n=document.querySelector("meta[property=csp-nonce]"),a=n?.nonce||n?.getAttribute("nonce");s=e(t.map(e=>{if(e=function(e,t){return new URL(e,t).href}(e,r),e in V)return;V[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(r)for(let r=i.length-1;r>=0;r--){const s=i[r];if(s.href===e&&(!t||"stylesheet"===s.rel))return}else if(document.querySelector(`link[href="${e}"]${s}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script"),n.crossOrigin="",n.href=e,a&&n.setAttribute("nonce",a),document.head.appendChild(n),t?new Promise((t,r)=>{n.addEventListener("load",t),n.addEventListener("error",()=>r(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function i(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return s.then(t=>{for(const e of t||[])"rejected"===e.status&&i(e.reason);return e().catch(i)})},K={leather:{id:"leather",name:"Leather",slug:"leather",colors:{primary:"#4E342E",secondary:"#8D6E63",accent:"#C6A15B",background:"#F5E9DA",surface:"#FFFFFF",foreground:"#2E2E2E",muted:"#6B4423",border:"#D4B896",ring:"#C6A15B"},texture:{background:"linear-gradient(135deg, #F5E9DA 0%, #E8D5C1 100%)",overlay:'url("data:image/svg+xml,%3Csvg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%234E342E" fill-opacity="0.02"%3E%3Cpath d="M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")',card:"linear-gradient(145deg, #FFFFFF 0%, #FAF7F0 100%)"},shadows:{sm:"0 2px 8px rgba(78, 52, 46, 0.08)",md:"0 4px 16px rgba(78, 52, 46, 0.12)",lg:"0 8px 32px rgba(78, 52, 46, 0.16)",xl:"0 16px 64px rgba(78, 52, 46, 0.20)"},motion:{duration:{fast:"200ms",normal:"300ms",slow:"400ms"},easing:{default:"cubic-bezier(0.25, 0.1, 0.25, 1)",spring:"cubic-bezier(0.34, 1.56, 0.64, 1)",smooth:"cubic-bezier(0.4, 0, 0.2, 1)"}},borderRadius:{sm:"0.375rem",md:"0.5rem",lg:"0.75rem",xl:"1rem","2xl":"1.5rem",full:"9999px"},spacing:{section:"5rem",component:"2rem"}},electronics:{id:"electronics",name:"Electronics",slug:"electronics",colors:{primary:"#2962FF",secondary:"#212121",accent:"#00E5FF",background:"#FFFFFF",surface:"#F8F9FA",foreground:"#212121",muted:"#5C6BC0",border:"#E3F2FD",ring:"#2962FF"},texture:{background:"linear-gradient(135deg, #FFFFFF 0%, #F8F9FA 100%)",overlay:"radial-gradient(circle at 50% 50%, rgba(41, 98, 255, 0.03) 0%, transparent 50%)",card:"linear-gradient(145deg, #FFFFFF 0%, #F5F7FA 100%)"},shadows:{sm:"0 2px 8px rgba(41, 98, 255, 0.08)",md:"0 4px 16px rgba(41, 98, 255, 0.12)",lg:"0 8px 32px rgba(41, 98, 255, 0.16)",xl:"0 16px 64px rgba(41, 98, 255, 0.20)"},motion:{duration:{fast:"150ms",normal:"200ms",slow:"250ms"},easing:{default:"cubic-bezier(0.4, 0, 0.2, 1)",spring:"cubic-bezier(0.68, -0.55, 0.265, 1.55)",smooth:"cubic-bezier(0.25, 0.46, 0.45, 0.94)"}},borderRadius:{sm:"0.25rem",md:"0.375rem",lg:"0.5rem",xl:"0.75rem","2xl":"1rem",full:"9999px"},spacing:{section:"4rem",component:"1.5rem"}},furniture:{id:"furniture",name:"Furniture & Interiors",slug:"furniture",colors:{primary:"#2E7D32",secondary:"#D7CCC8",accent:"#8BC34A",background:"#FAF7F2",surface:"#FFFFFF",foreground:"#424242",muted:"#81C784",border:"#E8F5E8",ring:"#2E7D32"},texture:{background:"linear-gradient(135deg, #FAF7F2 0%, #F5F2ED 100%)",overlay:'url("data:image/svg+xml,%3Csvg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="%232E7D32" fill-opacity="0.03" fill-rule="evenodd"%3E%3Cpath d="M0 40L40 0H20L0 20M40 40V20L20 40"/%3E%3C/g%3E%3C/svg%3E")',card:"linear-gradient(145deg, #FFFFFF 0%, #FDFCF8 100%)"},shadows:{sm:"0 2px 8px rgba(46, 125, 50, 0.08)",md:"0 4px 16px rgba(46, 125, 50, 0.12)",lg:"0 8px 32px rgba(46, 125, 50, 0.16)",xl:"0 16px 64px rgba(46, 125, 50, 0.20)"},motion:{duration:{fast:"180ms",normal:"280ms",slow:"350ms"},easing:{default:"cubic-bezier(0.25, 0.1, 0.25, 1)",spring:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",smooth:"cubic-bezier(0.4, 0, 0.2, 1)"}},borderRadius:{sm:"0.5rem",md:"0.75rem",lg:"1rem",xl:"1.25rem","2xl":"1.75rem",full:"9999px"},spacing:{section:"6rem",component:"2.5rem"}}},J="SET_SEGMENT",Y="SET_LOADING",Z="SET_ERROR",X={activeSegment:"leather",theme:K.leather,isLoading:!1,error:null};function Q(e,t){switch(t.type){case J:return{...e,activeSegment:t.payload,theme:K[t.payload],error:null};case Y:return{...e,isLoading:t.payload};case Z:return{...e,error:t.payload,isLoading:!1};default:return e}}const ee=R.createContext();function te({children:t}){const[r,s]=R.useReducer(Q,X);R.useEffect(()=>{const e=window.location.pathname.split("/")[1];if(K[e])s({type:J,payload:e}),localStorage.setItem("ivolex_segment",e);else{const e=localStorage.getItem("ivolex_segment");e&&K[e]&&s({type:J,payload:e})}},[]),R.useEffect(()=>{const e=document.documentElement,t=r.theme;t&&(Object.entries(t.colors).forEach(([t,r])=>{e.style.setProperty(`--color-${t}`,r)}),Object.entries(t.shadows).forEach(([t,r])=>{e.style.setProperty(`--shadow-${t}`,r)}),Object.entries(t.motion.duration).forEach(([t,r])=>{e.style.setProperty(`--duration-${t}`,r)}),Object.entries(t.motion.easing).forEach(([t,r])=>{e.style.setProperty(`--easing-${t}`,r)}),Object.entries(t.borderRadius).forEach(([t,r])=>{e.style.setProperty(`--radius-${t}`,r)}),Object.entries(t.spacing).forEach(([t,r])=>{e.style.setProperty(`--spacing-${t}`,r)}),e.style.setProperty("--bg-texture",t.texture.background),e.style.setProperty("--bg-overlay",t.texture.overlay),e.style.setProperty("--bg-card",t.texture.card),document.body.className=document.body.className.replace(/segment-\w+/g,""),document.body.classList.add(`segment-${r.activeSegment}`))},[r.theme,r.activeSegment]);const i={...r,segments:Object.values(K),setSegment:e=>{if(K[e]){s({type:J,payload:e}),localStorage.setItem("ivolex_segment",e);const t=`/${e}`;window.location.pathname!==t&&window.history.pushState({},"",t)}},isCurrentSegment:e=>r.activeSegment===e};return e.jsx(ee.Provider,{value:i,children:t})}function re(){const e=R.useContext(ee);if(!e)throw new Error("useSegment must be used within a SegmentProvider");return e}const se={leather:s,electronics:r,furniture:t},ie={leather:"Premium leather goods & accessories",electronics:"Cutting-edge electronic devices",furniture:"Elegant furniture & interior design"};function ne({variant:t="default",className:r=""}){const{activeSegment:s,segments:a,setSegment:o,theme:c}=re(),l=e=>{e!==s&&o(e)};return"pills"===t?e.jsx("div",{className:`flex items-center gap-2 ${r}`,children:a.map(t=>{const r=se[t.id],n=t.id===s;return e.jsxs(i.button,{onClick:()=>l(t.id),className:"relative flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all duration-200 "+(n?"text-white shadow-segment-md":"text-foreground/60 hover:text-foreground hover:bg-surface"),style:{backgroundColor:n?c.colors.primary:"transparent"},whileHover:{scale:1.05},whileTap:{scale:.95},layout:!0,children:[e.jsx(r,{size:16}),e.jsx("span",{children:t.name}),n&&e.jsx("div",{className:"absolute -bottom-1 left-1/2 w-2 h-2 bg-white rounded-full",style:{transform:"translateX(-50%)"}})]},t.id)})}):e.jsxs("div",{className:`w-full ${r}`,children:[e.jsx("div",{className:"flex border-b border-border",children:a.map(t=>{const r=se[t.id],a=t.id===s;return e.jsxs(i.button,{onClick:()=>l(t.id),className:"relative flex items-center gap-3 px-6 py-4 text-sm font-medium transition-all duration-200 border-b-2 "+(a?"text-primary border-primary":"text-foreground/60 border-transparent hover:text-foreground hover:border-foreground/20"),whileHover:{y:-1},whileTap:{y:0},children:[e.jsx(r,{size:18}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"leading-tight",children:t.name}),e.jsx("div",{className:"text-xs text-foreground/40 mt-0.5 leading-tight",children:ie[t.id]})]}),e.jsx(n,{children:a&&e.jsx(i.div,{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary",layoutId:"activeTab",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},style:{backgroundColor:c.colors.primary}})})]},t.id)})}),e.jsx(n,{mode:"wait",children:e.jsx(i.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3,ease:"easeInOut"},className:"py-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-foreground mb-2 leading-tight",children:a.find(e=>e.id===s)?.name}),e.jsx("p",{className:"text-foreground/60 leading-tight",children:ie[s]})]})},s)})]})}function ae({className:t="",isExpanded:r=!1}){const{activeSegment:s,segments:n,setSegment:a,theme:o}=re(),c=t?.includes("flex-col")||r;return e.jsx("div",{className:`flex items-center bg-surface/80 backdrop-blur-md rounded-full p-1 shadow-segment-md ${t}`,children:n.map(t=>{const r=se[t.id],n=t.id===s;return e.jsxs(i.button,{onClick:()=>a(t.id),className:`relative flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium transition-all duration-200 ${n?"text-white shadow-sm":"text-foreground/60 hover:text-foreground"} ${c?"w-full justify-start mb-1 last:mb-0":""}`,style:{backgroundColor:n?o.colors.primary:"transparent"},whileHover:{scale:1.05},whileTap:{scale:.95},layout:!0,children:[e.jsx(r,{size:14}),e.jsx("span",{className:`${c?"inline":"hidden sm:inline"} ${n?"text-white":""}`,children:t.name}),!c&&n&&e.jsx("div",{className:"absolute -bottom-1 left-1/2 w-1 h-1 bg-white rounded-full sm:hidden",style:{transform:"translateX(-50%)"}})]},t.id)})})}const oe={en:{code:"en",name:"English",nativeName:"English",dir:"ltr",flag:"🇺🇸"},hi:{code:"hi",name:"Hindi",nativeName:"हिन्दी",dir:"ltr",flag:"🇮🇳"},ar:{code:"ar",name:"Arabic",nativeName:"العربية",dir:"rtl",flag:"🇸🇦"}},ce={en:{"nav.home":"Home","nav.shop":"Shop","nav.products":"Products","nav.categories":"Categories","nav.customize":"Customize","nav.about":"About","nav.contact":"Contact","nav.cart":"Cart","nav.search":"Search","common.loading":"Loading...","common.error":"Error","common.success":"Success","common.cancel":"Cancel","common.save":"Save","common.delete":"Delete","common.edit":"Edit","common.view":"View","common.close":"Close","common.submit":"Submit","common.continue":"Continue","common.back":"Back","common.next":"Next","common.previous":"Previous","common.finish":"Finish","common.price":"Price","common.quantity":"Quantity","common.total":"Total","common.subtotal":"Subtotal","common.shipping":"Shipping","common.tax":"Tax","common.discount":"Discount","hero.leather.headline":"Timeless Leather Craftsmanship","hero.leather.subheadline":"Experience the finest handcrafted leather goods, where tradition meets modern elegance","hero.electronics.headline":"Cutting-Edge Technology","hero.electronics.subheadline":"Discover the future of electronics with innovative devices that enhance your digital lifestyle","hero.furniture.headline":"Elegant Interior Design","hero.furniture.subheadline":"Transform your space with premium furniture and décor that reflects your unique style","hero.cta":"Explore Collection","hero.video":"Watch Our Story","hero.scroll":"Scroll to explore","products.featured":"Featured Products","products.trending":"Trending Products","products.new":"New Arrivals","products.bestsellers":"Best Sellers","products.sale":"On Sale","products.outOfStock":"Out of Stock","products.inStock":"In Stock","products.addToCart":"Add to Cart","products.buyNow":"Buy Now","products.quickView":"Quick View","products.addToWishlist":"Add to Wishlist","products.viewDetails":"View Details","products.specifications":"Specifications","products.features":"Features","products.reviews":"Reviews","products.rating":"Rating","products.noProducts":"No products found","categories.leather.bags":"Bags","categories.leather.wallets":"Wallets","categories.leather.belts":"Belts","categories.leather.accessories":"Accessories","categories.electronics.audio":"Audio","categories.electronics.wearables":"Wearables","categories.electronics.accessories":"Accessories","categories.furniture.office":"Office","categories.furniture.seating":"Seating","categories.furniture.storage":"Storage","cart.title":"Shopping Cart","cart.empty":"Your cart is empty","cart.continueShopping":"Continue Shopping","cart.checkout":"Proceed to Checkout","cart.remove":"Remove","cart.update":"Update","cart.itemAdded":"Item added to cart","cart.itemRemoved":"Item removed from cart","customize.title":"Custom Request","customize.subtitle":"Tell us about your vision, and our experts will bring it to life","customize.contact.title":"Contact Information","customize.project.title":"Project Details","customize.requirements.title":"Requirements & Specifications","customize.files.title":"Files & References","customize.timeline.title":"Timeline & Budget","customize.review.title":"Review & Submit","customize.success":"Request submitted successfully!","customize.error":"Failed to submit request","footer.quickLinks":"Quick Links","footer.customerService":"Customer Service","footer.followUs":"Follow Us","footer.newsletter":"Newsletter","footer.newsletterText":"Subscribe to get updates on new products and offers","footer.subscribe":"Subscribe","footer.copyright":"© 2024 IVOLEX. All rights reserved.","admin.dashboard":"Dashboard","admin.shop":"Shop Management","admin.advancedAnalytics":"Advanced Analytics","admin.products":"Products","admin.orders":"Orders","admin.payments":"Payments","admin.customers":"Customers","admin.profile":"Profile","admin.analytics":"Analytics","admin.indiaAnalytics":"India Analytics","admin.recommendations":"Recommendations","admin.security":"Security Center","admin.settings":"Settings","admin.revenue":"Revenue","admin.totalOrders":"Total Orders","admin.totalCustomers":"Total Customers","admin.conversionRate":"Conversion Rate"},ar:{"nav.home":"الرئيسية","nav.shop":"المتجر","nav.products":"المنتجات","nav.categories":"الفئات","nav.customize":"تخصيص","nav.about":"حول","nav.contact":"اتصل","nav.cart":"العربة","nav.search":"بحث","common.loading":"جاري التحميل...","common.error":"خطأ","common.success":"نجح","common.cancel":"إلغاء","common.save":"حفظ","common.delete":"حذف","common.edit":"تعديل","common.view":"عرض","common.close":"إغلاق","common.submit":"إرسال","common.continue":"متابعة","common.back":"رجوع","common.next":"التالي","common.previous":"السابق","common.finish":"إنهاء","common.price":"السعر","common.quantity":"الكمية","common.total":"المجموع","common.subtotal":"المجموع الفرعي","common.shipping":"الشحن","common.tax":"الضريبة","common.discount":"الخصم","hero.leather.headline":"صناعة الجلود الخالدة","hero.leather.subheadline":"اكتشف أجود المنتجات الجلدية المصنوعة يدوياً، حيث تلتقي التقاليد بالأناقة العصرية","hero.electronics.headline":"التكنولوجيا المتطورة","hero.electronics.subheadline":"اكتشف مستقبل الإلكترونيات مع الأجهزة المبتكرة التي تعزز نمط حياتك الرقمي","hero.furniture.headline":"التصميم الداخلي الأنيق","hero.furniture.subheadline":"حول مساحتك بأثاث وديكور فاخر يعكس أسلوبك الفريد","hero.cta":"استكشف المجموعة","hero.video":"شاهد قصتنا","hero.scroll":"مرر للاستكشاف","products.featured":"المنتجات المميزة","products.trending":"المنتجات الرائجة","products.new":"الوافدات الجديدة","products.bestsellers":"الأكثر مبيعاً","products.sale":"في التخفيضات","products.outOfStock":"نفد المخزون","products.inStock":"متوفر","products.addToCart":"أضف للعربة","products.buyNow":"اشتر الآن","products.quickView":"عرض سريع","products.addToWishlist":"أضف للمفضلة","products.viewDetails":"عرض التفاصيل","products.specifications":"المواصفات","products.features":"الميزات","products.reviews":"التقييمات","products.rating":"التقييم","products.noProducts":"لم يتم العثور على منتجات","categories.leather.bags":"الحقائب","categories.leather.wallets":"المحافظ","categories.leather.belts":"الأحزمة","categories.leather.accessories":"الإكسسوارات","categories.electronics.audio":"الصوتيات","categories.electronics.wearables":"الأجهزة القابلة للارتداء","categories.electronics.accessories":"الإكسسوارات","categories.furniture.office":"المكتب","categories.furniture.seating":"الجلوس","categories.furniture.storage":"التخزين","cart.title":"عربة التسوق","cart.empty":"عربة التسوق فارغة","cart.continueShopping":"متابعة التسوق","cart.checkout":"الدفع","cart.remove":"إزالة","cart.update":"تحديث","cart.itemAdded":"تم إضافة العنصر للعربة","cart.itemRemoved":"تم إزالة العنصر من العربة","customize.title":"طلب مخصص","customize.subtitle":"أخبرنا عن رؤيتك، وسيقوم خبراؤنا بتحقيقها","customize.contact.title":"معلومات الاتصال","customize.project.title":"تفاصيل المشروع","customize.requirements.title":"المتطلبات والمواصفات","customize.files.title":"الملفات والمراجع","customize.timeline.title":"الجدول الزمني والميزانية","customize.review.title":"المراجعة والإرسال","customize.success":"تم إرسال الطلب بنجاح!","customize.error":"فشل في إرسال الطلب","footer.quickLinks":"روابط سريعة","footer.customerService":"خدمة العملاء","footer.followUs":"تابعنا","footer.newsletter":"النشرة الإخبارية","footer.newsletterText":"اشترك للحصول على تحديثات المنتجات والعروض الجديدة","footer.subscribe":"اشترك","footer.copyright":"© 2024 إيفوليكس. جميع الحقوق محفوظة.","admin.dashboard":"لوچे का पैनल","admin.products":"उत्पाद","admin.orders":"ऑर्डर","admin.customers":"ग्राहक","admin.analytics":"विश्लेषण","admin.settings":"सेटिंग्स","admin.revenue":"आय","admin.totalOrders":"कुल ऑर्डर","admin.totalCustomers":"कुल ग्राहक","admin.conversionRate":"रूपांतरण दर"},hi:{"nav.home":"मुख्य पृष्ठ","nav.products":"उत्पाद","nav.categories":"श्रेणियाँ","nav.customize":"अनुकूलित करें","nav.about":"हमारे बारे में","nav.contact":"संपर्क","nav.cart":"कार्ट","nav.search":"खोजें","common.loading":"लोड हो रहा है...","common.error":"त्रुटि","common.success":"सफल","common.cancel":"रद्द करें","common.save":"सेव करें","common.delete":"हटाएं","common.edit":"संपादित करें","common.view":"देखें","common.close":"बंद करें","common.submit":"जमा करें","common.continue":"जारी रखें","common.back":"वापस","common.next":"अगला","common.previous":"पिछला","common.finish":"समाप्त","common.price":"कीमत","common.quantity":"मात्रा","common.total":"कुल","common.subtotal":"उप-योग","common.shipping":"शिपिंग","common.tax":"कर","common.discount":"छूट","hero.leather.headline":"शाश्वत चमड़े का शिल्प","hero.leather.subheadline":"बेहतरीन हस्तनिर्मित चमड़े के सामान का अनुभव करें, जहां परंपरा आधुनिक लालित्य से मिलती है","hero.electronics.headline":"अत्याधुनिक तकनीक","hero.electronics.subheadline":"नवाचार भरे उपकरणों के साथ इलेक्ट्रॉनिक्स का भविष्य खोजें जो आपकी डिजिटल जीवनशैली को बेहतर बनाते हैं","hero.furniture.headline":"सुरुचिपूर्ण इंटीरियर डिज़ाइन","hero.furniture.subheadline":"प्रीमियम फर्नीचर और सजावट के साथ अपने स्थान को रूपांतरित करें जो आपकी अनूठी शैली को दर्शाता है","hero.cta":"संग्रह देखें","hero.video":"हमारी कहानी देखें","hero.scroll":"खोजने के लिए स्क्रॉल करें","products.featured":"विशेष उत्पाद","products.trending":"ट्रेंडिंग उत्पाद","products.new":"नई आवक","products.bestsellers":"सबसे ज्यादा बिकने वाले","products.sale":"सेल में","products.outOfStock":"स्टॉक समाप्त","products.inStock":"स्टॉक में","products.addToCart":"कार्ट में जोड़ें","products.buyNow":"अभी खरीदें","products.quickView":"त्वरित दृश्य","products.addToWishlist":"विशलिस्ट में जोड़ें","products.viewDetails":"विवरण देखें","products.specifications":"विशिष्टताएं","products.features":"सुविधाएं","products.reviews":"समीक्षाएं","products.rating":"रेटिंग","products.noProducts":"कोई उत्पाद नहीं मिला","categories.leather.bags":"बैग","categories.leather.wallets":"वॉलेट","categories.leather.belts":"बेल्ट","categories.leather.accessories":"एक्सेसरीज","categories.electronics.audio":"ऑडियो","categories.electronics.wearables":"पहनने योग्य","categories.electronics.accessories":"एक्सेसरीज","categories.furniture.office":"ऑफिस","categories.furniture.seating":"बैठने की जगह","categories.furniture.storage":"भंडारण","cart.title":"शॉपिंग कार्ट","cart.empty":"आपका कार्ट खाली है","cart.continueShopping":"खरीदारी जारी रखें","cart.checkout":"चेकआउट पर जाएं","cart.remove":"हटाएं","cart.update":"अपडेट करें","cart.itemAdded":"आइटम कार्ट में जोड़ा गया","cart.itemRemoved":"आइटम कार्ट से हटाया गया","customize.title":"कस्टम अनुरोध","customize.subtitle":"हमें अपने विज़न के बारे में बताएं, और हमारे विशेषज्ञ इसे जीवंत बना देंगे","customize.contact.title":"संपर्क जानकारी","customize.project.title":"प्रोजेक्ट विवरण","customize.requirements.title":"आवश्यकताएं और विशिष्टताएं","customize.files.title":"फाइलें और संदर्भ","customize.timeline.title":"समयसीमा और बजट","customize.review.title":"समीक्षा और जमा करें","customize.success":"अनुरोध सफलतापूर्वक जमा किया गया!","customize.error":"अनुरोध जमा करने में विफल","footer.quickLinks":"त्वरित लिंक","footer.customerService":"ग्राहक सेवा","footer.followUs":"हमें फॉलो करें","footer.newsletter":"न्यूज़लेटर","footer.newsletterText":"नए उत्पादों और ऑफर्स की अपडेट पाने के लिए सब्स्क्राइब करें","footer.subscribe":"सब्स्क्राइब करें","footer.copyright":"© 2024 IVOLEX. सभी अधिकार सुरक्षित।","admin.dashboard":"डैशबोर्ड","admin.products":"उत्पाद","admin.orders":"ऑर्डर","admin.customers":"ग्राहक","admin.analytics":"विश्लेषण","admin.settings":"सेटिंग्स","admin.revenue":"आय","admin.totalOrders":"कुल ऑर्डर","admin.totalCustomers":"कुल ग्राहक","admin.conversionRate":"रूपांतरण दर"}},le={INR:{code:"INR",symbol:"₹",name:"Indian Rupee",locale:"en-IN",position:"before"},SAR:{code:"SAR",symbol:"ر.س",name:"Saudi Riyal",locale:"ar-SA",position:"after"},USD:{code:"USD",symbol:"$",name:"US Dollar",locale:"en-US",position:"before"},EUR:{code:"EUR",symbol:"€",name:"Euro",locale:"en-EU",position:"after"},GBP:{code:"GBP",symbol:"£",name:"British Pound",locale:"en-GB",position:"before"}},de="SET_LANGUAGE",ue="SET_CURRENCY",he="SET_REGION",me={language:"en",currency:"INR",region:"IN",direction:"ltr"};function pe(e,t){switch(t.type){case de:return{...e,language:t.payload,direction:oe[t.payload]?.dir||"ltr"};case ue:return{...e,currency:t.payload};case he:return{...e,region:t.payload};default:return e}}const fe=R.createContext();function ge({children:t}){const[r,s]=R.useReducer(pe,me);R.useEffect(()=>{const e=localStorage.getItem("ivolex_language"),t=localStorage.getItem("ivolex_currency"),r=localStorage.getItem("ivolex_region");e&&oe[e]&&s({type:de,payload:e}),t&&le[t]&&s({type:ue,payload:t}),r&&s({type:he,payload:r})},[]),R.useEffect(()=>{document.documentElement.dir=r.direction,document.documentElement.lang=r.language,document.documentElement.style.setProperty("--text-align-start","rtl"===r.direction?"right":"left"),document.documentElement.style.setProperty("--text-align-end","rtl"===r.direction?"left":"right"),document.documentElement.style.setProperty("--margin-start","rtl"===r.direction?"margin-right":"margin-left"),document.documentElement.style.setProperty("--margin-end","rtl"===r.direction?"margin-left":"margin-right"),document.documentElement.style.setProperty("--padding-start","rtl"===r.direction?"padding-right":"padding-left"),document.documentElement.style.setProperty("--padding-end","rtl"===r.direction?"padding-left":"padding-right")},[r.direction,r.language]);const i={...r,languages:oe,currencies:le,setLanguage:e=>{oe[e]&&(s({type:de,payload:e}),localStorage.setItem("ivolex_language",e))},setCurrency:e=>{le[e]&&(s({type:ue,payload:e}),localStorage.setItem("ivolex_currency",e))},setRegion:e=>{s({type:he,payload:e}),localStorage.setItem("ivolex_region",e)},t:(e,t=e)=>ce[r.language]?.[e]||t,formatCurrency:(e,t=r.currency)=>{const s=le[t];if(!s)return`${e}`;return new Intl.NumberFormat(s.locale,{style:"currency",currency:t,minimumFractionDigits:2}).format(e)},formatNumber:e=>{const t="ar"===r.language?"ar-SA":"en-US";return new Intl.NumberFormat(t).format(e)},formatDate:e=>{const t="ar"===r.language?"ar-SA":"en-US";return new Intl.DateTimeFormat(t,{year:"numeric",month:"long",day:"numeric"}).format(new Date(e))},isRTL:"rtl"===r.direction};return e.jsx(fe.Provider,{value:i,children:t})}function ye(){const e=R.useContext(fe);if(!e)throw new Error("useI18n must be used within an I18nProvider");return e}const ve=R.createContext(),be={ORDER_CONFIRMATION:"order_confirmation",ORDER_STATUS_UPDATE:"order_status_update",PAYMENT_CONFIRMATION:"payment_confirmation",SHIPPING_UPDATE:"shipping_update",CUSTOMIZATION_UPDATE:"customization_update",ADMIN_ALERT:"admin_alert",SYSTEM_NOTIFICATION:"system_notification"},we={EMAIL:"email",SMS:"sms",WHATSAPP:"whatsapp",IN_APP:"in_app",PUSH:"push"},xe={LOW:"low",MEDIUM:"medium",HIGH:"high",URGENT:"urgent"},_e="SET_PREFERENCES",Se="ADD_NOTIFICATION",Ee="MARK_AS_READ",Te="MARK_ALL_AS_READ",ke="DELETE_NOTIFICATION",Ae="CLEAR_ALL",je="SET_LOADING",Oe="SET_ERROR",Pe={notifications:[],preferences:{email:{orderUpdates:!0,customizationUpdates:!0,promotions:!1,newsletter:!1},sms:{orderUpdates:!0,customizationUpdates:!1,promotions:!1},whatsapp:{orderUpdates:!1,customizationUpdates:!0,promotions:!1},inApp:{all:!0}},loading:!1,error:null},Ce=(e,t)=>{switch(t.type){case _e:return{...e,preferences:{...e.preferences,...t.payload}};case Se:return{...e,notifications:[t.payload,...e.notifications],loading:!1};case Ee:return{...e,notifications:e.notifications.map(e=>e.id===t.payload?{...e,read:!0,readAt:(new Date).toISOString()}:e)};case Te:return{...e,notifications:e.notifications.map(e=>({...e,read:!0,readAt:(new Date).toISOString()}))};case ke:return{...e,notifications:e.notifications.filter(e=>e.id!==t.payload)};case Ae:return{...e,notifications:[]};case je:return{...e,loading:t.payload};case Oe:return{...e,error:t.payload,loading:!1};default:return e}},Re=({children:t})=>{const[r,s]=R.useReducer(Ce,Pe),{language:i}=ye();R.useEffect(()=>{const e=localStorage.getItem("ivolex_notification_preferences");if(e)try{const t=JSON.parse(e);s({type:_e,payload:t})}catch(t){}},[]),R.useEffect(()=>{localStorage.setItem("ivolex_notification_preferences",JSON.stringify(r.preferences))},[r.preferences]);const n=async e=>(await new Promise(e=>setTimeout(e,500)),!0),a=async e=>(await new Promise(e=>setTimeout(e,300)),!0),o=async e=>(await new Promise(e=>setTimeout(e,400)),!0),c={...r,sendNotification:async(e,t,r=[we.IN_APP])=>{s({type:je,payload:!0});try{const c=((e,t)=>{const r={[be.ORDER_CONFIRMATION]:{title:"ar"===i?"تأكيد الطلب":"Order Confirmed",message:"ar"===i?`تم تأكيد طلبك #${t.orderNumber} بنجاح. المبلغ الإجمالي: ${t.total}`:`Your order #${t.orderNumber} has been confirmed. Total: ${t.total}`,icon:"✅",priority:xe.HIGH},[be.ORDER_STATUS_UPDATE]:{title:"ar"===i?"تحديث حالة الطلب":"Order Status Update",message:"ar"===i?`طلبك #${t.orderNumber} الآن: ${t.statusAr||t.status}`:`Your order #${t.orderNumber} is now: ${t.status}`,icon:"📦",priority:xe.MEDIUM},[be.PAYMENT_CONFIRMATION]:{title:"ar"===i?"تأكيد الدفع":"Payment Confirmed",message:"ar"===i?`تم استلام دفعتك بمبلغ ${t.amount} بنجاح`:`Your payment of ${t.amount} has been successfully processed`,icon:"💳",priority:xe.HIGH},[be.SHIPPING_UPDATE]:{title:"ar"===i?"تحديث الشحن":"Shipping Update",message:"ar"===i?`طلبك في الطريق. رقم التتبع: ${t.trackingNumber}`:`Your order is on the way. Tracking: ${t.trackingNumber}`,icon:"🚚",priority:xe.MEDIUM},[be.CUSTOMIZATION_UPDATE]:{title:"ar"===i?"تحديث طلب التخصيص":"Customization Update",message:"ar"===i?`طلب التخصيص #${t.requestId} - ${t.statusAr||t.status}`:`Customization request #${t.requestId} - ${t.status}`,icon:"🎨",priority:xe.MEDIUM},[be.ADMIN_ALERT]:{title:"ar"===i?"تنبيه إداري":"Admin Alert",message:t.message||("ar"===i?"تنبيه جديد":"New admin alert"),icon:"⚠️",priority:xe.URGENT},[be.SYSTEM_NOTIFICATION]:{title:"ar"===i?"إشعار النظام":"System Notification",message:t.message||("ar"===i?"إشعار جديد":"New system notification"),icon:"🔔",priority:xe.LOW}};return r[e]||r[be.SYSTEM_NOTIFICATION]})(e,t),l={id:`notif_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:e,...c,data:t,channels:r,read:!1,createdAt:(new Date).toISOString(),userId:t.userId||"current_user"};return r.includes(we.IN_APP)&&s({type:Se,payload:l}),r.includes(we.EMAIL)&&await n(l),r.includes(we.SMS)&&await a(l),r.includes(we.WHATSAPP)&&await o(l),l}catch(c){throw s({type:Oe,payload:c.message}),c}},updatePreferences:e=>{s({type:_e,payload:e})},markAsRead:e=>{s({type:Ee,payload:e})},markAllAsRead:()=>{s({type:Te})},deleteNotification:e=>{s({type:ke,payload:e})},clearAllNotifications:()=>{s({type:Ae})},getUnreadCount:()=>r.notifications.filter(e=>!e.read).length,getNotificationsByType:e=>r.notifications.filter(t=>t.type===e),shouldSendNotification:(e,t)=>{const s=r.preferences[t];if(!s)return!1;switch(e){case be.ORDER_CONFIRMATION:case be.ORDER_STATUS_UPDATE:case be.PAYMENT_CONFIRMATION:case be.SHIPPING_UPDATE:return s.orderUpdates;case be.CUSTOMIZATION_UPDATE:return s.customizationUpdates;case be.ADMIN_ALERT:return!0;case be.SYSTEM_NOTIFICATION:return!1!==s.all;default:return!1}},NOTIFICATION_TYPES:be,NOTIFICATION_CHANNELS:we,NOTIFICATION_PRIORITIES:xe};return e.jsx(ve.Provider,{value:c,children:t})},Ne=()=>{const e=R.useContext(ve);if(!e)throw new Error("useNotifications must be used within a NotificationProvider");return e},Ie=R.createContext(),De=()=>{const e=R.useContext(Ie);if(!e)throw new Error("useInventory must be used within an InventoryProvider");return e},Le=({children:t})=>{const[r,s]=R.useState({}),[i,n]=R.useState([]),[a,o]=R.useState({lowStockThreshold:10,criticalStockThreshold:5,enableAlerts:!0,alertChannels:["app","email"],autoReorderEnabled:!1,autoReorderThreshold:5}),[c,l]=R.useState(!0);let d;try{const e=Ne();d=e?.addNotification||(()=>{})}catch(f){d=()=>{}}const u=R.useMemo(()=>({prod_001:{stock:15,reserved:2,incoming:0,reorderPoint:10,maxStock:100},prod_002:{stock:3,reserved:1,incoming:20,reorderPoint:8,maxStock:50},prod_003:{stock:0,reserved:0,incoming:10,reorderPoint:5,maxStock:30},prod_004:{stock:25,reserved:5,incoming:0,reorderPoint:15,maxStock:80},prod_005:{stock:8,reserved:3,incoming:0,reorderPoint:12,maxStock:60},prod_006:{stock:45,reserved:0,incoming:0,reorderPoint:20,maxStock:100},prod_007:{stock:2,reserved:0,incoming:25,reorderPoint:10,maxStock:40},prod_008:{stock:12,reserved:8,incoming:0,reorderPoint:15,maxStock:75}}),[]),h=R.useCallback((e=r)=>{if(!a.enableAlerts)return;const t=[],s=JSON.parse(localStorage.getItem("products")||"[]");Object.entries(e).forEach(([e,r])=>{const i=s.find(t=>t.id===e),n=i?.name||`Product ${e}`,o=r.stock-r.reserved;0===o?t.push({id:`critical_${e}_${Date.now()}`,type:"critical",productId:e,productName:n,message:`${n} is out of stock!`,availableStock:o,threshold:a.criticalStockThreshold,timestamp:(new Date).toISOString(),acknowledged:!1}):o<=a.criticalStockThreshold?t.push({id:`critical_${e}_${Date.now()}`,type:"critical",productId:e,productName:n,message:`${n} has critically low stock (${o} remaining)`,availableStock:o,threshold:a.criticalStockThreshold,timestamp:(new Date).toISOString(),acknowledged:!1}):o<=a.lowStockThreshold&&t.push({id:`low_${e}_${Date.now()}`,type:"low",productId:e,productName:n,message:`${n} is running low (${o} remaining)`,availableStock:o,threshold:a.lowStockThreshold,timestamp:(new Date).toISOString(),acknowledged:!1}),a.autoReorderEnabled&&o<=a.autoReorderThreshold&&t.push({id:`reorder_${e}_${Date.now()}`,type:"reorder",productId:e,productName:n,message:`Auto-reorder triggered for ${n}`,availableStock:o,threshold:a.autoReorderThreshold,timestamp:(new Date).toISOString(),acknowledged:!1})}),n(e=>[...e,...t]),t.forEach(e=>{a.alertChannels.includes("app")&&d({title:"Inventory Alert",message:e.message,type:"critical"===e.type?"error":"warning",duration:"critical"===e.type?0:5e3})})},[r,a,d]);R.useEffect(()=>{(async()=>{l(!0);try{await new Promise(e=>setTimeout(e,1e3)),s(u),h(u)}catch(f){}finally{l(!1)}})()},[h,u]);const m=(e,t)=>{s(r=>{const s={...r,[e]:{...r[e],...t}};return setTimeout(()=>h(s),100),s})},p={inventory:r,alerts:i.filter(e=>!e.acknowledged),allAlerts:i,settings:a,loading:c,updateStock:m,reserveStock:(e,t)=>new Promise((s,i)=>{const n=r[e];if(!n)return void i(new Error("Product not found"));n.stock-n.reserved<t?i(new Error("Insufficient stock")):(m(e,{reserved:n.reserved+t}),s(!0))}),releaseStock:(e,t)=>{const s=r[e];s&&m(e,{reserved:Math.max(0,s.reserved-t)})},confirmStock:(e,t)=>{const s=r[e];s&&m(e,{stock:s.stock-t,reserved:Math.max(0,s.reserved-t)})},addIncomingStock:(e,t,s)=>{const i=r[e];i&&(m(e,{incoming:i.incoming+t}),d({title:"Incoming Stock Added",message:`${t} units added to incoming stock for product ${e}`,type:"success"}))},receiveStock:(e,t)=>{const s=r[e];s&&(m(e,{stock:s.stock+t,incoming:Math.max(0,s.incoming-t)}),d({title:"Stock Received",message:`${t} units received for product ${e}`,type:"success"}))},acknowledgeAlert:e=>{n(t=>t.map(t=>t.id===e?{...t,acknowledged:!0}:t))},clearAlerts:()=>{n([])},updateSettings:e=>{o(t=>({...t,...e})),setTimeout(()=>h(),100)},getStockStatus:e=>{const t=r[e];if(!t)return{status:"unknown",available:0};const s=t.stock-t.reserved;return 0===s?{status:"out_of_stock",available:s}:s<=a.criticalStockThreshold?{status:"critical",available:s}:s<=a.lowStockThreshold?{status:"low",available:s}:{status:"in_stock",available:s}},getInventorySummary:()=>{const e={totalProducts:Object.keys(r).length,outOfStock:0,criticalStock:0,lowStock:0,inStock:0,totalValue:0};return Object.entries(r).forEach(([t,r])=>{const s=r.stock-r.reserved;0===s?e.outOfStock++:s<=a.criticalStockThreshold?e.criticalStock++:s<=a.lowStockThreshold?e.lowStock++:e.inStock++}),e},checkInventoryAlerts:h};return e.jsx(Ie.Provider,{value:p,children:t})};class $e extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class Ue extends $e{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Me extends $e{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Fe extends $e{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Be,He;(He=Be||(Be={})).Any="any",He.ApNortheast1="ap-northeast-1",He.ApNortheast2="ap-northeast-2",He.ApSouth1="ap-south-1",He.ApSoutheast1="ap-southeast-1",He.ApSoutheast2="ap-southeast-2",He.CaCentral1="ca-central-1",He.EuCentral1="eu-central-1",He.EuWest1="eu-west-1",He.EuWest2="eu-west-2",He.EuWest3="eu-west-3",He.SaEast1="sa-east-1",He.UsEast1="us-east-1",He.UsWest1="us-west-1",He.UsWest2="us-west-2";var ze=function(e,t,r,s){return new(r||(r=Promise))(function(i,n){function a(e){try{c(s.next(e))}catch(t){n(t)}}function o(e){try{c(s.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,o)}c((s=s.apply(e,t||[])).next())})};class Ge{constructor(e,{headers:t={},customFetch:r,region:s=Be.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=(e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>q(async()=>{const{default:e}=await Promise.resolve().then(()=>st);return{default:e}},void 0,import.meta.url).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)})(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return ze(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:n}=t;let a={},{region:o}=t;o||(o=this.region);const c=new URL(`${this.url}/${e}`);let l;o&&"any"!==o&&(a["x-region"]=o,c.searchParams.set("forceFunctionRegion",o)),n&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&("undefined"!=typeof Blob&&n instanceof Blob||n instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",l=n):"string"==typeof n?(a["Content-Type"]="text/plain",l=n):"undefined"!=typeof FormData&&n instanceof FormData?l=n:(a["Content-Type"]="application/json",l=JSON.stringify(n)));const d=yield this.fetch(c.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),s),body:l}).catch(e=>{throw new Ue(e)}),u=d.headers.get("x-relay-error");if(u&&"true"===u)throw new Me(d);if(!d.ok)throw new Fe(d);let h,m=(null!==(r=d.headers.get("Content-Type"))&&void 0!==r?r:"text/plain").split(";")[0].trim();return h="application/json"===m?yield d.json():"application/octet-stream"===m?yield d.blob():"text/event-stream"===m?d:"multipart/form-data"===m?yield d.formData():yield d.text(),{data:h,error:null,response:d}}catch(s){return{data:null,error:s,response:s instanceof Fe||s instanceof Me?s.context:void 0}}})}}var We={},Ve={},qe={},Ke={},Je={},Ye={},Ze=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();const Xe=Ze.fetch,Qe=Ze.fetch.bind(Ze),et=Ze.Headers,tt=Ze.Request,rt=Ze.Response,st=Object.freeze(Object.defineProperty({__proto__:null,Headers:et,Request:tt,Response:rt,default:Qe,fetch:Xe},Symbol.toStringTag,{value:"Module"})),it=M(st);var nt,at,ot,ct,lt,dt,ut,ht={};function mt(){if(nt)return ht;nt=1,Object.defineProperty(ht,"__esModule",{value:!0});class e extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}return ht.default=e,ht}function pt(){if(at)return Ye;at=1;var e=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ye,"__esModule",{value:!0});const t=e(it),r=e(mt());return Ye.default=class{constructor(e){var r,s;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(r=e.shouldThrowOnError)&&void 0!==r&&r,this.signal=e.signal,this.isMaybeSingle=null!==(s=e.isMaybeSingle)&&void 0!==s&&s,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let s=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,s,i,n;let a=null,o=null,c=null,l=e.status,d=e.statusText;if(e.ok){if("HEAD"!==this.method){const r=await e.text();""===r||(o="text/csv"===this.headers.get("Accept")||this.headers.get("Accept")&&(null===(t=this.headers.get("Accept"))||void 0===t?void 0:t.includes("application/vnd.pgrst.plan+text"))?r:JSON.parse(r))}const r=null===(s=this.headers.get("Prefer"))||void 0===s?void 0:s.match(/count=(exact|planned|estimated)/),n=null===(i=e.headers.get("content-range"))||void 0===i?void 0:i.split("/");r&&n&&n.length>1&&(c=parseInt(n[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(o)&&(o.length>1?(a={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,c=null,l=406,d="Not Acceptable"):o=1===o.length?o[0]:null)}else{const t=await e.text();try{a=JSON.parse(t),Array.isArray(a)&&404===e.status&&(o=[],a=null,l=200,d="OK")}catch(u){404===e.status&&""===t?(l=204,d="No Content"):a={message:t}}if(a&&this.isMaybeSingle&&(null===(n=null==a?void 0:a.details)||void 0===n?void 0:n.includes("0 rows"))&&(a=null,l=200,d="OK"),a&&this.shouldThrowOnError)throw new r.default(a)}return{error:a,data:o,count:c,status:l,statusText:d}});return this.shouldThrowOnError||(s=s.catch(e=>{var t,r,s;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(r=null==e?void 0:e.stack)&&void 0!==r?r:""}`,hint:"",code:`${null!==(s=null==e?void 0:e.code)&&void 0!==s?s:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}},Ye}function ft(){if(ot)return Je;ot=1;var e=Je&&Je.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Je,"__esModule",{value:!0});const t=e(pt());class r extends t.default{select(e){let t=!1;const r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:i=s}={}){const n=i?`${i}.order`:"order",a=this.url.searchParams.get(n);return this.url.searchParams.set(n,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const s=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){const i=void 0===s?"offset":`${s}.offset`,n=void 0===s?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(n,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:i=!1,format:n="text"}={}){var a;const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=null!==(a=this.headers.get("Accept"))&&void 0!==a?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${n}; for="${c}"; options=${o};`),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}}return Je.default=r,Je}function gt(){if(ct)return Ke;ct=1;var e=Ke&&Ke.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ke,"__esModule",{value:!0});const t=e(ft());class r extends t.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(e=>"string"==typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let i="";"plain"===s?i="pl":"phrase"===s?i="ph":"websearch"===s&&(i="w");const n=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${n}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}}return Ke.default=r,Ke}function yt(){if(lt)return qe;lt=1;var e=qe&&qe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(qe,"__esModule",{value:!0});const t=e(gt());return qe.default=class{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=s}select(e,{head:r=!1,count:s}={}){const i=r?"HEAD":"GET";let n=!1;const a=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!n?"":('"'===e&&(n=!n),e)).join("");return this.url.searchParams.set("select",a),s&&this.headers.append("Prefer",`count=${s}`),new t.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:r,defaultToNull:s=!0}={}){var i;if(r&&this.headers.append("Prefer",`count=${r}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new t.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch})}upsert(e,{onConflict:r,ignoreDuplicates:s=!1,count:i,defaultToNull:n=!0}={}){var a;if(this.headers.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),void 0!==r&&this.url.searchParams.set("on_conflict",r),i&&this.headers.append("Prefer",`count=${i}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new t.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(a=this.fetch)&&void 0!==a?a:fetch})}update(e,{count:r}={}){var s;return r&&this.headers.append("Prefer",`count=${r}`),new t.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(s=this.fetch)&&void 0!==s?s:fetch})}delete({count:e}={}){var r;return e&&this.headers.append("Prefer",`count=${e}`),new t.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:null!==(r=this.fetch)&&void 0!==r?r:fetch})}},qe}const vt=F(function(){if(ut)return We;ut=1;var e=We&&We.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(We,"__esModule",{value:!0}),We.PostgrestError=We.PostgrestBuilder=We.PostgrestTransformBuilder=We.PostgrestFilterBuilder=We.PostgrestQueryBuilder=We.PostgrestClient=void 0;const t=e(function(){if(dt)return Ve;dt=1;var e=Ve&&Ve.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ve,"__esModule",{value:!0});const t=e(yt()),r=e(gt());class s{constructor(e,{headers:t={},schema:r,fetch:s}={}){this.url=e,this.headers=new Headers(t),this.schemaName=r,this.fetch=s}from(e){const r=new URL(`${this.url}/${e}`);return new t.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new s(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:i=!1,count:n}={}){var a;let o;const c=new URL(`${this.url}/rpc/${e}`);let l;s||i?(o=s?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{c.searchParams.append(e,t)})):(o="POST",l=t);const d=new Headers(this.headers);return n&&d.set("Prefer",`count=${n}`),new r.default({method:o,url:c,headers:d,schema:this.schemaName,body:l,fetch:null!==(a=this.fetch)&&void 0!==a?a:fetch})}}return Ve.default=s,Ve}());We.PostgrestClient=t.default;const r=e(yt());We.PostgrestQueryBuilder=r.default;const s=e(gt());We.PostgrestFilterBuilder=s.default;const i=e(ft());We.PostgrestTransformBuilder=i.default;const n=e(pt());We.PostgrestBuilder=n.default;const a=e(mt());return We.PostgrestError=a.default,We.default={PostgrestClient:t.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:i.default,PostgrestBuilder:n.default,PostgrestError:a.default},We}()),{PostgrestClient:bt,PostgrestQueryBuilder:wt,PostgrestFilterBuilder:xt,PostgrestTransformBuilder:_t,PostgrestBuilder:St,PostgrestError:Et}=vt;class Tt{static detectEnvironment(){var e;if("undefined"!=typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!=typeof global&&void 0!==global.WebSocket)return{type:"native",constructor:global.WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!=typeof globalThis&&globalThis.EdgeRuntime||"undefined"!=typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if("undefined"!=typeof process){const e=process.versions;if(e&&e.node){const t=e.node,r=parseInt(t.replace(/^v/,"").split(".")[0]);return r>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`\n\nSuggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}}const kt=1e4;var At,jt,Ot,Pt,Ct,Rt,Nt,It,Dt,Lt,$t;(jt=At||(At={}))[jt.connecting=0]="connecting",jt[jt.open=1]="open",jt[jt.closing=2]="closing",jt[jt.closed=3]="closed",(Pt=Ot||(Ot={})).closed="closed",Pt.errored="errored",Pt.joined="joined",Pt.joining="joining",Pt.leaving="leaving",(Rt=Ct||(Ct={})).close="phx_close",Rt.error="phx_error",Rt.join="phx_join",Rt.reply="phx_reply",Rt.leave="phx_leave",Rt.access_token="access_token",(Nt||(Nt={})).websocket="websocket",(Dt=It||(It={})).Connecting="connecting",Dt.Open="open",Dt.Closing="closing",Dt.Closed="closed";class Ut{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"==typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const s=t.getUint8(1),i=t.getUint8(2);let n=this.HEADER_LENGTH+2;const a=r.decode(e.slice(n,n+s));n+=s;const o=r.decode(e.slice(n,n+i));n+=i;return{ref:null,topic:a,event:o,payload:JSON.parse(r.decode(e.slice(n,e.byteLength)))}}}class Mt{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}($t=Lt||(Lt={})).abstime="abstime",$t.bool="bool",$t.date="date",$t.daterange="daterange",$t.float4="float4",$t.float8="float8",$t.int2="int2",$t.int4="int4",$t.int4range="int4range",$t.int8="int8",$t.int8range="int8range",$t.json="json",$t.jsonb="jsonb",$t.money="money",$t.numeric="numeric",$t.oid="oid",$t.reltime="reltime",$t.text="text",$t.time="time",$t.timestamp="timestamp",$t.timestamptz="timestamptz",$t.timetz="timetz",$t.tsrange="tsrange",$t.tstzrange="tstzrange";const Ft=(e,t,r={})=>{var s;const i=null!==(s=r.skipTypes)&&void 0!==s?s:[];return Object.keys(t).reduce((r,s)=>(r[s]=Bt(s,e,t,i),r),{})},Bt=(e,t,r,s)=>{const i=t.find(t=>t.name===e),n=null==i?void 0:i.type,a=r[e];return n&&!s.includes(n)?Ht(n,a):zt(a)},Ht=(e,t)=>{if("_"===e.charAt(0)){const r=e.slice(1,e.length);return qt(t,r)}switch(e){case Lt.bool:return Gt(t);case Lt.float4:case Lt.float8:case Lt.int2:case Lt.int4:case Lt.int8:case Lt.numeric:case Lt.oid:return Wt(t);case Lt.json:case Lt.jsonb:return Vt(t);case Lt.timestamp:return Kt(t);case Lt.abstime:case Lt.date:case Lt.daterange:case Lt.int4range:case Lt.int8range:case Lt.money:case Lt.reltime:case Lt.text:case Lt.time:case Lt.timestamptz:case Lt.timetz:case Lt.tsrange:case Lt.tstzrange:default:return zt(t)}},zt=e=>e,Gt=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Wt=e=>{if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Vt=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(t){return e}return e},qt=(e,t)=>{if("string"!=typeof e)return e;const r=e.length-1,s=e[r];if("{"===e[0]&&"}"===s){let s;const n=e.slice(1,r);try{s=JSON.parse("["+n+"]")}catch(i){s=n?n.split(","):[]}return s.map(e=>Ht(t,e))}return e},Kt=e=>"string"==typeof e?e.replace(" ","T"):e,Jt=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Yt{constructor(e,t,r={},s=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Zt,Xt,Qt,er,tr,rr,sr,ir;(Xt=Zt||(Zt={})).SYNC="sync",Xt.JOIN="join",Xt.LEAVE="leave";class nr{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{const{onJoin:t,onLeave:r,onSync:s}=this.caller;this.joinRef=this.channel._joinRef(),this.state=nr.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=nr.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],s()}),this.channel._on(r.diff,{},e=>{const{onJoin:t,onLeave:r,onSync:s}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=nr.syncDiff(this.state,e,t,r),s())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const i=this.cloneDeep(e),n=this.transformState(t),a={},o={};return this.map(i,(e,t)=>{n[e]||(o[e]=t)}),this.map(n,(e,t)=>{const r=i[e];if(r){const s=t.map(e=>e.presence_ref),i=r.map(e=>e.presence_ref),n=t.filter(e=>i.indexOf(e.presence_ref)<0),c=r.filter(e=>s.indexOf(e.presence_ref)<0);n.length>0&&(a[e]=n),c.length>0&&(o[e]=c)}else a[e]=t}),this.syncDiff(i,{joins:a,leaves:o},r,s)}static syncDiff(e,t,r,s){const{joins:i,leaves:n}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(t,s)=>{var i;const n=null!==(i=e[t])&&void 0!==i?i:[];if(e[t]=this.cloneDeep(s),n.length>0){const r=e[t].map(e=>e.presence_ref),s=n.filter(e=>r.indexOf(e.presence_ref)<0);e[t].unshift(...s)}r(t,n,s)}),this.map(n,(t,r)=>{let i=e[t];if(!i)return;const n=r.map(e=>e.presence_ref);i=i.filter(e=>n.indexOf(e.presence_ref)<0),e[t]=i,s(t,i,r),0===i.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return t[r]="metas"in s?s.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(er=Qt||(Qt={})).ALL="*",er.INSERT="INSERT",er.UPDATE="UPDATE",er.DELETE="DELETE",(rr=tr||(tr={})).BROADCAST="broadcast",rr.PRESENCE="presence",rr.POSTGRES_CHANGES="postgres_changes",rr.SYSTEM="system",(ir=sr||(sr={})).SUBSCRIBED="SUBSCRIBED",ir.TIMED_OUT="TIMED_OUT",ir.CLOSED="CLOSED",ir.CHANNEL_ERROR="CHANNEL_ERROR";class ar{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=Ot.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Yt(this,Ct.join,this.params,this.timeout),this.rejoinTimer=new Mt(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ot.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ot.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=Ot.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ot.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=Ot.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ct.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new nr(this),this.broadcastEndpointURL=Jt(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Ot.closed){const{config:{broadcast:n,presence:a,private:o}}=this.params,c=null!==(s=null===(r=this.bindings.postgres_changes)||void 0===r?void 0:r.map(e=>e.filter))&&void 0!==s?s:[],l=!!this.bindings[tr.PRESENCE]&&this.bindings[tr.PRESENCE].length>0||!0===(null===(i=this.params.config.presence)||void 0===i?void 0:i.enabled),d={},u={broadcast:n,presence:Object.assign(Object.assign({},a),{enabled:l}),postgres_changes:c,private:o};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(t=>null==e?void 0:e(sr.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(sr.CLOSED)),this.updateJoinPayload(Object.assign({config:u},d)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var r;if(this.socket.setAuth(),void 0!==t){const s=this.bindings.postgres_changes,i=null!==(r=null==s?void 0:s.length)&&void 0!==r?r:0,n=[];for(let r=0;r<i;r++){const i=s[r],{filter:{event:a,schema:o,table:c,filter:l}}=i,d=t&&t[r];if(!d||d.event!==a||d.schema!==o||d.table!==c||d.filter!==l)return this.unsubscribe(),this.state=Ot.errored,void(null==e||e(sr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));n.push(Object.assign(Object.assign({},i),{id:d.id}))}return this.bindings.postgres_changes=n,void(e&&e(sr.SUBSCRIBED))}null==e||e(sr.SUBSCRIBED)}).receive("error",t=>{this.state=Ot.errored,null==e||e(sr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(sr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===Ot.joined&&e===tr.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async send(e,t={}){var r,s;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var s,i,n;const a=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(n=null===(i=null===(s=this.params)||void 0===s?void 0:s.config)||void 0===i?void 0:i.broadcast)||void 0===n?void 0:n.ack)||r("ok"),a.receive("ok",()=>r("ok")),a.receive("error",()=>r("error")),a.receive("timeout",()=>r("timed out"))});{const{event:n,payload:a}=e,o={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:a,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!==(r=t.timeout)&&void 0!==r?r:this.timeout);return await(null===(s=e.body)||void 0===s?void 0:s.cancel()),e.ok?"ok":"error"}catch(i){return"AbortError"===i.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Ot.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ct.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new Yt(this,Ct.leave,{},e),r.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{null==r||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ot.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),n=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(i),n}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Yt(this,e,t,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,i;const n=e.toLocaleLowerCase(),{close:a,error:o,leave:c,join:l}=Ct;if(r&&[a,o,c,l].indexOf(n)>=0&&r!==this._joinRef())return;let d=this._onMessage(n,t,r);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(n)?null===(s=this.bindings.postgres_changes)||void 0===s||s.filter(e=>{var t,r,s;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(s=null===(r=e.filter)||void 0===r?void 0:r.event)||void 0===s?void 0:s.toLocaleLowerCase())===n}).map(e=>e.callback(d,r)):null===(i=this.bindings[n])||void 0===i||i.filter(e=>{var r,s,i,a,o,c;if(["broadcast","presence","postgres_changes"].includes(n)){if("id"in e){const n=e.id,a=null===(r=e.filter)||void 0===r?void 0:r.event;return n&&(null===(s=t.ids)||void 0===s?void 0:s.includes(n))&&("*"===a||(null==a?void 0:a.toLocaleLowerCase())===(null===(i=t.data)||void 0===i?void 0:i.type.toLocaleLowerCase()))}{const r=null===(o=null===(a=null==e?void 0:e.filter)||void 0===a?void 0:a.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===r||r===(null===(c=null==t?void 0:t.event)||void 0===c?void 0:c.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===n}).map(e=>{if("object"==typeof d&&"ids"in d){const e=d.data,{schema:t,table:r,commit_timestamp:s,type:i,errors:n}=e,a={schema:t,table:r,commit_timestamp:s,eventType:i,new:{},old:{},errors:n};d=Object.assign(Object.assign({},a),this._getPayloadRecords(e))}e.callback(d,r)})}_isClosed(){return this.state===Ot.closed}_isJoined(){return this.state===Ot.joined}_isJoining(){return this.state===Ot.joining}_isLeaving(){return this.state===Ot.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(e=>{var s;return!((null===(s=e.type)||void 0===s?void 0:s.toLocaleLowerCase())===r&&ar.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ct.close,{},e)}_onError(e){this._on(Ct.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ot.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=Ft(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=Ft(e.columns,e.old_record)),t}}const or=()=>{},cr=25e3,lr=10,dr=100,ur=[1e3,2e3,5e3,1e4];class hr{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=kt,this.transport=null,this.heartbeatIntervalMs=cr,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=or,this.ref=0,this.reconnectTimer=null,this.logger=or,this.conn=null,this.sendBuffer=[],this.serializer=new Ut,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>q(async()=>{const{default:e}=await Promise.resolve().then(()=>st);return{default:e}},void 0,import.meta.url).then(({default:t})=>t(...e)).catch(e=>{throw new Error(`Failed to load @supabase/node-fetch: ${e.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):fetch),(...e)=>t(...e)},!(null===(r=null==t?void 0:t.params)||void 0===r?void 0:r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Nt.websocket}`,this.httpEndpoint=Jt(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Tt.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;if(t.includes("Node.js"))throw new Error(`${t}\n\nTo use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })`);throw new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case At.connecting:return It.Connecting;case At.open:return It.Open;case At.closing:return It.Closing;default:return It.Closed}}isConnected(){return this.connectionState()===It.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e,t={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(e=>e.topic===r);if(s)return s;{const r=new ar(`realtime:${e}`,t,this);return this.channels.push(r),r}}push(e){const{topic:t,event:r,payload:s,ref:i}=e,n=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${r} (${i})`,s),this.isConnected()?n():this.sendBuffer.push(n)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}return this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),void setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},dr)}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}else try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event)try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error")}catch(o){this.log("error","error in heartbeat callback",o)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:t,event:r,payload:s,ref:i}=e,n=i?`(${i})`:"",a=s.status||"";this.log("receive",`${a} ${t} ${r} ${n}`.trim(),s),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,s,i)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ct.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const r=e.match(/\?/)?"&":"?";return`${e}${r}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e,t=!1){this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;t=e||(this.accessToken?await this.accessToken():this.accessTokenValue),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{const r={access_token:t,version:"realtime-js/2.15.5"};t&&e.updateJoinPayload(r),e.joinedOnce&&e._isJoined()&&e._push(Ct.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new Mt(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},lr)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,s,i,n,a,o,c,l;if(this.transport=null!==(t=null==e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(r=null==e?void 0:e.timeout)&&void 0!==r?r:kt,this.heartbeatIntervalMs=null!==(s=null==e?void 0:e.heartbeatIntervalMs)&&void 0!==s?s:cr,this.worker=null!==(i=null==e?void 0:e.worker)&&void 0!==i&&i,this.accessToken=null!==(n=null==e?void 0:e.accessToken)&&void 0!==n?n:null,this.heartbeatCallback=null!==(a=null==e?void 0:e.heartbeatCallback)&&void 0!==a?a:or,(null==e?void 0:e.params)&&(this.params=e.params),(null==e?void 0:e.logger)&&(this.logger=e.logger),((null==e?void 0:e.logLevel)||(null==e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(o=null==e?void 0:e.reconnectAfterMs)&&void 0!==o?o:e=>ur[e-1]||1e4,this.encode=null!==(c=null==e?void 0:e.encode)&&void 0!==c?c:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(l=null==e?void 0:e.decode)&&void 0!==l?l:this.serializer.decode.bind(this.serializer),this.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=null==e?void 0:e.workerUrl}}}class mr extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function pr(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class fr extends mr{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class gr extends mr{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var yr=function(e,t,r,s){return new(r||(r=Promise))(function(i,n){function a(e){try{c(s.next(e))}catch(t){n(t)}}function o(e){try{c(s.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,o)}c((s=s.apply(e,t||[])).next())})};const vr=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>q(async()=>{const{default:e}=await Promise.resolve().then(()=>st);return{default:e}},void 0,import.meta.url).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},br=e=>{if(Array.isArray(e))return e.map(e=>br(e));if("function"==typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([e,r])=>{const s=e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[s]=br(r)}),t};var wr=function(e,t,r,s){return new(r||(r=Promise))(function(i,n){function a(e){try{c(s.next(e))}catch(t){n(t)}}function o(e){try{c(s.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,o)}c((s=s.apply(e,t||[])).next())})};const xr=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),_r=(e,t,r)=>wr(void 0,void 0,void 0,function*(){const s=yield yr(void 0,void 0,void 0,function*(){return"undefined"==typeof Response?(yield q(()=>Promise.resolve().then(()=>st),void 0,import.meta.url)).Response:Response});e instanceof s&&!(null==r?void 0:r.noResolveJson)?e.json().then(r=>{const s=e.status||500,i=(null==r?void 0:r.statusCode)||s+"";t(new fr(xr(r),s,i))}).catch(e=>{t(new gr(xr(e),e))}):t(new gr(xr(e),e))}),Sr=(e,t,r,s)=>{const i={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"!==e&&s?((e=>{if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)})(s)?(i.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),i.body=JSON.stringify(s)):i.body=s,(null==t?void 0:t.duplex)&&(i.duplex=t.duplex),Object.assign(Object.assign({},i),r)):i};function Er(e,t,r,s,i,n){return wr(this,void 0,void 0,function*(){return new Promise((a,o)=>{e(r,Sr(t,s,i,n)).then(e=>{if(!e.ok)throw e;return(null==s?void 0:s.noResolveJson)?e:e.json()}).then(e=>a(e)).catch(e=>_r(e,o,s))})})}function Tr(e,t,r,s){return wr(this,void 0,void 0,function*(){return Er(e,"GET",t,r,s)})}function kr(e,t,r,s,i){return wr(this,void 0,void 0,function*(){return Er(e,"POST",t,s,i,r)})}function Ar(e,t,r,s,i){return wr(this,void 0,void 0,function*(){return Er(e,"PUT",t,s,i,r)})}function jr(e,t,r,s,i){return wr(this,void 0,void 0,function*(){return Er(e,"DELETE",t,s,i,r)})}var Or=function(e,t,r,s){return new(r||(r=Promise))(function(i,n){function a(e){try{c(s.next(e))}catch(t){n(t)}}function o(e){try{c(s.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,o)}c((s=s.apply(e,t||[])).next())})};const Pr={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Cr={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Rr{constructor(e,t={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=vr(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,r,s){return Or(this,void 0,void 0,function*(){try{let i;const n=Object.assign(Object.assign({},Cr),s);let a=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(n.upsert)});const o=n.metadata;"undefined"!=typeof Blob&&r instanceof Blob?(i=new FormData,i.append("cacheControl",n.cacheControl),o&&i.append("metadata",this.encodeMetadata(o)),i.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(i=r,i.append("cacheControl",n.cacheControl),o&&i.append("metadata",this.encodeMetadata(o))):(i=r,a["cache-control"]=`max-age=${n.cacheControl}`,a["content-type"]=n.contentType,o&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null==s?void 0:s.headers)&&(a=Object.assign(Object.assign({},a),s.headers));const c=this._removeEmptyFolders(t),l=this._getFinalPath(c),d=yield("PUT"==e?Ar:kr)(this.fetch,`${this.url}/object/${l}`,i,Object.assign({headers:a},(null==n?void 0:n.duplex)?{duplex:n.duplex}:{}));return{data:{path:c,id:d.Id,fullPath:d.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(pr(i))return{data:null,error:i};throw i}})}upload(e,t,r){return Or(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return Or(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),n=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${n}`);a.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:Cr.upsert},s),n=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&r instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(e=r,e.append("cacheControl",t.cacheControl)):(e=r,n["cache-control"]=`max-age=${t.cacheControl}`,n["content-type"]=t.contentType);return{data:{path:i,fullPath:(yield Ar(this.fetch,a.toString(),e,{headers:n})).Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(pr(o))return{data:null,error:o};throw o}})}createSignedUploadUrl(e,t){return Or(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(s["x-upsert"]="true");const i=yield kr(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),n=new URL(this.url+i.url),a=n.searchParams.get("token");if(!a)throw new mr("No token returned by API");return{data:{signedUrl:n.toString(),path:e,token:a},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pr(r))return{data:null,error:r};throw r}})}update(e,t,r){return Or(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return Or(this,void 0,void 0,function*(){try{return{data:yield kr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pr(s))return{data:null,error:s};throw s}})}copy(e,t,r){return Or(this,void 0,void 0,function*(){try{return{data:{path:(yield kr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pr(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,r){return Or(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield kr(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers});const n=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${n}`)},{data:i,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pr(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return Or(this,void 0,void 0,function*(){try{const s=yield kr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:s.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${i}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pr(s))return{data:null,error:s};throw s}})}download(e,t){return Or(this,void 0,void 0,function*(){const r=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",s=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),i=s?`?${s}`:"";try{const t=this._getFinalPath(e),s=yield Tr(this.fetch,`${this.url}/${r}/${t}${i}`,{headers:this.headers,noResolveJson:!0});return{data:yield s.blob(),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(pr(n))return{data:null,error:n};throw n}})}info(e){return Or(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const e=yield Tr(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:br(e),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pr(r))return{data:null,error:r};throw r}})}exists(e){return Or(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield function(e,t,r,s){return wr(this,void 0,void 0,function*(){return Er(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),s)})}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pr(r)&&r instanceof gr){const e=r.originalError;if([400,404].includes(null==e?void 0:e.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],i=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==i&&s.push(i);const n=void 0!==(null==t?void 0:t.transform)?"render/image":"object",a=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==a&&s.push(a);let o=s.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${n}/public/${r}${o}`)}}}remove(e){return Or(this,void 0,void 0,function*(){try{return{data:yield jr(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(pr(t))return{data:null,error:t};throw t}})}list(e,t,r){return Or(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Pr),t),{prefix:e||""});return{data:yield kr(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pr(s))return{data:null,error:s};throw s}})}listV2(e,t){return Or(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield kr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pr(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Nr={"X-Client-Info":"storage-js/2.12.1"};var Ir=function(e,t,r,s){return new(r||(r=Promise))(function(i,n){function a(e){try{c(s.next(e))}catch(t){n(t)}}function o(e){try{c(s.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,o)}c((s=s.apply(e,t||[])).next())})};class Dr{constructor(e,t={},r,s){this.shouldThrowOnError=!1;const i=new URL(e);if(null==s?void 0:s.useNewHostname){/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase."))}this.url=i.href,this.headers=Object.assign(Object.assign({},Nr),t),this.fetch=vr(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Ir(this,void 0,void 0,function*(){try{return{data:yield Tr(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(pr(e))return{data:null,error:e};throw e}})}getBucket(e){return Ir(this,void 0,void 0,function*(){try{return{data:yield Tr(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(pr(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Ir(this,void 0,void 0,function*(){try{return{data:yield kr(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pr(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return Ir(this,void 0,void 0,function*(){try{return{data:yield Ar(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pr(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Ir(this,void 0,void 0,function*(){try{return{data:yield kr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(pr(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Ir(this,void 0,void 0,function*(){try{return{data:yield jr(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(pr(t))return{data:null,error:t};throw t}})}}class Lr extends Dr{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new Rr(this.url,this.headers,e,this.fetch)}}let $r="";$r="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const Ur={headers:{"X-Client-Info":`supabase-js-${$r}/2.57.4`}},Mr={schema:"public"},Fr={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Br={};var Hr=function(e,t,r,s){return new(r||(r=Promise))(function(i,n){function a(e){try{c(s.next(e))}catch(t){n(t)}}function o(e){try{c(s.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,o)}c((s=s.apply(e,t||[])).next())})};const zr=(e,t,r)=>{const s=(e=>{let t;return t=e||("undefined"==typeof fetch?Qe:fetch),(...e)=>t(...e)})(r),i="undefined"==typeof Headers?et:Headers;return(r,n)=>Hr(void 0,void 0,void 0,function*(){var a;const o=null!==(a=yield t())&&void 0!==a?a:e;let c=new i(null==n?void 0:n.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${o}`),s(r,Object.assign(Object.assign({},n),{headers:c}))})};var Gr=function(e,t,r,s){return new(r||(r=Promise))(function(i,n){function a(e){try{c(s.next(e))}catch(t){n(t)}}function o(e){try{c(s.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,o)}c((s=s.apply(e,t||[])).next())})};const Wr="2.71.1",Vr=3e4,qr=9e4,Kr={"X-Client-Info":`gotrue-js/${Wr}`},Jr="X-Supabase-Api-Version",Yr={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},Zr=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class Xr extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function Qr(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class es extends Xr{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class ts extends Xr{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class rs extends Xr{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class ss extends rs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class is extends rs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ns extends rs{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class as extends rs{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class os extends rs{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class cs extends rs{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function ls(e){return Qr(e)&&"AuthRetryableFetchError"===e.name}class ds extends rs{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class us extends rs{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const hs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ms=" \t\n\r=".split(""),ps=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<ms.length;t+=1)e[ms[t].charCodeAt(0)]=-2;for(let t=0;t<hs.length;t+=1)e[hs[t].charCodeAt(0)]=t;return e})();function fs(e,t,r){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;r(hs[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;r(hs[e]),t.queuedBits-=6}}function gs(e,t,r){const s=ps[e];if(!(s>-1)){if(-2===s)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function ys(e){const t=[],r=e=>{t.push(String.fromCodePoint(e))},s={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},n=e=>{!function(e,t,r){if(0===t.utf8seq){if(e<=127)return void r(e);for(let r=1;r<6;r+=1)if(!(e>>7-r&1)){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}}(e,s,r)};for(let a=0;a<e.length;a+=1)gs(e.charCodeAt(a),i,n);return t.join("")}function vs(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}t(e)}function bs(e){const t=[],r={queue:0,queuedBits:0},s=e=>{t.push(e)};for(let i=0;i<e.length;i+=1)gs(e.charCodeAt(i),r,s);return new Uint8Array(t)}function ws(e){const t=[];return function(e,t){for(let r=0;r<e.length;r+=1){let s=e.charCodeAt(r);if(s>55295&&s<=56319){const t=1024*(s-55296)&65535;s=65536+(e.charCodeAt(r+1)-56320&65535|t),r+=1}vs(s,t)}}(e,e=>t.push(e)),new Uint8Array(t)}function xs(e){const t=[],r={queue:0,queuedBits:0},s=e=>{t.push(e)};return e.forEach(e=>fs(e,r,s)),fs(null,r,s),t.join("")}const _s=()=>"undefined"!=typeof window&&"undefined"!=typeof document,Ss={tested:!1,writable:!1},Es=()=>{if(!_s())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(t){return!1}if(Ss.tested)return Ss.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Ss.tested=!0,Ss.writable=!0}catch(t){Ss.tested=!0,Ss.writable=!1}return Ss.writable};const Ts=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>q(async()=>{const{default:e}=await Promise.resolve().then(()=>st);return{default:e}},void 0,import.meta.url).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},ks=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},As=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(s){return r}},js=async(e,t)=>{await e.removeItem(t)};class Os{constructor(){this.promise=new Os.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function Ps(e){const t=e.split(".");if(3!==t.length)throw new us("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!Zr.test(t[r]))throw new us("JWT not in base64url format");return{header:JSON.parse(ys(t[0])),payload:JSON.parse(ys(t[1])),signature:bs(t[2]),raw:{header:t[0],payload:t[1]}}}function Cs(e){return("0"+e.toString(16)).substr(-2)}async function Rs(e){if(!("undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder))return e;const t=await async function(e){const t=(new TextEncoder).encode(e),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(e=>String.fromCharCode(e)).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ns(e,t,r=!1){const s=function(){const e=new Uint32Array(56);if("undefined"==typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let r="";for(let s=0;s<56;s++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,Cs).join("")}();let i=s;r&&(i+="/PASSWORD_RECOVERY"),await ks(e,`${t}-code-verifier`,i);const n=await Rs(s);return[n,s===n?"plain":"s256"]}Os.promiseConstructor=Promise;const Is=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const Ds=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ls(e){if(!Ds.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function $s(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"==typeof t){const e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Us(e){return JSON.parse(JSON.stringify(e))}const Ms=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Fs=[502,503,504];async function Bs(e){var t,r;if(!("object"==typeof(r=e)&&null!==r&&"status"in r&&"ok"in r&&"json"in r&&"function"==typeof r.json))throw new cs(Ms(e),0);if(Fs.includes(e.status))throw new cs(Ms(e),e.status);let s,i;try{s=await e.json()}catch(a){throw new ts(Ms(a),a)}const n=function(e){const t=e.headers.get(Jr);if(!t)return null;if(!t.match(Is))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(a){return null}}(e);if(n&&n.getTime()>=Yr.timestamp&&"object"==typeof s&&s&&"string"==typeof s.code?i=s.code:"object"==typeof s&&s&&"string"==typeof s.error_code&&(i=s.error_code),i){if("weak_password"===i)throw new ds(Ms(s),e.status,(null===(t=s.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===i)throw new ss}else if("object"==typeof s&&s&&"object"==typeof s.weak_password&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new ds(Ms(s),e.status,s.weak_password.reasons);throw new es(Ms(s),e.status||500,i)}async function Hs(e,t,r,s){var i;const n=Object.assign({},null==s?void 0:s.headers);n[Jr]||(n[Jr]=Yr.name),(null==s?void 0:s.jwt)&&(n.Authorization=`Bearer ${s.jwt}`);const a=null!==(i=null==s?void 0:s.query)&&void 0!==i?i:{};(null==s?void 0:s.redirectTo)&&(a.redirect_to=s.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",c=await async function(e,t,r,s,i,n){const a=((e,t,r,s)=>{const i={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),i.body=JSON.stringify(s),Object.assign(Object.assign({},i),r))})(t,s,i,n);let o;try{o=await e(r,Object.assign({},a))}catch(c){throw new cs(Ms(c),0)}o.ok||await Bs(o);if(null==s?void 0:s.noResolveJson)return o;try{return await o.json()}catch(c){await Bs(c)}}(e,t,r+o,{headers:n,noResolveJson:null==s?void 0:s.noResolveJson},{},null==s?void 0:s.body);return(null==s?void 0:s.xform)?null==s?void 0:s.xform(c):{data:Object.assign({},c),error:null}}function zs(e){var t;let r=null;var s;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=(s=e.expires_in,Math.round(Date.now()/1e3)+s)));return{data:{session:r,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function Gs(e){const t=zs(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function Ws(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function Vs(e){return{data:e,error:null}}function qs(e){const{action_link:t,email_otp:r,hashed_token:s,redirect_to:i,verification_type:n}=e,a=function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(r[s[i]]=e[s[i]])}return r}(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:r,hashed_token:s,redirect_to:i,verification_type:n},user:Object.assign({},a)},error:null}}function Ks(e){return e}const Js=["global","local","others"];class Ys{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=Ts(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Js[0]){if(Js.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Js.join(", ")}`);try{return await Hs(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Qr(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await Hs(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Ws})}catch(r){if(Qr(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(r[s[i]]=e[s[i]])}return r}(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=null==r?void 0:r.newEmail,delete s.newEmail),await Hs(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:qs,redirectTo:null==t?void 0:t.redirectTo})}catch(t){if(Qr(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Hs(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ws})}catch(t){if(Qr(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,i,n,a,o;try{const c={nextPage:null,lastPage:0,total:0},l=await Hs(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(i=null===(s=null==e?void 0:e.perPage)||void 0===s?void 0:s.toString())&&void 0!==i?i:""},xform:Ks});if(l.error)throw l.error;const d=await l.json(),u=null!==(n=l.headers.get("x-total-count"))&&void 0!==n?n:0,h=null!==(o=null===(a=l.headers.get("link"))||void 0===a?void 0:a.split(","))&&void 0!==o?o:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);c[`${r}Page`]=t}),c.total=parseInt(u)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(Qr(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){Ls(e);try{return await Hs(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ws})}catch(t){if(Qr(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Ls(e);try{return await Hs(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Ws})}catch(r){if(Qr(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){Ls(e);try{return await Hs(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Ws})}catch(r){if(Qr(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Ls(e.userId);try{const{data:t,error:r}=await Hs(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(t){if(Qr(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Ls(e.userId),Ls(e.id);try{return{data:await Hs(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Qr(t))return{data:null,error:t};throw t}}}function Zs(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Xs=!!(globalThis&&Es()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class Qs extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class ei extends Qs{}async function ti(e,t,r){const s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort()},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async s=>{if(!s){if(0===t)throw new ei(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Xs)try{await globalThis.navigator.locks.query()}catch(i){}return await r()}try{return await r()}finally{}}))}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();const ri={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Kr,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function si(e,t,r){return await r()}const ii={};class ni{constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ni.nextInstanceID,ni.nextInstanceID+=1,this.instanceID>0&&_s();const s=Object.assign(Object.assign({},ri),e);if(this.logDebugMessages=!!s.debug,"function"==typeof s.debug&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Ys({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Ts(s.fetch),this.lock=s.lock||si,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:_s()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=ti:this.lock=si,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:Es()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Zs(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=Zs(this.memoryStorage)),_s()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){}null===(r=this.broadcastChannel)||void 0===r||r.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}get jwks(){var e,t;return null!==(t=null===(e=ii[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){ii[this.storageKey]=Object.assign(Object.assign({},ii[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=ii[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){ii[this.storageKey]=Object.assign(Object.assign({},ii[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Wr}) ${(new Date).toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach((e,r)=>{t[r]=e})}catch(s){}return r.searchParams.forEach((e,r)=>{t[r]=e}),t}(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),_s()&&this.detectSessionInUrl&&"none"!==r){const{data:s,error:i}=await this._getSessionFromURL(t,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),function(e){return Qr(e)&&"AuthImplicitGrantRedirectError"===e.name}(i)){const t=null===(e=i.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:i}}return await this._removeSession(),{error:i}}const{session:n,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",n,"redirect type",a),await this._saveSession(n),setTimeout(async()=>{"recovery"===a?await this._notifyAllSubscribers("PASSWORD_RECOVERY",n):await this._notifyAllSubscribers("SIGNED_IN",n)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Qr(t)?{error:t}:{error:new ts("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{const i=await Hs(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(r=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==r?r:{},gotrue_meta_security:{captcha_token:null===(s=null==e?void 0:e.options)||void 0===s?void 0:s.captchaToken}},xform:zs}),{data:n,error:a}=i;if(a||!n)return{data:{user:null,session:null},error:a};const o=n.session,c=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:c,session:o},error:null}}catch(i){if(Qr(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,r,s;try{let i;if("email"in e){const{email:r,password:s,options:n}=e;let a=null,o=null;"pkce"===this.flowType&&([a,o]=await Ns(this.storage,this.storageKey)),i=await Hs(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==n?void 0:n.emailRedirectTo,body:{email:r,password:s,data:null!==(t=null==n?void 0:n.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:a,code_challenge_method:o},xform:zs})}else{if(!("phone"in e))throw new ns("You must provide either an email or phone number and a password");{const{phone:t,password:n,options:a}=e;i=await Hs(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:n,data:null!==(r=null==a?void 0:a.data)&&void 0!==r?r:{},channel:null!==(s=null==a?void 0:a.channel)&&void 0!==s?s:"sms",gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:zs})}}const{data:n,error:a}=i;if(a||!n)return{data:{user:null,session:null},error:a};const o=n.session,c=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:c,session:o},error:null}}catch(i){if(Qr(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:r,password:s,options:i}=e;t=await Hs(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:s,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:Gs})}else{if(!("phone"in e))throw new ns("You must provide either an email or phone number and a password");{const{phone:r,password:s,options:i}=e;t=await Hs(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:s,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:Gs})}}const{data:r,error:s}=t;return s?{data:{user:null,session:null},error:s}:r&&r.session&&r.user?(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s}):{data:{user:null,session:null},error:new is}}catch(t){if(Qr(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(s=e.options)||void 0===s?void 0:s.queryParams,skipBrowserRedirect:null===(i=e.options)||void 0===i?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if("solana"===t)return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,r,s,i,n,a,o,c,l,d,u,h;let m,p;if("message"in e)m=e.message,p=e.signature;else{const{chain:u,wallet:h,statement:f,options:g}=e;let y;if(_s())if("object"==typeof h)y=h;else{const e=window;if(!("solana"in e)||"object"!=typeof e.solana||!("signIn"in e.solana&&"function"==typeof e.solana.signIn||"signMessage"in e.solana&&"function"==typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");y=e.solana}else{if("object"!=typeof h||!(null==g?void 0:g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=h}const v=new URL(null!==(t=null==g?void 0:g.url)&&void 0!==t?t:window.location.href);if("signIn"in y&&y.signIn){const e=await y.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null==g?void 0:g.signInWithSolana),{version:"1",domain:v.host,uri:v.href}),f?{statement:f}:null));let t;if(Array.isArray(e)&&e[0]&&"object"==typeof e[0])t=e[0];else{if(!(e&&"object"==typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"==typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");m="string"==typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),p=t.signature}else{if(!("signMessage"in y&&"function"==typeof y.signMessage&&"publicKey"in y&&"object"==typeof y&&y.publicKey&&"toBase58"in y.publicKey&&"function"==typeof y.publicKey.toBase58))throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${v.host} wants you to sign in with your Solana account:`,y.publicKey.toBase58(),...f?["",f,""]:[""],"Version: 1",`URI: ${v.href}`,`Issued At: ${null!==(s=null===(r=null==g?void 0:g.signInWithSolana)||void 0===r?void 0:r.issuedAt)&&void 0!==s?s:(new Date).toISOString()}`,...(null===(i=null==g?void 0:g.signInWithSolana)||void 0===i?void 0:i.notBefore)?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...(null===(n=null==g?void 0:g.signInWithSolana)||void 0===n?void 0:n.expirationTime)?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...(null===(a=null==g?void 0:g.signInWithSolana)||void 0===a?void 0:a.chainId)?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...(null===(o=null==g?void 0:g.signInWithSolana)||void 0===o?void 0:o.nonce)?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...(null===(c=null==g?void 0:g.signInWithSolana)||void 0===c?void 0:c.requestId)?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...(null===(d=null===(l=null==g?void 0:g.signInWithSolana)||void 0===l?void 0:l.resources)||void 0===d?void 0:d.length)?["Resources",...g.signInWithSolana.resources.map(e=>`- ${e}`)]:[]].join("\n");const e=await y.signMessage((new TextEncoder).encode(m),"utf8");if(!(e&&e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=e}}try{const{data:t,error:r}=await Hs(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:xs(p)},(null===(u=e.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(h=e.options)||void 0===h?void 0:h.captchaToken}}:null),xform:zs});if(r)throw r;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:r}):{data:{user:null,session:null},error:new is}}catch(f){if(Qr(f))return{data:{user:null,session:null},error:f};throw f}}async _exchangeCodeForSession(e){const t=await As(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(null!=t?t:"").split("/");try{const{data:t,error:i}=await Hs(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:zs});if(await js(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=s?s:null}),error:i}):{data:{user:null,session:null,redirectType:null},error:new is}}catch(i){if(Qr(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:r,token:s,access_token:i,nonce:n}=e,a=await Hs(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:n,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:zs}),{data:o,error:c}=a;return c?{data:{user:null,session:null},error:c}:o&&o.session&&o.user?(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:o,error:c}):{data:{user:null,session:null},error:new is}}catch(t){if(Qr(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,s,i,n;try{if("email"in e){const{email:s,options:i}=e;let n=null,a=null;"pkce"===this.flowType&&([n,a]=await Ns(this.storage,this.storageKey));const{error:o}=await Hs(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:s,data:null!==(t=null==i?void 0:i.data)&&void 0!==t?t:{},create_user:null===(r=null==i?void 0:i.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:n,code_challenge_method:a},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){const{phone:t,options:r}=e,{data:a,error:o}=await Hs(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(s=null==r?void 0:r.data)&&void 0!==s?s:{},create_user:null===(i=null==r?void 0:r.shouldCreateUser)||void 0===i||i,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!==(n=null==r?void 0:r.channel)&&void 0!==n?n:"sms"}});return{data:{user:null,session:null,messageId:null==a?void 0:a.message_id},error:o}}throw new ns("You must provide either an email or phone number.")}catch(a){if(Qr(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var t,r;try{let s,i;"options"in e&&(s=null===(t=e.options)||void 0===t?void 0:t.redirectTo,i=null===(r=e.options)||void 0===r?void 0:r.captchaToken);const{data:n,error:a}=await Hs(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:zs});if(a)throw a;if(!n)throw new Error("An error occurred on token verification.");const o=n.session,c=n.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:c,session:o},error:null}}catch(s){if(Qr(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,r,s;try{let i=null,n=null;return"pkce"===this.flowType&&([i,n]=await Ns(this.storage,this.storageKey)),await Hs(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==r?r:void 0}),(null===(s=null==e?void 0:e.options)||void 0===s?void 0:s.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:n}),headers:this.headers,xform:Vs})}catch(i){if(Qr(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new ss;const{error:s}=await Hs(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(Qr(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:i}=e,{error:n}=await Hs(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:n}}if("phone"in e){const{phone:r,type:s,options:i}=e,{data:n,error:a}=await Hs(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:null==n?void 0:n.message_id},error:a}}throw new ns("You must provide either an email or phone number and a type")}catch(t){if(Qr(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await As(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=!!e.expires_at&&1e3*e.expires_at-Date.now()<qr;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const t=await As(this.userStorage,this.storageKey+"-user");(null==t?void 0:t.user)?e.user=t.user:e.user=$s()}if(this.storage.isServer&&e.user){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,r,s)=>(t||"user"!==r||(t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,r,s))})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,async()=>await this._getUser())}async _getUser(e){try{return e?await Hs(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ws}):await this._useSession(async e=>{var t,r,s;const{data:i,error:n}=e;if(n)throw n;return(null===(t=i.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await Hs(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(s=null===(r=i.session)||void 0===r?void 0:r.access_token)&&void 0!==s?s:void 0,xform:Ws}):{data:{user:null},error:new ss}})}catch(t){if(Qr(t))return function(e){return Qr(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await js(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new ss;const n=s.session;let a=null,o=null;"pkce"===this.flowType&&null!=e.email&&([a,o]=await Ns(this.storage,this.storageKey));const{data:c,error:l}=await Hs(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:o}),jwt:n.access_token,xform:Ws});if(l)throw l;return n.user=c.user,await this._saveSession(n),await this._notifyAllSubscribers("USER_UPDATED",n),{data:{user:n.user},error:null}})}catch(r){if(Qr(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ss;const t=Date.now()/1e3;let r=t,s=!0,i=null;const{payload:n}=Ps(e.access_token);if(n.exp&&(r=n.exp,s=r<=t),s){const{session:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return{data:{user:null,session:null},error:r};if(!t)return{data:{user:null,session:null},error:null};i=t}else{const{data:s,error:n}=await this._getUser(e.access_token);if(n)throw n;i={access_token:e.access_token,refresh_token:e.refresh_token,user:s.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(Qr(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:s,error:i}=t;if(i)throw i;e=null!==(r=s.session)&&void 0!==r?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new ss;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(Qr(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!_s())throw new as("No browser detected.");if(e.error||e.error_description||e.error_code)throw new as(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new os("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new as("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new os("No code detected.");const{data:t,error:r}=await this._exchangeCodeForSession(e.code);if(r)throw r;const s=new URL(window.location.href);return s.searchParams.delete("code"),window.history.replaceState(window.history.state,"",s.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:n,expires_in:a,expires_at:o,token_type:c}=e;if(!(i&&a&&n&&c))throw new as("No session defined in URL");const l=Math.round(Date.now()/1e3),d=parseInt(a);let u=l+d;o&&(u=parseInt(o));const{data:h,error:m}=await this._getUser(i);if(m)throw m;const p={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:d,expires_at:u,refresh_token:n,token_type:c,user:h.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:p,redirectType:e.type},error:null}}catch(r){if(Qr(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await As(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{error:i};const n=null===(r=s.session)||void 0===r?void 0:r.access_token;if(n){const{error:t}=await this.admin.signOut(n,e);if(t&&(!function(e){return Qr(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await js(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:s},error:i}=t;if(i)throw i;await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(i){await(null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;"pkce"===this.flowType&&([r,s]=await Ns(this.storage,this.storageKey,!0));try{return await Hs(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(Qr(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(Qr(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:s}=await this._useSession(async t=>{var r,s,i,n,a;const{data:o,error:c}=t;if(c)throw c;const l=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(r=e.options)||void 0===r?void 0:r.redirectTo,scopes:null===(s=e.options)||void 0===s?void 0:s.scopes,queryParams:null===(i=e.options)||void 0===i?void 0:i.queryParams,skipBrowserRedirect:!0});return await Hs(this.fetch,"GET",l,{headers:this.headers,jwt:null!==(a=null===(n=o.session)||void 0===n?void 0:n.access_token)&&void 0!==a?a:void 0})});if(s)throw s;return _s()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null==r?void 0:r.url),{data:{provider:e.provider,url:null==r?void 0:r.url},error:null}}catch(r){if(Qr(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:n}=t;if(n)throw n;return await Hs(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(s=null===(r=i.session)||void 0===r?void 0:r.access_token)&&void 0!==s?s:void 0})})}catch(t){if(Qr(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const i=Date.now();return await(r=async r=>(r>0&&await async function(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await Hs(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:zs})),s=(e,t)=>{const r=200*Math.pow(2,e);return t&&ls(t)&&Date.now()+r-i<Vr},new Promise((e,t)=>{(async()=>{for(let n=0;n<1/0;n++)try{const t=await r(n);if(!s(n,null,t))return void e(t)}catch(i){if(!s(n,i))return void t(i)}})()}))}catch(i){if(this._debug(t,"error",i),Qr(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(t,"end")}var r,s}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),_s()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const i=await As(this.storage,this.storageKey);if(i&&this.userStorage){let t=await As(this.userStorage,this.storageKey+"-user");this.storage.isServer||!Object.is(this.storage,this.userStorage)||t||(t={user:i.user},await ks(this.userStorage,this.storageKey+"-user",t)),i.user=null!==(e=null==t?void 0:t.user)&&void 0!==e?e:$s()}else if(i&&!i.user&&!i.user){const e=await As(this.storage,this.storageKey+"-user");e&&(null==e?void 0:e.user)?(i.user=e.user,await js(this.storage,this.storageKey+"-user"),await ks(this.storage,this.storageKey,i)):i.user=$s()}if(this._debug(r,"session from storage",i),!this._isValidSession(i))return this._debug(r,"session is not valid"),void(null!==i&&await this._removeSession());const n=1e3*(null!==(t=i.expires_at)&&void 0!==t?t:1/0)-Date.now()<qr;if(this._debug(r,`session has${n?"":" not"} expired with margin of 90000s`),n){if(this.autoRefreshToken&&i.refresh_token){const{error:e}=await this._callRefreshToken(i.refresh_token);e&&(ls(e)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(i.user&&!0===i.user.__isUserNotAvailableProxy)try{const{data:e,error:t}=await this._getUser(i.access_token);!t&&(null==e?void 0:e.user)?(i.user=e.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(s){this._debug(r,"error getting user data, skipping SIGNED_IN notification",s)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){return void this._debug(r,"error",i)}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new ss;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Os;const{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new ss;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const s={session:t.session,error:null};return this.refreshingDeferred.resolve(s),s}catch(i){if(this._debug(s,"error",i),Qr(i)){const e={session:null,error:i};return ls(i)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(i){s.push(i)}});if(await Promise.all(i),s.length>0){for(let e=0;e<s.length;e+=1);throw s[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!r&&t.user&&await ks(this.userStorage,this.storageKey+"-user",{user:t.user});const e=Object.assign({},t);delete e.user;const s=Us(e);await ks(this.storage,this.storageKey,s)}else{const e=Us(t);await ks(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),await js(this.storage,this.storageKey),await js(this.storage,this.storageKey+"-code-verifier"),await js(this.storage,this.storageKey+"-user"),this.userStorage&&await js(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&_s()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Vr);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async e=>{const{data:{session:r}}=e;if(!r||!r.refresh_token||!r.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const s=Math.floor((1e3*r.expires_at-t)/Vr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),s<=3&&await this._callRefreshToken(r.refresh_token)})}catch(e){}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(!(e.isAcquireTimeout||e instanceof Qs))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!_s()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if((null==r?void 0:r.redirectTo)&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),(null==r?void 0:r.scopes)&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),"pkce"===this.flowType){const[e,t]=await Ns(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});s.push(r.toString())}if(null==r?void 0:r.queryParams){const e=new URLSearchParams(r.queryParams);s.push(e.toString())}return(null==r?void 0:r.skipBrowserRedirect)&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await Hs(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.access_token})})}catch(t){if(Qr(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:n}=t;if(n)return{data:null,error:n};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:o,error:c}=await Hs(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:null===(r=null==i?void 0:i.session)||void 0===r?void 0:r.access_token});return c?{data:null,error:c}:("totp"===e.factorType&&(null===(s=null==o?void 0:o.totp)||void 0===s?void 0:s.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})})}catch(t){if(Qr(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{data:null,error:i};const{data:n,error:a}=await Hs(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+n.expires_in},n)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",n),{data:n,error:a})})}catch(t){if(Qr(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await Hs(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.access_token})})}catch(t){if(Qr(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(null==e?void 0:e.factors)||[],s=r.filter(e=>"totp"===e.factor_type&&"verified"===e.status),i=r.filter(e=>"phone"===e.factor_type&&"verified"===e.status);return{data:{all:r,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:n}=Ps(s.access_token);let a=null;n.aal&&(a=n.aal);let o=a;(null!==(r=null===(t=s.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==r?r:[]).length>0&&(o="aal2");return{data:{currentLevel:a,nextLevel:o,currentAuthenticationMethods:n.amr||[]},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(t=>t.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(t=>t.kid===e),r&&this.jwks_cached_at+6e5>s)return r;const{data:i,error:n}=await Hs(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(n)throw n;return i.keys&&0!==i.keys.length?(this.jwks=i,this.jwks_cached_at=s,r=i.keys.find(t=>t.kid===e),r||null):null}async getClaims(e,t={}){try{let r=e;if(!r){const{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};r=e.session.access_token}const{header:s,payload:i,signature:n,raw:{header:a,payload:o}}=Ps(r);(null==t?void 0:t.allowExpired)||function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(i.exp);const c=s.alg&&!s.alg.startsWith("HS")&&s.kid&&"crypto"in globalThis&&"subtle"in globalThis.crypto?await this.fetchJwk(s.kid,(null==t?void 0:t.keys)?{keys:t.keys}:null==t?void 0:t.jwks):null;if(!c){const{error:e}=await this.getUser(r);if(e)throw e;return{data:{claims:i,header:s,signature:n},error:null}}const l=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(s.alg),d=await crypto.subtle.importKey("jwk",c,l,!0,["verify"]);if(!(await crypto.subtle.verify(l,d,n,ws(`${a}.${o}`))))throw new us("Invalid JWT signature");return{data:{claims:i,header:s,signature:n},error:null}}catch(r){if(Qr(r))return{data:null,error:r};throw r}}}ni.nextInstanceID=0;const ai=ni;class oi extends ai{constructor(e){super(e)}}var ci=function(e,t,r,s){return new(r||(r=Promise))(function(i,n){function a(e){try{c(s.next(e))}catch(t){n(t)}}function o(e){try{c(s.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,o)}c((s=s.apply(e,t||[])).next())})};class li{constructor(e,t,r){var s,i,n;this.supabaseUrl=e,this.supabaseKey=t;const a=function(e){const t=null==e?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL((r=t).endsWith("/")?r:r+"/")}catch(s){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}var r}(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const o=`sb-${a.hostname.split(".")[0]}-auth-token`,c=function(e,t){var r,s;const{db:i,auth:n,realtime:a,global:o}=e,{db:c,auth:l,realtime:d,global:u}=t,h={db:Object.assign(Object.assign({},c),i),auth:Object.assign(Object.assign({},l),n),realtime:Object.assign(Object.assign({},d),a),storage:{},global:Object.assign(Object.assign(Object.assign({},u),o),{headers:Object.assign(Object.assign({},null!==(r=null==u?void 0:u.headers)&&void 0!==r?r:{}),null!==(s=null==o?void 0:o.headers)&&void 0!==s?s:{})}),accessToken:()=>Gr(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}(null!=r?r:{},{db:Mr,realtime:Br,auth:Object.assign(Object.assign({},Fr),{storageKey:o}),global:Ur});this.storageKey=null!==(s=c.auth.storageKey)&&void 0!==s?s:"",this.headers=null!==(i=c.global.headers)&&void 0!==i?i:{},c.accessToken?(this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(n=c.auth)&&void 0!==n?n:{},this.headers,c.global.fetch),this.fetch=zr(t,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.rest=new bt(new URL("rest/v1",a).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this.storage=new Lr(this.storageUrl.href,this.headers,this.fetch,null==r?void 0:r.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new Ge(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return ci(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return null!==(t=null===(e=r.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:i,storageKey:n,flowType:a,lock:o,debug:c},l,d){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new oi({url:this.authUrl.href,headers:Object.assign(Object.assign({},u),l),storageKey:n,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:i,flowType:a,lock:o,debug:c,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>"authorization"===e.toLowerCase())})}_initRealtimeClient(e){return new hr(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===r?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=r}}!function(){if("undefined"!=typeof window)return!1;if("undefined"==typeof process)return!1;const e=process.version;if(null==e)return!1;const t=e.match(/^v(\d+)\./);!!t&&parseInt(t[1],10)}();const di=new li("https://your-project.supabase.co","your-anon-key-here",ui);var ui;const hi=R.createContext(),mi=()=>{const e=R.useContext(hi);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},pi=({children:t})=>{const[r,s]=R.useState(null),[i,n]=R.useState(!0);R.useEffect(()=>{if((async()=>{try{if(di){const{data:{session:e}}=await di.auth.getSession();if(e?.user){const{data:t,error:r}=await di.from("users").select("*").eq("id",e.user.id).single();s(!r&&t?{id:t.id,email:t.email,firstName:t.first_name,lastName:t.last_name,role:t.role,avatar:t.avatar_url}:{id:e.user.id,email:e.user.email,firstName:e.user.user_metadata?.first_name||"",lastName:e.user.user_metadata?.last_name||"",role:e.user.user_metadata?.role||"customer",avatar:e.user.user_metadata?.avatar_url||null})}}else{const t=localStorage.getItem("user");if(t)try{s(JSON.parse(t))}catch(e){localStorage.removeItem("user")}}}catch(e){}finally{n(!1)}})(),di){const{data:{subscription:e}}=di.auth.onAuthStateChange((e,t)=>{s(t?.user?{id:t.user.id,email:t.user.email,firstName:t.user.user_metadata?.first_name||"",lastName:t.user.user_metadata?.last_name||"",role:t.user.user_metadata?.role||"customer",avatar:t.user.user_metadata?.avatar_url||null}:null)});return()=>{e.unsubscribe()}}},[]);const a={user:r,isAuthenticated:!!r,isLoading:i,login:async e=>{try{if(di){const{data:t,error:r}=await di.auth.signInWithPassword({email:e.email,password:e.password});if(r)return{success:!1,error:r.message};if(t?.user){const{data:e,error:r}=await di.from("users").select("*").eq("id",t.user.id).single(),i=r||!e?{id:t.user.id,email:t.user.email,firstName:t.user.user_metadata?.first_name||"",lastName:t.user.user_metadata?.last_name||"",role:t.user.user_metadata?.role||"customer",avatar:t.user.user_metadata?.avatar_url||null}:{id:e.id,email:e.email,firstName:e.first_name,lastName:e.last_name,role:e.role,avatar:e.avatar_url};return s(i),{success:!0,user:i}}}else{if("faisal@limitlessinfotech.com"===e.email&&"SuperAdmin2024!"===e.password){const e={id:"1",email:"faisal@limitlessinfotech.com",firstName:"Faisal",lastName:"Khan",role:"super_admin",avatar:null};return s(e),localStorage.setItem("user",JSON.stringify(e)),{success:!0,user:e}}if("demo@ivolex.com"===e.email&&"password"===e.password){const e={id:"2",email:"demo@ivolex.com",firstName:"Demo",lastName:"User",role:"customer",avatar:null};return s(e),localStorage.setItem("user",JSON.stringify(e)),{success:!0,user:e}}}return{success:!1,error:"Invalid credentials"}}catch(t){return{success:!1,error:"Login failed. Please try again."}}},logout:async()=>{try{di&&await di.auth.signOut(),s(null),localStorage.removeItem("user")}catch(e){}},register:async e=>{try{if(!di){const t={id:Date.now().toString(),...e,avatar:null,role:"customer"};return s(t),localStorage.setItem("user",JSON.stringify(t)),{success:!0,user:t}}{const{data:t,error:r}=await di.auth.signUp({email:e.email,password:e.password,options:{data:{first_name:e.firstName,last_name:e.lastName}}});if(r)return{success:!1,error:r.message};if(t?.user){const{error:r}=await di.from("users").insert({id:t.user.id,email:e.email,first_name:e.firstName,last_name:e.lastName,role:"customer"}),i={id:t.user.id,email:t.user.email,firstName:e.firstName,lastName:e.lastName,role:"customer",avatar:null};return s(i),{success:!0,user:i}}}}catch(t){return{success:!1,error:"Registration failed. Please try again."}}},updateProfile:async e=>{if(!r)return{success:!1,error:"Not authenticated"};try{if(di){const{error:t}=await di.auth.updateUser({data:{first_name:e.firstName,last_name:e.lastName,avatar_url:e.avatar}});if(t)return{success:!1,error:t.message};const{error:i}=await di.from("users").update({first_name:e.firstName,last_name:e.lastName,avatar_url:e.avatar}).eq("id",r.id),n={...r,...e};return s(n),{success:!0,user:n}}{const t={...r,...e};return s(t),localStorage.setItem("user",JSON.stringify(t)),{success:!0,user:t}}}catch(t){return{success:!1,error:"Profile update failed. Please try again."}}}};return e.jsx(hi.Provider,{value:a,children:t})},fi=R.createContext(),gi={PRODUCTS:"products",CATEGORIES:"categories",BRANDS:"brands",COLLECTIONS:"collections",ALL:"all"},yi={PRODUCT:"product",CATEGORY:"category",BRAND:"brand",COLLECTION:"collection",SUGGESTION:"suggestion"},vi="SET_QUERY",bi="SET_RESULTS",wi="SET_SUGGESTIONS",xi="SET_LOADING",_i="SET_FILTERS",Si="ADD_TO_HISTORY",Ei="CLEAR_HISTORY",Ti="SET_POPULAR_SEARCHES",ki={query:"",results:[],suggestions:[],loading:!1,filters:{type:gi.ALL,segment:null,priceRange:null,sortBy:"relevance"},searchHistory:[],popularSearches:[],totalResults:0},Ai=[{id:1,name:"Premium Leather Wallet",nameAr:"محفظة جلدية فاخرة",category:"Wallets",categoryAr:"محافظ",segment:"leather",price:299,brand:"IVOLEX",keywords:["wallet","leather","premium","men","brown"]},{id:2,name:"Handcrafted Leather Bag",nameAr:"حقيبة جلدية مصنوعة يدوياً",category:"Bags",categoryAr:"حقائب",segment:"leather",price:899,brand:"IVOLEX",keywords:["bag","leather","handcrafted","women","black"]},{id:3,name:"Executive Leather Briefcase",nameAr:"حقيبة أعمال جلدية تنفيذية",category:"Business",categoryAr:"أعمال",segment:"leather",price:1299,brand:"IVOLEX",keywords:["briefcase","leather","executive","business","professional"]},{id:4,name:"Vintage Leather Jacket",nameAr:"جاكيت جلدي عتيق",category:"Clothing",categoryAr:"ملابس",segment:"leather",price:1899,brand:"IVOLEX",keywords:["jacket","leather","vintage","clothing","style"]},{id:5,name:"Smart Wireless Headphones",nameAr:"سماعات لاسلكية ذكية",category:"Audio",categoryAr:"صوتيات",segment:"electronics",price:599,brand:"TechPro",keywords:["headphones","wireless","smart","audio","bluetooth"]},{id:6,name:"4K Ultra HD Monitor",nameAr:"شاشة عالية الوضوح 4K",category:"Displays",categoryAr:"شاشات",segment:"electronics",price:1499,brand:"ViewMaster",keywords:["monitor","4k","display","uhd","gaming"]},{id:7,name:"Gaming Mechanical Keyboard",nameAr:"لوحة مفاتيح ميكانيكية للألعاب",category:"Gaming",categoryAr:"ألعاب",segment:"electronics",price:399,brand:"GameTech",keywords:["keyboard","mechanical","gaming","rgb","switches"]},{id:8,name:"Professional Drone Camera",nameAr:"طائرة درون احترافية بكاميرا",category:"Cameras",categoryAr:"كاميرات",segment:"electronics",price:2299,brand:"SkyTech",keywords:["drone","camera","professional","aerial","photography"]},{id:9,name:"Modern Executive Desk",nameAr:"مكتب تنفيذي حديث",category:"Office",categoryAr:"مكتب",segment:"furniture",price:1899,brand:"ModernSpace",keywords:["desk","executive","modern","office","workspace"]},{id:10,name:"Luxury Dining Table Set",nameAr:"طقم طاولة طعام فاخر",category:"Dining",categoryAr:"طعام",segment:"furniture",price:3499,brand:"LuxeHome",keywords:["dining","table","luxury","set","wooden"]},{id:11,name:"Ergonomic Office Chair",nameAr:"كرسي مكتب مريح",category:"Seating",categoryAr:"جلوس",segment:"furniture",price:899,brand:"ComfortPlus",keywords:["chair","office","ergonomic","comfortable","adjustable"]},{id:12,name:"Contemporary Sofa Set",nameAr:"طقم أريكة معاصر",category:"Living Room",categoryAr:"غرفة معيشة",segment:"furniture",price:2799,brand:"StyleHome",keywords:["sofa","contemporary","living room","comfort","fabric"]}],ji=[{id:"wallets",name:"Wallets",nameAr:"محافظ",segment:"leather"},{id:"bags",name:"Bags",nameAr:"حقائب",segment:"leather"},{id:"audio",name:"Audio",nameAr:"صوتيات",segment:"electronics"},{id:"displays",name:"Displays",nameAr:"شاشات",segment:"electronics"},{id:"office",name:"Office Furniture",nameAr:"أثاث مكتبي",segment:"furniture"},{id:"living",name:"Living Room",nameAr:"غرفة معيشة",segment:"furniture"}],Oi=[{id:"ivolex",name:"IVOLEX",segment:"leather"},{id:"techpro",name:"TechPro",segment:"electronics"},{id:"modernspace",name:"ModernSpace",segment:"furniture"}],Pi=(e,t,r=.6)=>{if(!e||!t)return{match:!1,score:0};const s=e.toLowerCase(),i=t.toLowerCase();if(i.includes(s))return{match:!0,score:1};const n=1-Ci(s,i)/Math.max(s.length,i.length);return{match:n>=r,score:n}},Ci=(e,t)=>{const r=[];for(let s=0;s<=t.length;s++)r[s]=[s];for(let s=0;s<=e.length;s++)r[0][s]=s;for(let s=1;s<=t.length;s++)for(let i=1;i<=e.length;i++)t.charAt(s-1)===e.charAt(i-1)?r[s][i]=r[s-1][i-1]:r[s][i]=Math.min(r[s-1][i-1]+1,r[s][i-1]+1,r[s-1][i]+1);return r[t.length][e.length]},Ri=(e,t)=>{switch(t.type){case vi:return{...e,query:t.payload};case bi:return{...e,results:t.payload.results,totalResults:t.payload.total,loading:!1};case wi:return{...e,suggestions:t.payload};case xi:return{...e,loading:t.payload};case _i:return{...e,filters:{...e.filters,...t.payload}};case Si:{const r=[t.payload,...e.searchHistory.filter(e=>e!==t.payload)].slice(0,10);return{...e,searchHistory:r}}case Ei:return{...e,searchHistory:[]};case Ti:return{...e,popularSearches:t.payload};default:return e}},Ni=({children:t})=>{const[r,s]=R.useReducer(Ri,ki);N.useEffect(()=>{const e=localStorage.getItem("ivolex_search_history");if(e)try{JSON.parse(e).forEach(e=>{s({type:Si,payload:e})})}catch(t){}},[]),N.useEffect(()=>{localStorage.setItem("ivolex_search_history",JSON.stringify(r.searchHistory))},[r.searchHistory]);const i=R.useCallback(async(e,t={})=>{if(!e.trim())return void s({type:bi,payload:{results:[],total:0}});s({type:xi,payload:!0}),await new Promise(e=>setTimeout(e,300));const i=e.toLowerCase().trim(),a={...r.filters,...t};let o=[];if(a.type===gi.ALL||a.type===gi.PRODUCTS){const e=Ai.filter(e=>{if(a.segment&&e.segment!==a.segment)return!1;const t=Pi(i,e.name),r=Pi(i,e.category),s=Pi(i,e.brand),n=e.keywords.some(e=>Pi(i,e).match);return t.match||r.match||s.match||n}).map(e=>({...e,type:yi.PRODUCT,relevanceScore:n(i,e)}));o.push(...e)}if(a.type===gi.ALL||a.type===gi.CATEGORIES){const e=ji.filter(e=>{if(a.segment&&e.segment!==a.segment)return!1;return Pi(i,e.name).match}).map(e=>({...e,type:yi.CATEGORY,relevanceScore:Pi(i,e.name).score}));o.push(...e)}if(a.type===gi.ALL||a.type===gi.BRANDS){const e=Oi.filter(e=>{if(a.segment&&e.segment!==a.segment)return!1;return Pi(i,e.name).match}).map(e=>({...e,type:yi.BRAND,relevanceScore:Pi(i,e.name).score}));o.push(...e)}o.sort((e,t)=>t.relevanceScore-e.relevanceScore),a.priceRange&&(o=o.filter(e=>{if(e.type!==yi.PRODUCT||!e.price)return!0;const[t,r]=a.priceRange.split("-").map(Number);return e.price>=t&&(!r||e.price<=r)})),s({type:bi,payload:{results:o,total:o.length}}),s({type:Si,payload:e})},[r.filters,"en"]),n=(e,t)=>{const r=e.toLowerCase();let s=0;const i=Pi(r,t.name);i.match&&(s+=3*i.score);const n=Pi(r,t.category);n.match&&(s+=2*n.score);const a=Pi(r,t.brand);return a.match&&(s+=1.5*a.score),t.keywords.forEach(e=>{const t=Pi(r,e);t.match&&(s+=1*t.score)}),s},a=R.useCallback(async e=>{if(!e.trim()||e.length<2)return void s({type:wi,payload:[]});const t=e.toLowerCase(),r=[];Ai.forEach(e=>{const s=e.name;s.toLowerCase().includes(t)&&r.push({text:s,type:"product",id:e.id,segment:e.segment})}),ji.forEach(e=>{const s=e.name;s.toLowerCase().includes(t)&&r.push({text:s,type:"category",id:e.id,segment:e.segment})}),Oi.forEach(e=>{e.name.toLowerCase().includes(t)&&r.push({text:e.name,type:"brand",id:e.id,segment:e.segment})});const i=r.filter((e,t,r)=>t===r.findIndex(t=>t.text===e.text)).slice(0,8);s({type:wi,payload:i})},["en"]),o={...r,performSearch:i,generateSuggestions:a,setQuery:e=>{s({type:vi,payload:e})},setFilters:e=>{s({type:_i,payload:e})},clearHistory:()=>{s({type:Ei}),localStorage.removeItem("ivolex_search_history")},SEARCH_TYPES:gi,RESULT_TYPES:yi};return e.jsx(fi.Provider,{value:o,children:t})},Ii=({onResultSelect:t,placeholder:r,showFilters:s=!0,className:h=""})=>{const{query:m,suggestions:p,searchHistory:f,loading:g,filters:y,performSearch:v,generateSuggestions:b,setQuery:w,setFilters:x,clearHistory:_,SEARCH_TYPES:S}=(()=>{const e=R.useContext(fi);if(!e)throw new Error("useSearch must be used within a SearchProvider");return e})(),{t:E,isRTL:T}=ye(),{theme:k}=re(),[A,j]=R.useState(!1),[O,P]=R.useState(m),[C,N]=R.useState(!1),I=R.useRef(null),D=R.useRef(null);R.useEffect(()=>{const e=e=>{I.current&&!I.current.contains(e.target)&&(j(!1),N(!1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),R.useEffect(()=>{const e=setTimeout(()=>{O.trim()&&A&&b(O)},300);return()=>clearTimeout(e)},[O,A,b]);const L=(e=O)=>{e.trim()&&(v(e),j(!1),t&&t({type:"search",query:e}))},$=e=>{P(e),w(e),L(e)},U=(e,t)=>{x({[e]:t}),O.trim()&&L()},M=e=>{switch(e){case"product":return"📦";case"category":return"📂";case"brand":return"🏷️";default:return"🔍"}},F=[{label:E("search.allPrices","All Prices"),value:null},{label:E("search.under500","Under 500 SAR"),value:"0-500"},{label:E("search.500to1000","500 - 1,000 SAR"),value:"500-1000"},{label:E("search.1000to2000","1,000 - 2,000 SAR"),value:"1000-2000"},{label:E("search.over2000","Over 2,000 SAR"),value:"2000-"}],B=[{label:E("search.relevance","Relevance"),value:"relevance"},{label:E("search.priceLowHigh","Price: Low to High"),value:"price_asc"},{label:E("search.priceHighLow","Price: High to Low"),value:"price_desc"},{label:E("search.newest","Newest First"),value:"newest"},{label:E("search.popular","Most Popular"),value:"popular"}];return e.jsxs("div",{className:`relative ${h}`,ref:I,children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"relative flex items-center bg-surface border border-border rounded-xl overflow-hidden transition-all duration-200 focus-within:ring-2 focus-within:ring-primary/20 focus-within:border-primary",style:{background:`linear-gradient(135deg, ${k.colors.surface}E6 0%, ${k.colors.background}CC 100%)`,backdropFilter:"blur(10px)"},children:[e.jsx(a,{className:"absolute top-1/2 transform -translate-y-1/2 text-foreground/40 "+(T?"right-4":"left-4"),size:20}),e.jsx("input",{ref:D,type:"text",value:O,onChange:e=>{const t=e.target.value;P(t),w(t),t.trim()&&j(!0)},onFocus:()=>j(!0),onKeyDown:e=>{"Enter"===e.key?L():"Escape"===e.key&&j(!1)},placeholder:r||E("search.placeholder","Search products, categories, brands..."),className:"w-full py-3 bg-transparent text-foreground placeholder-foreground/40 focus:outline-none "+(T?"pr-12 pl-16 text-right":"pl-12 pr-16 text-left"),dir:T?"rtl":"ltr"}),e.jsxs("div",{className:"absolute top-1/2 transform -translate-y-1/2 flex items-center gap-2 "+(T?"left-4":"right-4"),children:[O&&e.jsx(i.button,{initial:{scale:0},animate:{scale:1},exit:{scale:0},onClick:()=>{P(""),w(""),D.current?.focus()},className:"p-1 text-foreground/40 hover:text-foreground transition-colors rounded-full hover:bg-background/50",children:e.jsx(o,{size:16})}),s&&e.jsx(i.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>N(!C),className:"p-2 text-foreground/60 hover:text-primary transition-colors rounded-lg hover:bg-background/50 "+(C?"text-primary bg-primary/10":""),children:e.jsx(c,{size:16})})]})]}),g&&e.jsx("div",{className:"absolute top-full mt-1 "+(T?"right-4":"left-4"),children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-foreground/60",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-primary border-t-transparent"}),E("search.searching","Searching...")]})})]}),e.jsx(n,{children:C&&e.jsx(i.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute top-full mt-2 w-full bg-surface border border-border rounded-xl shadow-lg p-4 z-50 "+(T?"right-0":"left-0"),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:E("search.searchIn","Search in")}),e.jsxs("select",{value:y.type,onChange:e=>U("type",e.target.value),className:"w-full px-3 py-2 bg-background border border-border rounded-lg text-foreground focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:S.ALL,children:E("search.all","All")}),e.jsx("option",{value:S.PRODUCTS,children:E("search.products","Products")}),e.jsx("option",{value:S.CATEGORIES,children:E("search.categories","Categories")}),e.jsx("option",{value:S.BRANDS,children:E("search.brands","Brands")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:E("search.priceRange","Price Range")}),e.jsx("select",{value:y.priceRange||"",onChange:e=>U("priceRange",e.target.value||null),className:"w-full px-3 py-2 bg-background border border-border rounded-lg text-foreground focus:outline-none focus:ring-2 focus:ring-primary",children:F.map(t=>e.jsx("option",{value:t.value||"",children:t.label},t.value||"all"))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:E("search.sortBy","Sort by")}),e.jsx("select",{value:y.sortBy,onChange:e=>U("sortBy",e.target.value),className:"w-full px-3 py-2 bg-background border border-border rounded-lg text-foreground focus:outline-none focus:ring-2 focus:ring-primary",children:B.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]})]})})}),e.jsx(n,{children:A&&!C&&e.jsx(i.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute top-full mt-2 w-full bg-surface border border-border rounded-xl shadow-lg overflow-hidden z-50 max-h-96 "+(T?"right-0":"left-0"),children:O.trim()?e.jsx("div",{children:p.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-4 py-2 bg-background/50 border-b border-border",children:e.jsx("span",{className:"text-sm font-medium text-foreground/60",children:E("search.suggestions","Suggestions")})}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:p.map((r,s)=>e.jsxs(i.button,{initial:{opacity:0,x:T?20:-20},animate:{opacity:1,x:0},transition:{delay:.05*s},onClick:()=>(e=>{P(e.text),w(e.text),L(e.text),t&&t(e)})(r),className:"w-full px-4 py-3 text-left hover:bg-background/50 transition-colors flex items-center gap-3 "+(T?"flex-row-reverse text-right":""),children:[e.jsx("span",{className:"text-lg",children:M(r.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-foreground",children:r.text}),e.jsx("span",{className:"text-xs text-foreground/50 block capitalize",children:E(`search.${r.type}`,r.type)})]}),e.jsx(l,{size:16,className:"text-foreground/30 "+(T?"rotate-180":"")})]},`${r.type}-${r.id}-${s}`))})]}):e.jsxs("div",{className:"px-4 py-8 text-center",children:[e.jsx(a,{className:"mx-auto h-8 w-8 text-foreground/30 mb-2"}),e.jsx("p",{className:"text-foreground/60",children:E("search.noSuggestions","No suggestions found")}),e.jsx("button",{onClick:()=>L(),className:"mt-2 text-primary hover:text-primary/80 font-medium text-sm",children:E("search.searchAnyway","Search anyway")})]})}):e.jsxs("div",{children:[f.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-4 py-2 bg-background/50 border-b border-border flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-foreground/60 flex items-center gap-2",children:[e.jsx(d,{size:14}),E("search.recentSearches","Recent Searches")]}),e.jsx("button",{onClick:_,className:"text-xs text-foreground/40 hover:text-foreground transition-colors",children:E("search.clear","Clear")})]}),e.jsx("div",{className:"max-h-48 overflow-y-auto",children:f.slice(0,5).map((t,r)=>e.jsxs(i.button,{initial:{opacity:0,x:T?20:-20},animate:{opacity:1,x:0},transition:{delay:.05*r},onClick:()=>$(t),className:"w-full px-4 py-3 text-left hover:bg-background/50 transition-colors flex items-center gap-3 "+(T?"flex-row-reverse text-right":""),children:[e.jsx(d,{size:16,className:"text-foreground/30"}),e.jsx("span",{className:"text-foreground flex-1",children:t}),e.jsx(l,{size:14,className:"text-foreground/30 "+(T?"rotate-180":"")})]},`history-${r}`))})]}),e.jsxs("div",{className:"px-4 py-2 border-t border-border",children:[e.jsxs("span",{className:"text-sm font-medium text-foreground/60 flex items-center gap-2",children:[e.jsx(u,{size:14}),E("search.popularSearches","Popular Searches")]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:["leather wallet","gaming setup","office chair","headphones","dining table"].map((t,r)=>e.jsx(i.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.1*r},onClick:()=>$(t),className:"px-3 py-1 bg-background hover:bg-primary/10 text-foreground/70 hover:text-primary text-sm rounded-full border border-border transition-colors",children:t},t))})]})]})})})]})},Di=({isOpen:t,onClose:r})=>{const{alerts:a,allAlerts:c,acknowledgeAlert:l,clearAlerts:u}=De(),{theme:y}=re(),[v,b]=R.useState("active"),w=(()=>{switch(v){case"active":default:return a;case"all":return c;case"acknowledged":return c.filter(e=>e.acknowledged)}})(),x=t=>{switch(t){case"critical":return e.jsx(g,{className:"w-5 h-5 text-red-500"});case"low":return e.jsx(f,{className:"w-5 h-5 text-yellow-500"});case"reorder":return e.jsx(s,{className:"w-5 h-5 text-blue-500"});default:return e.jsx(p,{className:"w-5 h-5 text-gray-500"})}},_=e=>{switch(e){case"critical":return"border-red-200 bg-red-50";case"low":return"border-yellow-200 bg-yellow-50";case"reorder":return"border-blue-200 bg-blue-50";default:return"border-gray-200 bg-gray-50"}},S=e=>{const t=new Date(e),r=new Date,s=Math.floor((r-t)/6e4);return s<1?"Just now":s<60?`${s}m ago`:s<1440?`${Math.floor(s/60)}h ago`:t.toLocaleDateString()};return e.jsx(n,{children:t&&e.jsxs(e.Fragment,{children:[e.jsx(i.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:r}),e.jsxs(i.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:`fixed right-0 top-0 h-full w-full max-w-md ${y.cardBackground} ${y.border} border-l z-50 flex flex-col shadow-2xl`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"w-5 h-5 text-blue-500"}),e.jsx("h2",{className:`text-lg font-semibold ${y.text}`,children:"Inventory Alerts"}),a.length>0&&e.jsx("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:a.length})]}),e.jsx("button",{onClick:r,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx(o,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex border-b",children:[e.jsxs("button",{onClick:()=>b("active"),className:"flex-1 px-4 py-3 text-sm font-medium transition-colors "+("active"===v?`${y.accent} text-white`:`${y.text} hover:bg-gray-50`),children:["Active (",a.length,")"]}),e.jsxs("button",{onClick:()=>b("all"),className:"flex-1 px-4 py-3 text-sm font-medium transition-colors "+("all"===v?`${y.accent} text-white`:`${y.text} hover:bg-gray-50`),children:["All (",c.length,")"]}),e.jsxs("button",{onClick:()=>b("acknowledged"),className:"flex-1 px-4 py-3 text-sm font-medium transition-colors "+("acknowledged"===v?`${y.accent} text-white`:`${y.text} hover:bg-gray-50`),children:["Read (",c.filter(e=>e.acknowledged).length,")"]})]}),"active"===v&&a.length>0&&e.jsx("div",{className:"p-4 border-b",children:e.jsx("button",{onClick:u,className:`w-full px-4 py-2 text-sm rounded-lg ${y.cardBackground} ${y.border} hover:${y.borderHover} transition-colors`,children:"Clear All Alerts"})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:0===w.length?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-8 text-center",children:[e.jsx(h,{className:"w-16 h-16 text-gray-300 mb-4"}),e.jsx("h3",{className:`text-lg font-medium ${y.text} mb-2`,children:"No alerts"}),e.jsx("p",{className:`text-sm ${y.textSecondary}`,children:"active"===v?"All your inventory levels are healthy!":"acknowledged"===v?"No acknowledged alerts yet":"No alerts have been generated"})]}):e.jsx("div",{className:"p-4 space-y-3",children:w.map(t=>e.jsx(i.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`p-4 rounded-lg border ${_(t.type)} ${t.acknowledged?"opacity-60":""}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:x(t.type)}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.productName}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.message}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(d,{className:"w-3 h-3"}),S(t.timestamp)]}),e.jsxs("div",{children:["Available: ",t.availableStock]})]})]}),!t.acknowledged&&e.jsx("button",{onClick:()=>l(t.id),className:"flex-shrink-0 p-1 text-gray-400 hover:text-green-500 transition-colors",title:"Mark as read",children:e.jsx(m,{className:"w-4 h-4"})})]})})]})},t.id))})}),e.jsx("div",{className:`p-4 border-t ${y.cardBackground}`,children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:`text-xs ${y.textSecondary}`,children:"Inventory alerts help you maintain optimal stock levels"})})})]})]})})},Li=[{label:"nav.home",href:"/",segment:"all"},{label:"nav.shop",href:"/shop",segment:"all"},{label:"nav.categories",href:"/categories",segment:"all"},{label:"nav.customize",href:"/customize",segment:"all"},{label:"nav.about",href:"/about",segment:"all"},{label:"nav.contact",href:"/contact",segment:"all"}];function $i(){const t=I(),[r,c]=R.useState(!1),[l,d]=R.useState(!1),[u,h]=R.useState(!1),[m,p]=R.useState(!1),[f,g]=R.useState(!1),[w,x]=R.useState(!1),[_,S]=R.useState(!1),{theme:E}=re(),{alerts:T}=De(),{user:k,isAuthenticated:A}=mi(),{t:j,isRTL:O}=ye();R.useEffect(()=>{const e=()=>{c(window.scrollY>100)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),R.useEffect(()=>{const e=e=>{if(f||w||_){let t=e.target,r=!1;for(;t;){if(t.classList&&(t.classList.contains("relative")||"BUTTON"===t.tagName)){r=!0;break}t=t.parentElement}r||(g(!1),x(!1),S(!1))}};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[f,w,_]);const P="admin"===k?.role||"super_admin"===k?.role;return e.jsxs(e.Fragment,{children:[e.jsx(i.nav,{className:"fixed top-4 z-40 transition-all duration-300 top-0.5 left-0 right-0 px-4",initial:{y:-100,opacity:0},animate:{y:0,opacity:1},transition:{duration:.6,ease:"easeOut"},children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"backdrop-blur-xl bg-surface/40 border border-border/50 rounded-2xl shadow-segment-xl px-6 py-4",style:{background:`linear-gradient(135deg, ${E.colors.surface}CC 0%, ${E.colors.background}E6 100%)`,backdropFilter:"blur(50px)"},children:e.jsxs("div",{className:"flex items-center justify-between "+(O?"flex-row-reverse":""),children:[e.jsxs(i.div,{className:"flex items-center gap-3 "+(O?"flex-row-reverse":""),whileHover:{scale:1.05},whileTap:{scale:.95},children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center text-white font-bold text-lg shadow-segment-md",style:{backgroundColor:E.colors.primary},children:"I"}),e.jsx("span",{className:"text-xl font-bold text-foreground",children:"IVOLEX"})]}),e.jsx("div",{className:"hidden lg:flex items-center gap-8 "+(O?"flex-row-reverse":""),children:Li.map(t=>e.jsx(i.a,{href:t.href,className:"text-foreground/70 hover:text-primary transition-colors font-medium",whileHover:{y:-2},whileTap:{y:0},children:j(t.label)},t.label))}),e.jsxs("div",{className:"hidden md:flex items-center",children:[e.jsx(ae,{className:"transition-all duration-300 "+(_?"flex-col bg-surface/90 backdrop-blur-lg p-2 rounded-2xl shadow-lg absolute top-16 left-1/2 transform -translate-x-1/2 w-48 z-50":""),onToggle:()=>S(!_)}),e.jsx("button",{className:"md:hidden ml-2 p-2 text-foreground/70 hover:text-primary hover:bg-background/50 rounded-full transition-all",onClick:()=>S(!_),"aria-label":"Toggle categories",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),e.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),e.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})})]}),e.jsxs("div",{className:"flex items-center gap-3 "+(O?"flex-row-reverse":""),children:[P&&e.jsxs(i.button,{onClick:()=>p(!0),className:"relative p-2 text-foreground/70 hover:text-primary hover:bg-background/50 rounded-full transition-all",whileHover:{scale:1.1},whileTap:{scale:.9},"aria-label":"Inventory Alerts",children:[e.jsx(s,{size:20}),T.length>0&&e.jsx(i.span,{className:"absolute w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center font-medium "+(O?"bottom-1 left-1":"-top-1 -right-1"),initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30},children:T.length})]}),e.jsx(i.button,{onClick:()=>h(!u),className:"p-2 text-foreground/70 hover:text-primary hover:bg-background/50 rounded-full transition-all",whileHover:{scale:1.1},whileTap:{scale:.9},"aria-label":j("nav.search"),children:e.jsx(a,{size:20})}),A?e.jsx(i.a,{href:"/profile",className:"p-2 text-foreground/70 hover:text-primary hover:bg-background/50 rounded-full transition-all",whileHover:{scale:1.1},whileTap:{scale:.9},"aria-label":j("nav.profile"),children:e.jsx(y,{size:20})}):e.jsx(i.a,{href:"/login",className:"p-2 text-foreground/70 hover:text-primary hover:bg-background/50 rounded-full transition-all",whileHover:{scale:1.1},whileTap:{scale:.9},"aria-label":j("nav.login"),children:e.jsx(y,{size:20})}),e.jsxs(i.button,{className:"relative p-2 text-foreground/70 hover:text-primary hover:bg-background/50 rounded-full transition-all",whileHover:{scale:1.1},whileTap:{scale:.9},"aria-label":j("nav.cart"),onClick:()=>t("/cart"),children:[e.jsx(v,{size:20}),e.jsx(i.span,{className:"absolute w-5 h-5 bg-accent text-white text-xs rounded-full flex items-center justify-center font-medium "+(O?"bottom-1 left-1":"-top-1 -right-1"),initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30},children:3})]}),e.jsx(i.button,{onClick:()=>d(!l),className:"lg:hidden p-2 text-foreground/70 hover:text-primary hover:bg-background/50 rounded-full transition-all",whileHover:{scale:1.1},whileTap:{scale:.9},"aria-label":l?"Close menu":"Open menu","aria-expanded":l,children:l?e.jsx(o,{size:20}):e.jsx(b,{size:20})})]})]})})})}),e.jsx(n,{children:u&&e.jsx(i.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-start justify-center pt-32",onClick:()=>h(!1),children:e.jsx(i.div,{initial:{y:-50,opacity:0},animate:{y:0,opacity:1},exit:{y:-50,opacity:0},className:"w-full max-w-2xl mx-4",onClick:e=>e.stopPropagation(),children:e.jsx("div",{className:"bg-surface border border-border rounded-2xl shadow-segment-xl p-6",children:e.jsx(Ii,{placeholder:j("search.placeholder","Search products, categories, or brands..."),onResultSelect:e=>{h(!1)},showFilters:!0})})})})}),e.jsx(n,{children:l&&e.jsx(i.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"fixed top-16 z-30 lg:hidden left-0 right-0 px-4",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"backdrop-blur-xl border border-border/50 rounded-2xl shadow-segment-xl p-6",style:{background:`linear-gradient(135deg, ${E.colors.surface}CC 0%, ${E.colors.background}E6 100%)`,backdropFilter:"blur(20px)"},children:[e.jsx("div",{className:"mb-6",children:e.jsx(ae,{className:"justify-center"})}),e.jsx("div",{className:"space-y-4",children:Li.map(t=>e.jsx(i.a,{href:t.href,className:"block py-3 px-4 text-foreground hover:text-primary hover:bg-background/50 rounded-xl transition-colors font-medium "+(O?"text-right":"text-left"),whileHover:{x:O?-4:4},onClick:()=>d(!1),children:j(t.label)},t.label))}),e.jsx("div",{className:"mt-6 pt-4 border-t border-border",children:A?e.jsx(i.a,{href:"/profile",className:"block py-3 px-4 text-foreground hover:text-primary hover:bg-background/50 rounded-xl transition-colors font-medium "+(O?"text-right":"text-left"),whileHover:{x:O?-4:4},onClick:()=>d(!1),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(y,{size:20}),j("nav.profile")]})}):e.jsx(i.a,{href:"/login",className:"block py-3 px-4 text-foreground hover:text-primary hover:bg-background/50 rounded-xl transition-colors font-medium "+(O?"text-right":"text-left"),whileHover:{x:O?-4:4},onClick:()=>d(!1),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(y,{size:20}),j("nav.login")]})})})]})})})}),P&&e.jsx(Di,{isOpen:m,onClose:()=>p(!1)})]})}const Ui={SA:"SAR",AE:"AED",QA:"QAR",KW:"KWD",BH:"BHD",OM:"OMR",IQ:"IQD",JO:"JOD",LB:"LBP",SY:"SYP",YE:"YER",IL:"ILS",PS:"ILS",TR:"TRY",IR:"IRR",AF:"AFN",AD:"EUR",AL:"ALL",AT:"EUR",BA:"BAM",BE:"EUR",BG:"BGN",BY:"BYN",CH:"CHF",CY:"EUR",CZ:"CZK",DE:"EUR",DK:"DKK",EE:"EUR",ES:"EUR",FI:"EUR",FR:"EUR",GB:"GBP",GR:"EUR",HR:"EUR",HU:"HUF",IE:"EUR",IS:"ISK",IT:"EUR",LI:"CHF",LT:"EUR",LU:"EUR",LV:"EUR",MC:"EUR",MD:"MDL",ME:"EUR",MK:"MKD",MT:"EUR",NL:"EUR",NO:"NOK",PL:"PLN",PT:"EUR",RO:"RON",RS:"RSD",RU:"RUB",SE:"SEK",SI:"EUR",SK:"EUR",SM:"EUR",UA:"UAH",VA:"EUR",XK:"EUR",US:"USD",CA:"CAD",MX:"MXN",AR:"ARS",BR:"BRL",CL:"CLP",CO:"COP",PE:"PEN",VE:"VES",EC:"USD",UY:"UYU",PY:"PYG",BO:"BOB",GY:"GYD",SR:"SRD",FK:"FKP",GF:"EUR",CU:"CUP",DO:"DOP",HT:"HTG",JM:"JMD",TT:"TTD",BB:"BBD",BS:"BSD",BZ:"BZD",CR:"CRC",GT:"GTQ",HN:"HNL",NI:"NIO",PA:"PAB",SV:"USD",AG:"XCD",DM:"XCD",GD:"XCD",KN:"XCD",LC:"XCD",VC:"XCD",AI:"XCD",AW:"AWG",BM:"BMD",BQ:"USD",CW:"ANG",GL:"DKK",GP:"EUR",KY:"KYD",MQ:"EUR",MS:"XCD",PM:"EUR",PR:"USD",SX:"ANG",TC:"USD",VG:"USD",VI:"USD",CN:"CNY",JP:"JPY",KR:"KRW",IN:"INR",TH:"THB",VN:"VND",ID:"IDR",MY:"MYR",SG:"SGD",PH:"PHP",BD:"BDT",PK:"PKR",LK:"LKR",NP:"NPR",BT:"BTN",MV:"MVR",MM:"MMK",KH:"KHR",LA:"LAK",MN:"MNT",TW:"TWD",HK:"HKD",MO:"MOP",AU:"AUD",NZ:"NZD",FJ:"FJD",PG:"PGK",VU:"VUV",SB:"SBD",NC:"XPF",PF:"XPF",WS:"WST",TO:"TOP",KI:"AUD",TV:"AUD",NR:"AUD",PW:"USD",FM:"USD",MH:"USD",CK:"NZD",NU:"NZD",TK:"NZD",EG:"EGP",ZA:"ZAR",NG:"NGN",KE:"KES",MA:"MAD",TN:"TND",DZ:"DZD",LY:"LYD",SD:"SDG",ET:"ETB",GH:"GHS",CI:"XOF",SN:"XOF",ML:"XOF",BF:"XOF",NE:"XOF",TG:"XOF",BJ:"XOF",GN:"GNF",SL:"SLL",LR:"LRD",CM:"XAF",CF:"XAF",TD:"XAF",CG:"XAF",GA:"XAF",GQ:"XAF",AO:"AOA",ZM:"ZMW",ZW:"ZWL",BW:"BWP",NA:"NAD",SZ:"SZL",LS:"LSL",MW:"MWK",MZ:"MZN",MG:"MGA",MU:"MUR",SC:"SCR",KM:"KMF",DJ:"DJF",SO:"SOS",ER:"ERN",UG:"UGX",TZ:"TZS",RW:"RWF",BI:"BIF"},Mi={SA:"Middle East",AE:"Middle East",QA:"Middle East",KW:"Middle East",BH:"Middle East",OM:"Middle East",IQ:"Middle East",JO:"Middle East",LB:"Middle East",SY:"Middle East",YE:"Middle East",IL:"Middle East",PS:"Middle East",TR:"Middle East",IR:"Middle East",AF:"Middle East",AD:"Europe",AL:"Europe",AT:"Europe",BA:"Europe",BE:"Europe",BG:"Europe",BY:"Europe",CH:"Europe",CY:"Europe",CZ:"Europe",DE:"Europe",DK:"Europe",EE:"Europe",ES:"Europe",FI:"Europe",FR:"Europe",GB:"Europe",GR:"Europe",HR:"Europe",HU:"Europe",IE:"Europe",IS:"Europe",IT:"Europe",LI:"Europe",LT:"Europe",LU:"Europe",LV:"Europe",MC:"Europe",MD:"Europe",ME:"Europe",MK:"Europe",MT:"Europe",NL:"Europe",NO:"Europe",PL:"Europe",PT:"Europe",RO:"Europe",RS:"Europe",RU:"Europe",SE:"Europe",SI:"Europe",SK:"Europe",SM:"Europe",UA:"Europe",VA:"Europe",XK:"Europe",US:"Americas",CA:"Americas",MX:"Americas",AR:"Americas",BR:"Americas",CL:"Americas",CO:"Americas",PE:"Americas",VE:"Americas",EC:"Americas",UY:"Americas",PY:"Americas",BO:"Americas",GY:"Americas",SR:"Americas",FK:"Americas",GF:"Americas",CU:"Americas",DO:"Americas",HT:"Americas",JM:"Americas",TT:"Americas",BB:"Americas",BS:"Americas",BZ:"Americas",CR:"Americas",GT:"Americas",HN:"Americas",NI:"Americas",PA:"Americas",SV:"Americas",AG:"Americas",DM:"Americas",GD:"Americas",KN:"Americas",LC:"Americas",VC:"Americas",AI:"Americas",AW:"Americas",BM:"Americas",BQ:"Americas",CW:"Americas",GL:"Americas",GP:"Americas",KY:"Americas",MQ:"Americas",MS:"Americas",PM:"Americas",PR:"Americas",SX:"Americas",TC:"Americas",VG:"Americas",VI:"Americas",CN:"Asia Pacific",JP:"Asia Pacific",KR:"Asia Pacific",IN:"Asia Pacific",TH:"Asia Pacific",VN:"Asia Pacific",ID:"Asia Pacific",MY:"Asia Pacific",SG:"Asia Pacific",PH:"Asia Pacific",BD:"Asia Pacific",PK:"Asia Pacific",LK:"Asia Pacific",NP:"Asia Pacific",BT:"Asia Pacific",MV:"Asia Pacific",MM:"Asia Pacific",KH:"Asia Pacific",LA:"Asia Pacific",MN:"Asia Pacific",TW:"Asia Pacific",HK:"Asia Pacific",MO:"Asia Pacific",AU:"Asia Pacific",NZ:"Asia Pacific",FJ:"Asia Pacific",PG:"Asia Pacific",VU:"Asia Pacific",SB:"Asia Pacific",NC:"Asia Pacific",PF:"Asia Pacific",WS:"Asia Pacific",TO:"Asia Pacific",KI:"Asia Pacific",TV:"Asia Pacific",NR:"Asia Pacific",PW:"Asia Pacific",FM:"Asia Pacific",MH:"Asia Pacific",CK:"Asia Pacific",NU:"Asia Pacific",TK:"Asia Pacific",EG:"Africa",ZA:"Africa",NG:"Africa",KE:"Africa",MA:"Africa",TN:"Africa",DZ:"Africa",LY:"Africa",SD:"Africa",ET:"Africa",GH:"Africa",CI:"Africa",SN:"Africa",ML:"Africa",BF:"Africa",NE:"Africa",TG:"Africa",BJ:"Africa",GN:"Africa",SL:"Africa",LR:"Africa",CM:"Africa",CF:"Africa",TD:"Africa",CG:"Africa",GA:"Africa",GQ:"Africa",AO:"Africa",ZM:"Africa",ZW:"Africa",BW:"Africa",NA:"Africa",SZ:"Africa",LS:"Africa",MW:"Africa",MZ:"Africa",MG:"Africa",MU:"Africa",SC:"Africa",KM:"Africa",DJ:"Africa",SO:"Africa",ER:"Africa",UG:"Africa",TZ:"Africa",RW:"Africa",BI:"Africa"},Fi=[{code:"USD",symbol:"$",name:"US Dollar"},{code:"EUR",symbol:"€",name:"Euro"},{code:"GBP",symbol:"£",name:"British Pound"},{code:"JPY",symbol:"¥",name:"Japanese Yen"},{code:"CNY",symbol:"¥",name:"Chinese Yuan"},{code:"SAR",symbol:"SAR",name:"Saudi Riyal"},{code:"AED",symbol:"AED",name:"UAE Dirham"},{code:"QAR",symbol:"QAR",name:"Qatari Riyal"},{code:"KWD",symbol:"KWD",name:"Kuwaiti Dinar"},{code:"BHD",symbol:"BHD",name:"Bahraini Dinar"},{code:"OMR",symbol:"OMR",name:"Omani Rial"},{code:"ILS",symbol:"₪",name:"Israeli Shekel"},{code:"TRY",symbol:"₺",name:"Turkish Lira"},{code:"CAD",symbol:"C$",name:"Canadian Dollar"},{code:"MXN",symbol:"$",name:"Mexican Peso"},{code:"BRL",symbol:"R$",name:"Brazilian Real"},{code:"ARS",symbol:"$",name:"Argentine Peso"},{code:"CLP",symbol:"$",name:"Chilean Peso"},{code:"COP",symbol:"$",name:"Colombian Peso"},{code:"CHF",symbol:"CHF",name:"Swiss Franc"},{code:"NOK",symbol:"kr",name:"Norwegian Krone"},{code:"SEK",symbol:"kr",name:"Swedish Krona"},{code:"DKK",symbol:"kr",name:"Danish Krone"},{code:"PLN",symbol:"zł",name:"Polish Zloty"},{code:"CZK",symbol:"Kč",name:"Czech Koruna"},{code:"HUF",symbol:"Ft",name:"Hungarian Forint"},{code:"RON",symbol:"lei",name:"Romanian Leu"},{code:"RUB",symbol:"₽",name:"Russian Ruble"},{code:"KRW",symbol:"₩",name:"South Korean Won"},{code:"INR",symbol:"₹",name:"Indian Rupee"},{code:"THB",symbol:"฿",name:"Thai Baht"},{code:"VND",symbol:"₫",name:"Vietnamese Dong"},{code:"IDR",symbol:"Rp",name:"Indonesian Rupiah"},{code:"MYR",symbol:"RM",name:"Malaysian Ringgit"},{code:"SGD",symbol:"S$",name:"Singapore Dollar"},{code:"PHP",symbol:"₱",name:"Philippine Peso"},{code:"HKD",symbol:"HK$",name:"Hong Kong Dollar"},{code:"TWD",symbol:"NT$",name:"Taiwan Dollar"},{code:"AUD",symbol:"A$",name:"Australian Dollar"},{code:"NZD",symbol:"NZ$",name:"New Zealand Dollar"},{code:"ZAR",symbol:"R",name:"South African Rand"},{code:"EGP",symbol:"£",name:"Egyptian Pound"},{code:"NGN",symbol:"₦",name:"Nigerian Naira"},{code:"KES",symbol:"KSh",name:"Kenyan Shilling"},{code:"MAD",symbol:"MAD",name:"Moroccan Dirham"},{code:"TND",symbol:"TND",name:"Tunisian Dinar"}].sort((e,t)=>e.name.localeCompare(t.name)),Bi=["Global","Africa","Americas","Asia Pacific","Europe","Middle East"],Hi=R.createContext(),zi=()=>{const e=R.useContext(Hi);if(!e)throw new Error("useLocation must be used within a LocationProvider");return e},Gi=({children:t})=>{const[r,s]=R.useState({country:"India",region:"Asia Pacific",currency:"INR",loading:!0,error:null}),[i,n]=R.useState({currency:null,region:null}),a=R.useCallback(async()=>{try{const e=await fetch("https://ipapi.co/json/"),t=await e.json(),r=t.country_code,i=Mi[r]||"Global",n=Ui[r]||"USD";s({country:t.country_name,region:i,currency:n,loading:!1,error:null})}catch(e){s(e=>({...e,loading:!1,error:"Failed to detect location"}))}},[]),o=R.useCallback(async()=>{try{navigator.geolocation?navigator.geolocation.getCurrentPosition(async e=>{const{latitude:t,longitude:r}=e.coords,i=await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${t}&longitude=${r}&localityLanguage=en`),n=await i.json(),a=n.countryCode,o=Mi[a]||"Global",c=Ui[a]||"USD";s({country:n.countryName,region:o,currency:c,loading:!1,error:null})},async e=>{await a()}):await a()}catch(e){s(e=>({...e,loading:!1,error:"Failed to detect location"}))}},[a]),c=i.currency||r.currency,l=i.region||r.region;R.useEffect(()=>{o()},[o]);const d={location:r,manualOverride:i,effectiveCurrency:c,effectiveRegion:l,setManualCurrency:e=>{n(t=>({...t,currency:e}))},setManualRegion:e=>{n(t=>({...t,region:e}))},detectLocation:o};return e.jsx(Hi.Provider,{value:d,children:t})};function Wi({variant:t="default",showRegion:r=!0,className:s=""}){const{effectiveCurrency:i,effectiveRegion:n,setManualCurrency:a,setManualRegion:o}=zi(),[c,l]=R.useState(!1),[d,u]=R.useState(!1),h=R.useRef(null),m=R.useRef(null);R.useEffect(()=>{const e=e=>{h.current&&!h.current.contains(e.target)&&l(!1),m.current&&!m.current.contains(e.target)&&u(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const p=Fi.find(e=>e.code===i)||Fi[0],f=()=>{const e="flex items-center gap-2 transition-colors focus:outline-none focus:ring-2 focus:ring-brand-500";switch(t){case"footer":return`${e} text-stone-300 hover:text-white px-3 py-2 text-sm border border-stone-700 rounded-lg hover:border-stone-500`;case"profile":return`${e} border rounded-xl px-4 py-3 hover:bg-stone-50 text-sm`;default:return`${e} text-sm border rounded-xl px-3 py-1.5 hover:bg-stone-50`}},g=()=>{const e="absolute z-50 mt-1 bg-white border rounded-xl shadow-lg";switch(t){case"footer":return`${e} border-stone-600 bg-stone-800 text-stone-200 min-w-[280px] max-h-80 overflow-hidden`;case"profile":return`${e} min-w-[320px] max-h-96 overflow-hidden`;default:return`${e} min-w-[280px] max-h-80 overflow-hidden`}},y=()=>{const e="w-full text-left px-3 py-2 text-sm transition-colors";return"footer"===t?`${e} hover:bg-stone-700 text-stone-200`:`${e} hover:bg-stone-50`};return e.jsxs("div",{className:`space-y-3 ${s}`,children:[r&&e.jsxs("div",{className:"relative",ref:m,children:[e.jsx("label",{className:"block text-sm font-medium mb-2 "+("footer"===t?"text-stone-300":"text-stone-700"),children:"Region:"}),e.jsxs("button",{onClick:()=>u(!d),className:f(),children:[e.jsx(w,{size:16}),e.jsx("span",{className:"flex-1 text-left",children:n||"Global"}),e.jsx(x,{size:14,className:"transition-transform "+(d?"rotate-180":"")})]}),d&&e.jsx("div",{className:g(),children:e.jsx("div",{className:"p-2 space-y-1 max-h-48 overflow-y-auto",children:Bi.map(r=>e.jsx("button",{onClick:()=>{o("Global"===r?null:r),u(!1)},className:`${y()} ${(n||"Global")===r?"footer"===t?"bg-stone-700 text-white":"bg-brand-50 text-brand-700":""}`,children:r},r))})})]}),e.jsxs("div",{className:"relative",ref:h,children:[e.jsx("label",{className:"block text-sm font-medium mb-2 "+("footer"===t?"text-stone-300":"text-stone-700"),children:"Currency:"}),e.jsxs("button",{onClick:()=>l(!c),className:f(),children:[e.jsx("span",{className:"text-lg",children:p.symbol}),e.jsxs("span",{className:"flex-1 text-left",children:[p.code," - ",p.name]}),e.jsx(x,{size:14,className:"transition-transform "+(c?"rotate-180":"")})]}),c&&e.jsx("div",{className:g(),children:e.jsx("div",{className:"max-h-64 overflow-y-auto p-2 space-y-1",children:Fi.map(r=>e.jsxs("button",{onClick:()=>{a(r.code),l(!1)},className:`${y()} flex items-center gap-3 ${i===r.code?"footer"===t?"bg-stone-700 text-white":"bg-brand-50 text-brand-700":""}`,children:[e.jsx("span",{className:"text-lg font-mono w-6 text-center",children:r.symbol}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:r.code}),e.jsx("div",{className:"text-xs "+("footer"===t?"text-stone-400":"text-stone-500"),children:r.name})]})]},r.code))})})]})]})}function Vi({children:t,className:r=""}){return e.jsx("div",{className:`mx-auto w-full h-full max-w-7xl px-4 sm:px-6 lg:px-8 ${r}`,children:t})}function qi(){const{isAuthenticated:t}=mi(),r=[{icon:T,href:"#",label:"Facebook"},{icon:k,href:"#",label:"Instagram"},{icon:A,href:"#",label:"Twitter"},{icon:j,href:"#",label:"YouTube"}],s={shop:[{name:"Wallets",href:"#"},{name:"Bags",href:"#"},{name:"Belts",href:"#"},{name:"Footwear",href:"#"},{name:"Accessories",href:"#"}],company:[{name:"About Us",href:"#about"},{name:"Customization",href:"#customize"},{name:"Sustainability",href:"#"},{name:"Careers",href:"#"}],support:[{name:"FAQs",href:"#"},{name:"Shipping & Returns",href:"#"},{name:"Care Guide",href:"#"},{name:"Privacy Policy",href:"#"},{name:"Terms & Conditions",href:"#"}]};return e.jsx("footer",{id:"about",className:"bg-stone-900 text-stone-200",children:e.jsxs(Vi,{children:[e.jsxs("div",{className:"grid gap-8 py-12 "+(t?"md:grid-cols-4":"md:grid-cols-5"),children:[e.jsxs(i.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6},viewport:{once:!0},children:[e.jsx("div",{className:"font-bold text-xl text-white mb-4",children:"IVOLEX"}),e.jsx("p",{className:"text-sm text-stone-400 mb-6 leading-relaxed",children:"Crafting premium leather goods with passion and precision since 2010. Each piece tells a story of craftsmanship and elegance."}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm text-stone-400",children:[e.jsx(_,{size:16}),e.jsx("span",{children:"Riyadh, Saudi Arabia"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-stone-400",children:[e.jsx(S,{size:16}),e.jsx("span",{children:"+966 50 123 4567"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-stone-400",children:[e.jsx(E,{size:16}),e.jsx("span",{children:"hello@ivolex.com"})]})]}),e.jsx("div",{className:"flex gap-3",children:r.map((t,r)=>{const s=t.icon;return e.jsx(i.a,{href:t.href,"aria-label":t.label,className:"w-10 h-10 rounded-full bg-stone-800 flex items-center justify-center hover:bg-brand-600 transition-colors duration-200",whileHover:{scale:1.1},whileTap:{scale:.95},initial:{opacity:0,scale:0},whileInView:{opacity:1,scale:1},transition:{duration:.3,delay:.1*r},viewport:{once:!0},children:e.jsx(s,{size:18})},t.label)})})]}),e.jsxs(i.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.1},viewport:{once:!0},children:[e.jsx("div",{className:"font-semibold text-white mb-4",children:"Shop"}),e.jsx("ul",{className:"space-y-3 text-sm text-stone-400",children:s.shop.map((t,r)=>e.jsx(i.li,{initial:{opacity:0,x:-10},whileInView:{opacity:1,x:0},transition:{duration:.3,delay:.05*r},viewport:{once:!0},children:e.jsx("a",{href:t.href,className:"hover:text-white transition-colors duration-200",children:t.name})},t.name))})]}),e.jsxs(i.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.2},viewport:{once:!0},children:[e.jsx("div",{className:"font-semibold text-white mb-4",children:"Company"}),e.jsx("ul",{className:"space-y-3 text-sm text-stone-400",children:s.company.map((t,r)=>e.jsx(i.li,{initial:{opacity:0,x:-10},whileInView:{opacity:1,x:0},transition:{duration:.3,delay:.05*r},viewport:{once:!0},children:e.jsx("a",{href:t.href,className:"hover:text-white transition-colors duration-200",children:t.name})},t.name))})]}),e.jsxs(i.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.3},viewport:{once:!0},children:[e.jsx("div",{className:"font-semibold text-white mb-4",children:"Support"}),e.jsx("ul",{className:"space-y-3 text-sm text-stone-400",children:s.support.map((t,r)=>e.jsx(i.li,{initial:{opacity:0,x:-10},whileInView:{opacity:1,x:0},transition:{duration:.3,delay:.05*r},viewport:{once:!0},children:e.jsx("a",{href:t.href,className:"hover:text-white transition-colors duration-200",children:t.name})},t.name))})]})]}),e.jsx(i.div,{className:"border-t border-stone-800 pt-6",initial:{opacity:0},whileInView:{opacity:1},transition:{duration:.6,delay:.4},viewport:{once:!0},children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[e.jsx("div",{className:"text-sm text-stone-500",children:"© 2024 IVOLEX. All rights reserved."}),!t&&e.jsx("div",{className:"flex items-center gap-4",children:e.jsx(Wi,{variant:"footer",showRegion:!1})}),e.jsx("div",{className:"text-sm text-stone-500",children:"Developed by Limitless Infotech Solution Pvt Ltd."}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-xs text-stone-500 mr-2",children:"We accept:"}),e.jsx("div",{className:"flex items-center gap-2",children:["visa","mastercard","amex","paypal"].map(t=>e.jsx("div",{className:"w-8 h-5 bg-stone-700 rounded border border-stone-600 flex items-center justify-center text-[8px] font-bold text-stone-300",children:t.slice(0,2).toUpperCase()},t))})]})]})})]})})}const Ki=R.createContext(null);function Ji(e,t){switch(t.type){case"add":{const{id:r,qty:s=1,item:i}=t,n=e.items[r],a=(n?.qty||0)+s;return{...e,items:{...e.items,[r]:{item:i,qty:a}}}}case"remove":{const r={...e.items};return delete r[t.id],{...e,items:r}}case"setQty":{const{id:r,qty:s}=t;if(s<=0){const t={...e.items};return delete t[r],{...e,items:t}}return{...e,items:{...e.items,[r]:{...e.items[r],qty:s}}}}case"clear":return{items:{}};default:return e}}function Yi({children:t}){const[r,s]=R.useReducer(Ji,{items:{}}),[i,n]=R.useState(new Set),a=R.useMemo(()=>{const e=Object.entries(r.items).map(([e,t])=>({id:e,...t})),t=e.reduce((e,t)=>e+t.qty,0),a=e.reduce((e,t)=>e+(t.item?.price||0)*t.qty,0);return{state:r,items:e,count:t,total:a,add:(e,t=1)=>s({type:"add",id:e.id,qty:t,item:e}),remove:e=>s({type:"remove",id:e}),setQty:async(e,t)=>{n(t=>new Set(t).add(e)),await new Promise(e=>setTimeout(e,500)),s({type:"setQty",id:e,qty:t}),n(t=>{const r=new Set(t);return r.delete(e),r})},clear:()=>s({type:"clear"}),isUpdating:e=>i.has(e)}},[r,i]);return e.jsx(Ki.Provider,{value:a,children:t})}function Zi(){const e=R.useContext(Ki);if(!e)throw new Error("useCart must be used within CartProvider");return e}const Xi={PENDING:"pending",CONFIRMED:"confirmed",PROCESSING:"processing",SHIPPED:"shipped",DELIVERED:"delivered",CANCELLED:"cancelled",REFUNDED:"refunded"},Qi={[Xi.PENDING]:{label:"Pending Payment",labelAr:"في انتظار الدفع",color:"bg-yellow-100 text-yellow-800",step:1},[Xi.CONFIRMED]:{label:"Payment Confirmed",labelAr:"تم تأكيد الدفع",color:"bg-blue-100 text-blue-800",step:2},[Xi.PROCESSING]:{label:"Processing",labelAr:"قيد التحضير",color:"bg-purple-100 text-purple-800",step:3},[Xi.SHIPPED]:{label:"Shipped",labelAr:"تم الشحن",color:"bg-indigo-100 text-indigo-800",step:4},[Xi.DELIVERED]:{label:"Delivered",labelAr:"تم التسليم",color:"bg-green-100 text-green-800",step:5},[Xi.CANCELLED]:{label:"Cancelled",labelAr:"ملغي",color:"bg-red-100 text-red-800",step:0},[Xi.REFUNDED]:{label:"Refunded",labelAr:"مسترد",color:"bg-gray-100 text-gray-800",step:0}},en="CREATE_ORDER",tn="UPDATE_ORDER_STATUS",rn="ADD_TRACKING_UPDATE",sn="LOAD_ORDERS",nn="SET_LOADING",an={orders:[],loading:!1,error:null};function on(e,t){switch(t.type){case nn:return{...e,loading:t.payload};case sn:return{...e,orders:t.payload,loading:!1};case en:{const r={id:t.payload.id||`ORD-${Date.now()}`,orderNumber:t.payload.orderNumber||`#${Date.now()}`,status:Xi.PENDING,items:t.payload.items||[],customer:t.payload.customer||{},shipping:t.payload.shipping||{},payment:t.payload.payment||{},totals:t.payload.totals||{},createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),tracking:[{status:Xi.PENDING,message:"Order created successfully",messageAr:"تم إنشاء الطلب بنجاح",timestamp:(new Date).toISOString(),automated:!0}],estimatedDelivery:null,shippingCarrier:null,trackingNumber:null};return{...e,orders:[r,...e.orders],loading:!1}}case tn:return{...e,orders:e.orders.map(e=>e.id===t.payload.orderId?{...e,status:t.payload.status,updatedAt:(new Date).toISOString(),...t.payload.trackingNumber&&{trackingNumber:t.payload.trackingNumber},...t.payload.shippingCarrier&&{shippingCarrier:t.payload.shippingCarrier},...t.payload.estimatedDelivery&&{estimatedDelivery:t.payload.estimatedDelivery}}:e)};case rn:return{...e,orders:e.orders.map(e=>e.id===t.payload.orderId?{...e,tracking:[...e.tracking,{status:t.payload.status,message:t.payload.message,messageAr:t.payload.messageAr,timestamp:(new Date).toISOString(),automated:t.payload.automated||!1,location:t.payload.location}],updatedAt:(new Date).toISOString()}:e)};default:return e}}const cn=R.createContext();function ln({children:t}){const[r,s]=R.useReducer(on,an),{sendNotification:i}=Ne();R.useEffect(()=>{const e=localStorage.getItem("ivolex_orders");if(e)try{const t=JSON.parse(e);s({type:sn,payload:t})}catch(t){}},[]),R.useEffect(()=>{r.orders.length>0&&localStorage.setItem("ivolex_orders",JSON.stringify(r.orders))},[r.orders]);const n=(e,t,r={})=>{const n=o(e);if(!n)return;s({type:tn,payload:{orderId:e,status:t,...r}});const c=Qi[t];a(e,{status:t,message:r.message||c.label,messageAr:r.messageAr||c.labelAr,automated:!1!==r.automated,location:r.location});const l={orderId:e,orderNumber:n.orderNumber,status:t,statusAr:c.labelAr,email:n.customer?.email,phone:n.customer?.phone,userId:n.customer?.id,trackingNumber:r.trackingNumber};let d=be.ORDER_STATUS_UPDATE,u=[we.IN_APP];t===Xi.CONFIRMED?(d=be.PAYMENT_CONFIRMATION,l.amount=n.totals?.total||"0",u=[we.IN_APP,we.EMAIL]):t===Xi.SHIPPED?(d=be.SHIPPING_UPDATE,u=[we.IN_APP,we.SMS,we.EMAIL]):t===Xi.DELIVERED&&(u=[we.IN_APP,we.EMAIL]),i(d,l,u)},a=(e,t)=>{s({type:rn,payload:{orderId:e,...t}})},o=e=>r.orders.find(t=>t.id===e),c={orders:r.orders,loading:r.loading,error:r.error,createOrder:e=>{s({type:nn,payload:!0}),setTimeout(()=>{const t=e.id||`ORD-${Date.now()}`,r=e.orderNumber||`#${Date.now()}`;s({type:en,payload:{...e,id:t,orderNumber:r}}),i(be.ORDER_CONFIRMATION,{orderId:t,orderNumber:r,total:e.totals?.total||"0",email:e.customer?.email,phone:e.customer?.phone,userId:e.customer?.id},[we.IN_APP,we.EMAIL,we.SMS]),setTimeout(()=>{n(t,Xi.CONFIRMED,{message:"Payment confirmed successfully",messageAr:"تم تأكيد الدفع بنجاح"})},2e3)},1e3)},updateOrderStatus:n,addTrackingUpdate:a,getOrderById:o,getOrderByNumber:e=>r.orders.find(t=>t.orderNumber===e),getStatusConfig:e=>Qi[e]||Qi[Xi.PENDING],simulateOrderProgress:e=>{if(!o(e))return;[{status:Xi.PROCESSING,delay:5e3,message:"Order is being prepared",messageAr:"جاري تحضير الطلب"},{status:Xi.SHIPPED,delay:1e4,message:"Order has been shipped",messageAr:"تم شحن الطلب",trackingNumber:"TN"+Math.random().toString(36).substr(2,9).toUpperCase(),shippingCarrier:"Aramex",estimatedDelivery:new Date(Date.now()+2592e5).toISOString()},{status:Xi.DELIVERED,delay:15e3,message:"Order delivered successfully",messageAr:"تم تسليم الطلب بنجاح"}].forEach(t=>{setTimeout(()=>{n(e,t.status,{message:t.message,messageAr:t.messageAr,trackingNumber:t.trackingNumber,shippingCarrier:t.shippingCarrier,estimatedDelivery:t.estimatedDelivery,automated:!0})},t.delay)})},ORDER_STATUSES:Xi};return e.jsx(cn.Provider,{value:c,children:t})}function dn(){const e=R.useContext(cn);if(!e)throw new Error("useOrder must be used within an OrderProvider");return e}const un=R.createContext(),hn={SUPER_ADMIN:"super_admin",ADMIN:"admin",MANAGER:"manager",MODERATOR:"moderator",VIEWER:"viewer",CUSTOMER:"customer"},mn={PRODUCTS_VIEW:"products:view",PRODUCTS_CREATE:"products:create",PRODUCTS_EDIT:"products:edit",PRODUCTS_DELETE:"products:delete",PRODUCTS_BULK_IMPORT:"products:bulk_import",ORDERS_VIEW:"orders:view",ORDERS_EDIT:"orders:edit",ORDERS_REFUND:"orders:refund",ORDERS_CANCEL:"orders:cancel",ORDERS_EXPORT:"orders:export",USERS_VIEW:"users:view",USERS_CREATE:"users:create",USERS_EDIT:"users:edit",USERS_DELETE:"users:delete",USERS_ASSIGN_ROLES:"users:assign_roles",CUSTOMIZATION_VIEW:"customization:view",CUSTOMIZATION_EDIT:"customization:edit",CUSTOMIZATION_APPROVE:"customization:approve",CUSTOMIZATION_REJECT:"customization:reject",THEMES_VIEW:"themes:view",THEMES_EDIT:"themes:edit",THEMES_CREATE:"themes:create",THEMES_DELETE:"themes:delete",ANALYTICS_VIEW:"analytics:view",ANALYTICS_EXPORT:"analytics:export",REPORTS_GENERATE:"reports:generate",SETTINGS_VIEW:"settings:view",SETTINGS_EDIT:"settings:edit",AUDIT_LOGS_VIEW:"audit_logs:view",SECURITY_MANAGE:"security:manage",ROLES_MANAGE:"roles:manage"},pn={[hn.SUPER_ADMIN]:[...Object.values(mn)],[hn.ADMIN]:[mn.PRODUCTS_VIEW,mn.PRODUCTS_CREATE,mn.PRODUCTS_EDIT,mn.PRODUCTS_DELETE,mn.PRODUCTS_BULK_IMPORT,mn.ORDERS_VIEW,mn.ORDERS_EDIT,mn.ORDERS_REFUND,mn.ORDERS_CANCEL,mn.ORDERS_EXPORT,mn.USERS_VIEW,mn.USERS_CREATE,mn.USERS_EDIT,mn.CUSTOMIZATION_VIEW,mn.CUSTOMIZATION_EDIT,mn.CUSTOMIZATION_APPROVE,mn.CUSTOMIZATION_REJECT,mn.THEMES_VIEW,mn.THEMES_EDIT,mn.THEMES_CREATE,mn.ANALYTICS_VIEW,mn.ANALYTICS_EXPORT,mn.REPORTS_GENERATE,mn.SETTINGS_VIEW,mn.AUDIT_LOGS_VIEW],[hn.MANAGER]:[mn.PRODUCTS_VIEW,mn.PRODUCTS_EDIT,mn.ORDERS_VIEW,mn.ORDERS_EDIT,mn.CUSTOMIZATION_VIEW,mn.CUSTOMIZATION_EDIT,mn.CUSTOMIZATION_APPROVE,mn.ANALYTICS_VIEW,mn.REPORTS_GENERATE],[hn.MODERATOR]:[mn.PRODUCTS_VIEW,mn.ORDERS_VIEW,mn.CUSTOMIZATION_VIEW,mn.CUSTOMIZATION_EDIT,mn.USERS_VIEW],[hn.VIEWER]:[mn.PRODUCTS_VIEW,mn.ORDERS_VIEW,mn.CUSTOMIZATION_VIEW,mn.ANALYTICS_VIEW],[hn.CUSTOMER]:[]},fn={LOGIN:"login",LOGOUT:"logout",CREATE:"create",UPDATE:"update",DELETE:"delete",VIEW:"view",EXPORT:"export",APPROVE:"approve",REJECT:"reject",REFUND:"refund",CANCEL:"cancel",ROLE_CHANGE:"role_change",PERMISSION_CHANGE:"permission_change",SETTINGS_CHANGE:"settings_change",THEME_CHANGE:"theme_change",SECURITY_EVENT:"security_event"},gn="ADD_LOG",yn="LOAD_LOGS",vn="CLEAR_LOGS",bn="SET_LOADING",wn="SET_ERROR",xn={logs:[],loading:!1,error:null,currentUser:{id:"admin_1",name:"Admin User",email:"admin@ivolex.com",role:hn.ADMIN,permissions:pn[hn.ADMIN]}},_n=(e,t)=>{switch(t.type){case gn:return{...e,logs:[t.payload,...e.logs],loading:!1};case yn:return{...e,logs:t.payload,loading:!1};case vn:return{...e,logs:[]};case bn:return{...e,loading:t.payload};case wn:return{...e,error:t.payload,loading:!1};default:return e}},Sn=({children:t})=>{const[r,s]=R.useReducer(_n,xn),{sendNotification:i}=Ne();R.useEffect(()=>{const e=localStorage.getItem("ivolex_audit_logs");if(e)try{const t=JSON.parse(e);s({type:yn,payload:t})}catch(t){}},[]),R.useEffect(()=>{if(r.logs.length>0){const e=r.logs.slice(0,1e3);localStorage.setItem("ivolex_audit_logs",JSON.stringify(e))}},[r.logs]);const n=(e,t=r.currentUser.role)=>(pn[t]||[]).includes(e),a=e=>[fn.DELETE,fn.ROLE_CHANGE,fn.PERMISSION_CHANGE,fn.SECURITY_EVENT,fn.SETTINGS_CHANGE].includes(e),o=(e={})=>{let t=[...r.logs];return e.userId&&(t=t.filter(t=>t.userId===e.userId)),e.action&&(t=t.filter(t=>t.action===e.action)),e.resource&&(t=t.filter(t=>t.resource.includes(e.resource))),e.startDate&&(t=t.filter(t=>new Date(t.timestamp)>=new Date(e.startDate))),e.endDate&&(t=t.filter(t=>new Date(t.timestamp)<=new Date(e.endDate))),void 0!==e.success&&(t=t.filter(t=>t.success===e.success)),t},c=e=>[["Timestamp","User","Action","Resource","IP Address","Success","Details"].join(","),...e.map(e=>[e.timestamp,`"${e.userName}"`,e.action,`"${e.resource}"`,e.ipAddress,e.success,`"${JSON.stringify(e.details).replace(/"/g,'""')}"`].join(","))].join("\n"),l={logs:r.logs,loading:r.loading,error:r.error,currentUser:r.currentUser,hasPermission:n,hasAnyPermission:(e,t=r.currentUser.role)=>e.some(e=>n(e,t)),hasAllPermissions:(e,t=r.currentUser.role)=>e.every(e=>n(e,t)),hasRole:(e,t=r.currentUser.role)=>t===e,hasMinimumRole:(e,t=r.currentUser.role)=>{const s=[hn.CUSTOMER,hn.VIEWER,hn.MODERATOR,hn.MANAGER,hn.ADMIN,hn.SUPER_ADMIN];return s.indexOf(t)>=s.indexOf(e)},logAction:async(e,t,n={})=>{try{const o={id:`audit_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:(new Date).toISOString(),userId:r.currentUser.id,userName:r.currentUser.name,userEmail:r.currentUser.email,userRole:r.currentUser.role,action:e,resource:t,details:n,ipAddress:"192.168.1.1",userAgent:navigator.userAgent,sessionId:sessionStorage.getItem("session_id")||"unknown",success:!1!==n.success};return s({type:gn,payload:o}),a(e)&&await i(be.ADMIN_ALERT,{message:`Critical action performed: ${e} on ${t} by ${r.currentUser.name}`,messageAr:`تم تنفيذ إجراء مهم: ${e} على ${t} بواسطة ${r.currentUser.name}`,userId:r.currentUser.id,action:e,resource:t,severity:"high"},[we.IN_APP,we.EMAIL]),o}catch(o){s({type:wn,payload:o.message})}},getFilteredLogs:o,exportLogs:(e="json",t={})=>{const r=o(t);return"csv"===e?c(r):JSON.stringify(r,null,2)},clearOldLogs:(e=90)=>{const t=new Date(Date.now()-24*e*60*60*1e3),i=r.logs.filter(e=>new Date(e.timestamp)>=t);s({type:yn,payload:i})},ROLES:hn,PERMISSIONS:mn,ROLE_PERMISSIONS:pn,AUDIT_ACTIONS:fn};return e.jsx(un.Provider,{value:l,children:t})},En=()=>{const e=R.useContext(un);if(!e)throw new Error("useAudit must be used within an AuditProvider");return e},Tn=R.createContext(),kn=()=>{const e=R.useContext(Tn);if(!e)throw new Error("useShipping must be used within a ShippingProvider");return e},An=({children:t})=>{const[r,s]=R.useState([]),[i,n]=R.useState(null),[a,o]=R.useState(null),[c,l]=R.useState({}),[d,u]=R.useState(!1),h=R.useMemo(()=>[{id:"standard",name:"Standard Shipping",description:"Delivery within 5-7 business days",provider:"Saudi Post",type:"standard",estimatedDays:"5-7",trackingAvailable:!0,baseRate:25,freeThreshold:300,maxWeight:30,supportedRegions:["riyadh","jeddah","dammam","all_saudi"]},{id:"express",name:"Express Shipping",description:"Delivery within 2-3 business days",provider:"SMSA Express",type:"express",estimatedDays:"2-3",trackingAvailable:!0,baseRate:45,freeThreshold:500,maxWeight:25,supportedRegions:["riyadh","jeddah","dammam","major_cities"]},{id:"same_day",name:"Same Day Delivery",description:"Delivery within 4-6 hours (major cities only)",provider:"IVOLEX Express",type:"same_day",estimatedDays:"Same day",trackingAvailable:!0,baseRate:75,freeThreshold:1e3,maxWeight:10,supportedRegions:["riyadh","jeddah"]},{id:"pickup",name:"Store Pickup",description:"Pick up from our store locations",provider:"IVOLEX Stores",type:"pickup",estimatedDays:"1-2",trackingAvailable:!1,baseRate:0,freeThreshold:0,maxWeight:null,supportedRegions:["riyadh","jeddah","dammam"]}],[]),m=R.useMemo(()=>[{id:"riyadh_main",name:"IVOLEX Riyadh Main Store",address:"King Fahd Road, Olaya District, Riyadh 12213",city:"Riyadh",phone:"+966 11 234 5678",hours:"Sun-Thu: 9AM-10PM, Fri-Sat: 2PM-11PM",coordinates:{lat:24.7136,lng:46.6753}},{id:"jeddah_main",name:"IVOLEX Jeddah Main Store",address:"Prince Sultan Road, Al Salamah District, Jeddah 23433",city:"Jeddah",phone:"+966 12 345 6789",hours:"Sun-Thu: 9AM-10PM, Fri-Sat: 2PM-11PM",coordinates:{lat:21.5433,lng:39.1728}},{id:"dammam_main",name:"IVOLEX Dammam Main Store",address:"King Saud Road, Al Faisaliyah District, Dammam 32245",city:"Dammam",phone:"+966 13 456 7890",hours:"Sun-Thu: 9AM-10PM, Fri-Sat: 2PM-11PM",coordinates:{lat:26.4207,lng:50.0888}}],[]);R.useEffect(()=>{s(h)},[h]);const p=(e,t,r)=>{const s=h.find(e=>e.id===r);if(!s)return null;const i=e.reduce((e,t)=>e+(t.weight||1)*t.quantity,0);if(e.reduce((e,t)=>e+t.price*t.quantity,0)>=s.freeThreshold)return{rate:0,originalRate:s.baseRate,isFree:!0,currency:"SAR"};if(s.maxWeight&&i>s.maxWeight)return{error:`Exceeds weight limit of ${s.maxWeight}kg`};let n=s.baseRate;if(i>5&&(n+=10*Math.ceil((i-5)/2)),t?.city){const e=t.city.toLowerCase();if(!s.supportedRegions.includes(e)&&!s.supportedRegions.includes("all_saudi")){if(s.supportedRegions.includes("major_cities"))return{error:"Not available in this location"};n+=20}}return{rate:n,originalRate:s.baseRate,isFree:!1,currency:"SAR",weightSurcharge:n-s.baseRate}},f=e=>{const t=e.includes("-")?parseInt(e.split("-")[1]):parseInt(e)||5,r=new Date;return r.setDate(r.getDate()+t),r.toISOString()},g=e=>({pending:"Order received and being prepared",picked_up:"Package picked up from warehouse",in_transit:"Package in transit to destination",out_for_delivery:"Out for delivery",delivered:"Package delivered successfully"}[e]||"Status update"),y=e=>({pending:"IVOLEX Warehouse",picked_up:"Distribution Center",in_transit:"In Transit",out_for_delivery:"Local Facility",delivered:"Delivered"}[e]||"Unknown"),v={shippingMethods:r,selectedMethod:i,shippingAddress:a,trackingData:c,storeLocations:m,loading:d,calculateShippingRate:p,getAvailableShippingMethods:(e,t)=>e&&0!==e.length?h.filter(e=>{if(!t?.city)return!0;const r=t.city.toLowerCase();return e.supportedRegions.includes(r)||e.supportedRegions.includes("all_saudi")||e.supportedRegions.includes("major_cities")&&["riyadh","jeddah","dammam","mecca","medina"].includes(r)}).map(r=>{const s=p(e,t,r.id);return{...r,rateInfo:s,available:!s?.error}}):[],setSelectedMethod:n,setShippingAddress:o,createShipment:async e=>{u(!0);try{await new Promise(e=>setTimeout(e,2e3));const t=`TRK${Date.now()}${Math.random().toString(36).substr(2,6).toUpperCase()}`,r={id:`SHIP_${Date.now()}`,orderId:e.orderId,trackingNumber:t,provider:i?.provider||"Saudi Post",method:i?.name||"Standard Shipping",status:"pending",estimatedDelivery:f(i?.estimatedDays),shippingAddress:e.shippingAddress,timeline:[{status:"pending",description:"Shipment created",timestamp:(new Date).toISOString(),location:"IVOLEX Warehouse"}]};return l(e=>({...e,[t]:r})),r}catch(t){throw t}finally{u(!1)}},trackShipment:async e=>{u(!0);try{await new Promise(e=>setTimeout(e,1500));const t=["pending","picked_up","in_transit","out_for_delivery","delivered"],r=Math.floor(Math.random()*t.length),s=t[r],i={trackingNumber:e,status:s,lastUpdated:(new Date).toISOString(),estimatedDelivery:f("2-3"),timeline:t.slice(0,r+1).map((e,r)=>({status:e,description:g(e),timestamp:new Date(Date.now()-24*(t.length-r-1)*60*60*1e3).toISOString(),location:y(e)}))};return l(t=>({...t,[e]:i})),i}catch(t){throw t}finally{u(!1)}}};return e.jsx(Tn.Provider,{value:v,children:t})},jn=R.createContext(null);function On({children:t}){const[r,s]=R.useState("light"),[i,n]=R.useState("light");R.useEffect(()=>{const e=window.matchMedia("(prefers-color-scheme: dark)");n(e.matches?"dark":"light");const t=e=>n(e.matches?"dark":"light");return e.addEventListener("change",t),()=>e.removeEventListener("change",t)},[]),R.useEffect(()=>{const e=localStorage.getItem("theme");e&&["light","dark","system"].includes(e)&&s(e)},[]),R.useEffect(()=>{"dark"===("system"===r?i:r)?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[r,i]);const a={theme:r,effectiveTheme:"system"===r?i:r,setTheme:e=>{s(e),localStorage.setItem("theme",e)},systemTheme:i};return e.jsx(jn.Provider,{value:a,children:t})}const Pn={"default-src":["'self'"],"script-src":["'self'","'unsafe-inline'","'unsafe-eval'","https://cdn.jsdelivr.net","https://unpkg.com"],"style-src":["'self'","'unsafe-inline'","https://fonts.googleapis.com"],"img-src":["'self'","data:","blob:","https:","http://localhost:*"],"font-src":["'self'","https://fonts.gstatic.com","data:"],"connect-src":["'self'","https://api.","wss:","http://localhost:*","https://localhost:*"],"media-src":["'self'","blob:","data:"],"object-src":["'none'"],"base-uri":["'self'"],"form-action":["'self'"],"frame-ancestors":["'none'"],"upgrade-insecure-requests":[]};function Cn({children:e}){const{setupCSPListener:t}=function(){const[e,t]=R.useState([]),r=R.useCallback(e=>{const r={id:Date.now(),timestamp:(new Date).toISOString(),directive:e.violatedDirective,blockedUri:e.blockedURI,documentUri:e.documentURI,lineNumber:e.lineNumber,sourceFile:e.sourceFile};t(e=>[...e.slice(-49),r])},[]),s=R.useCallback(()=>{const e=e=>{r(e.originalEvent||e)};return document.addEventListener("securitypolicyviolation",e),()=>{document.removeEventListener("securitypolicyviolation",e)}},[r]);return{violations:e,reportViolation:r,setupCSPListener:s}}(),{logSecurityEvent:r}=function(){const[e,t]=R.useState([]),[r,s]=R.useState("low"),i=R.useCallback(r=>{const i={id:Date.now(),timestamp:(new Date).toISOString(),type:r.type,severity:r.severity||"low",details:r.details,userAgent:navigator.userAgent,url:window.location.href};t(e=>[...e.slice(-99),i]);const n=e.filter(e=>Date.now()-new Date(e.timestamp).getTime()<3e5),a=n.filter(e=>"high"===e.severity).length,o=n.filter(e=>"medium"===e.severity).length;s(a>=3||o>=5?"high":a>=1||o>=2?"medium":"low")},[e]),n=R.useCallback(()=>{t([]),s("low")},[]);return{securityEvents:e,threatLevel:r,logSecurityEvent:i,clearEvents:n}}();return R.useEffect(()=>{const e=t();(()=>{const e=document.head;{const t=document.createElement("meta");t.httpEquiv="Content-Security-Policy",t.content=Object.entries(Pn).map(([e,t])=>`${e} ${t.join(" ")}`).join("; "),e.appendChild(t)}const t=document.createElement("meta");t.name="referrer",t.content="strict-origin-when-cross-origin",e.appendChild(t);const r=document.querySelector('meta[name="viewport"]');r&&!r.content.includes("user-scalable=no")&&(r.content=r.content.replace(/user-scalable=no/g,"user-scalable=yes"))})();return(()=>{let e=0;document.addEventListener("submit",()=>{e++,e>5&&r({type:"rapid_submissions",severity:"medium",details:`${e} form submissions in rapid succession`})}),setInterval(()=>{e=0},6e4),document.addEventListener("paste",e=>{const t=e.clipboardData.getData("text");(t.length>1e3||/<script|javascript:/i.test(t))&&r({type:"suspicious_paste",severity:"medium",details:"Large or potentially malicious content pasted"})});let t={open:!1};setInterval(()=>{window.outerHeight-window.innerHeight>160||window.outerWidth-window.innerWidth>160?t.open||(t.open=!0,r({type:"devtools_detected",severity:"low",details:"Developer tools may be open"})):t.open=!1},500)})(),e},[t,r]),e}function Rn({children:e}){return R.useEffect(()=>{const e=new Map,t=window.fetch;return window.fetch=function(r,s={}){return((t,r=10,s=6e4)=>{const i=Date.now(),n=e.get(t)||{count:0,resetTime:i+s};return i>n.resetTime?(n.count=1,n.resetTime=i+s):n.count++,e.set(t,n),n.count<=r})(`fetch_${r}`,50,6e4)?t.call(this,r,s):Promise.reject(new Error("Rate limit exceeded"))},()=>{window.fetch=t}},[]),e}function Nn({children:e,onViolation:t}){return R.useEffect(()=>{const e=e=>{const r=e.target;if(r&&r.value){[/<script/i,/javascript:/i,/vbscript:/i,/on\w+\s*=/i].some(e=>e.test(r.value))&&(e.preventDefault(),r.value=r.value.replace(/[<>"']/g,""),t&&t({type:"xss_attempt",element:r.tagName,value:r.value}))}};return document.addEventListener("input",e),document.addEventListener("change",e),()=>{document.removeEventListener("input",e),document.removeEventListener("change",e)}},[t]),e}const In=R.createContext(),Dn=[{id:1,name:"Premium Leather Wallet",category:"leather",subcategory:"wallets",price:2499,rating:4.8,segment:"leather",tags:["premium","handcrafted","genuine"],image:"/images/leather-wallet.jpg"},{id:2,name:"Executive Leather Briefcase",category:"leather",subcategory:"bags",price:8999,rating:4.9,segment:"leather",tags:["professional","durable","spacious"],image:"/images/leather-briefcase.jpg"},{id:3,name:"Classic Leather Belt",category:"leather",subcategory:"belts",price:1599,rating:4.7,segment:"leather",tags:["classic","adjustable","formal"],image:"/images/leather-belt.jpg"},{id:4,name:"Leather Card Holder",category:"leather",subcategory:"accessories",price:899,rating:4.6,segment:"leather",tags:["compact","stylish","functional"],image:"/images/card-holder.jpg"},{id:5,name:"Wireless Bluetooth Earbuds",category:"electronics",subcategory:"audio",price:3999,rating:4.5,segment:"electronics",tags:["wireless","noise-cancelling","portable"],image:"/images/earbuds.jpg"},{id:6,name:"Smart Fitness Watch",category:"electronics",subcategory:"wearables",price:12999,rating:4.4,segment:"electronics",tags:["fitness","smart","waterproof"],image:"/images/fitness-watch.jpg"},{id:7,name:"Portable Power Bank",category:"electronics",subcategory:"accessories",price:1999,rating:4.3,segment:"electronics",tags:["portable","fast-charging","compact"],image:"/images/power-bank.jpg"},{id:8,name:"Wireless Charging Pad",category:"electronics",subcategory:"accessories",price:2499,rating:4.2,segment:"electronics",tags:["wireless","efficient","sleek"],image:"/images/charging-pad.jpg"},{id:9,name:"Ergonomic Office Chair",category:"furniture",subcategory:"office",price:15999,rating:4.7,segment:"furniture",tags:["ergonomic","comfortable","adjustable"],image:"/images/office-chair.jpg"},{id:10,name:"Modern Coffee Table",category:"furniture",subcategory:"seating",price:8499,rating:4.6,segment:"furniture",tags:["modern","stylish","durable"],image:"/images/coffee-table.jpg"},{id:11,name:"Storage Ottoman",category:"furniture",subcategory:"storage",price:4999,rating:4.5,segment:"furniture",tags:["storage","multifunctional","comfortable"],image:"/images/storage-ottoman.jpg"},{id:12,name:"Floating Desk Organizer",category:"furniture",subcategory:"office",price:2999,rating:4.4,segment:"furniture",tags:["organized","space-saving","modern"],image:"/images/desk-organizer.jpg"}],Ln={view:1,quickView:1.5,addToCart:3,removeFromCart:-1,purchase:5,wishlist:2,removeFromWishlist:-.5,search:1,categoryView:.5,filterApply:.8,sortApply:.3,imageZoom:.5,reviewRead:.7,reviewWrite:2,shareProduct:1.5,compareProduct:1.2,emailInquiry:2.5,chatInquiry:2,timeOnProduct:.1,scrollDepth:.05,clickRecommendation:1.8},$n="ivolex_session_data",Un="ivolex_user_behavior",Mn="ivolex_analytics_data";function Fn({children:t}){const[r,s]=R.useState([]),[i,n]=R.useState({sessionId:Date.now().toString(),startTime:new Date,deviceInfo:{userAgent:navigator.userAgent,language:navigator.language,platform:navigator.platform,screenResolution:`${screen.width}x${screen.height}`,viewport:`${window.innerWidth}x${window.innerHeight}`,isMobile:/Mobile|Android|iPhone|iPad/.test(navigator.userAgent)},location:null,totalTimeSpent:0,pagesVisited:[],currentPage:window.location.pathname}),[a,o]=R.useState({trending:[],personalized:[],related:{},frequentlyBoughtTogether:{},categoryBased:{},searchBased:{},crossSell:{},upsell:{}}),[c,l]=R.useState({conversionRate:0,engagementScore:0,preferredCategories:[],priceRange:{min:0,max:0},timeOfDayPattern:{},dayOfWeekPattern:{},seasonalPattern:{},abandonmentReasons:[],loyaltyScore:0}),[d,u]=R.useState(!1),h=R.useCallback(e=>{l(t=>{const r={...t};e.weight>0&&(r.engagementScore=Math.min(100,r.engagementScore+e.weight));const s=e.metadata.hourOfDay;r.timeOfDayPattern[s]=(r.timeOfDayPattern[s]||0)+1;const i=e.metadata.dayOfWeek;if(r.dayOfWeekPattern[i]=(r.dayOfWeekPattern[i]||0)+1,e.productData?.category){const t=r.preferredCategories.findIndex(t=>t.name===e.productData.category);t>=0?r.preferredCategories[t].score+=e.weight:r.preferredCategories.push({name:e.productData.category,score:e.weight}),r.preferredCategories.sort((e,t)=>t.score-e.score)}return r})},[]),m=R.useCallback((e,t=null,r={})=>{const n=new Date,a={id:`${Date.now()}_${Math.random().toString(36).substr(2,9)}`,sessionId:i.sessionId,action:e,productId:t,timestamp:n,metadata:{...r,page:window.location.pathname,referrer:document.referrer,timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone,localTime:n.toLocaleString("en-IN"),dayOfWeek:n.getDay(),hourOfDay:n.getHours(),device:i.deviceInfo.isMobile?"mobile":"desktop",...i.deviceInfo},weight:Ln[e]||1};if(t){const e=Dn.find(e=>e.id===t);e&&(a.productData={category:e.category,subcategory:e.subcategory,price:e.price,rating:e.rating,segment:e.segment,tags:e.tags})}s(e=>[...e,a].slice(-2e3));try{const e=JSON.parse(localStorage.getItem(Un)||"[]");e.push(a),localStorage.setItem(Un,JSON.stringify(e.slice(-2e3)))}catch(o){}h(a)},[i,h]),p=R.useCallback((e,t)=>{m("timeOnProduct",e,{timeSpent:Math.round(t),engagement:t>30?"high":t>10?"medium":"low"})},[m]),f=R.useCallback((e,t)=>{t>0&&t%25==0&&m("scrollDepth",e,{scrollPercentage:t,engagement:t>75?"high":t>50?"medium":"low"})},[m]),g=R.useCallback((e,t,r)=>{m("cartAbandonment",null,{reason:e,cartValue:t,itemCount:r,abandonmentStage:"cart",potentialLoss:t})},[m]),y=R.useCallback((e,t,r={})=>{m("search",null,{query:e,resultCount:t.length,hasResults:t.length>0,filters:r,searchType:Object.keys(r).length>0?"filtered":"simple"})},[m]);R.useEffect(()=>{try{const e=JSON.parse(localStorage.getItem(Un)||"[]");s(e);const t=JSON.parse(localStorage.getItem($n)||"null");if(t&&Date.now()-new Date(t.startTime).getTime()<864e5)n(e=>({...e,...t}));else{const e={...i,sessionId:Date.now().toString(),startTime:new Date};n(e),localStorage.setItem($n,JSON.stringify(e))}const r=JSON.parse(localStorage.getItem(Mn)||"null");r&&l(e=>({...e,...r}))}catch(t){}m("pageView",null,{page:window.location.pathname});const e=()=>{try{localStorage.setItem($n,JSON.stringify(i)),localStorage.setItem(Mn,JSON.stringify(c))}catch(t){}};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[c,i,m]);const v=R.useCallback(()=>Dn.sort((e,t)=>t.rating*Math.random()-e.rating*Math.random()).slice(0,8),[]),b=R.useCallback(()=>{if(0===r.length)return v();const e={},t={},s={},i={},n=Date.now();r.forEach(r=>{const a=Dn.find(e=>e.id===r.productId);if(!a)return;const o=n-new Date(r.timestamp).getTime(),c=Math.exp(-o/6048e5),l=r.weight*c;e[a.category]=(e[a.category]||0)+l,t[a.segment]=(t[a.segment]||0)+l,a.tags.forEach(e=>{s[e]=(s[e]||0)+l});const d=a.price<2e3?"low":a.price<8e3?"medium":"high";i[d]=(i[d]||0)+l,new Date(r.timestamp).getHours()});return Dn.map(n=>{let a=0;a+=.3*(e[n.category]||0),a+=.25*(t[n.segment]||0),n.tags.forEach(e=>{a+=.1*(s[e]||0)});const o=n.price<2e3?"low":n.price<8e3?"medium":"high";a+=.15*(i[o]||0),a+=2*n.rating;return r.some(e=>e.productId===n.id)&&(a*=.3),a+=5*Math.random(),{...n,score:a}}).sort((e,t)=>t.score-e.score).slice(0,12)},[r,v]),w=R.useCallback(e=>{const t=Dn.find(t=>t.id===e);if(!t)return[];return Dn.filter(t=>t.id!==e).map(e=>{let r=0;e.category===t.category&&(r+=3),e.segment===t.segment&&(r+=2);r+=e.tags.filter(e=>t.tags.includes(e)).length;return Math.abs(e.price-t.price)/t.price<.5&&(r+=1),{...e,similarity:r}}).sort((e,t)=>t.similarity-e.similarity).slice(0,6)},[]),x=R.useCallback(e=>{const t=Dn.find(t=>t.id===e);if(!t)return[];return Dn.filter(r=>{if(r.id===e)return!1;if(r.segment===t.segment&&r.subcategory!==t.subcategory)return!0;return{leather:["electronics"],electronics:["leather"],furniture:["electronics","leather"]}[t.category]?.includes(r.category)}).sort(()=>Math.random()-.5).slice(0,4)},[]),_=R.useCallback((e,t=null)=>Dn.filter(r=>r.category===e&&r.id!==t).sort((e,t)=>t.rating-e.rating).slice(0,6),[]),S=R.useCallback(e=>{if(!e||0===e.length)return[];const t=[...new Set(e.map(e=>{const t=Dn.find(t=>t.id===e.productId);return t?.category}).filter(Boolean))],r={leather:["electronics","furniture"],electronics:["leather","furniture"],furniture:["electronics","leather"]};return Dn.filter(s=>!e.some(e=>e.productId===s.id)&&t.some(e=>r[e]?.includes(s.category))).sort((e,t)=>t.rating-e.rating).slice(0,6)},[]),E=R.useCallback(e=>{const t=Dn.find(t=>t.id===e);if(!t)return[];return Dn.filter(r=>{if(r.id===e)return!1;const s=(r.price-t.price)/t.price;return r.category===t.category&&s>=.2&&s<=2}).sort((e,r)=>{const s=e.rating/(e.price/t.price-1);return r.rating/(r.price/t.price-1)-s}).slice(0,4)},[]),T=R.useCallback((e,t={})=>{const s=e.toLowerCase(),i=s.split(" ").filter(e=>e.length>2);return Dn.map(e=>{let n=0;if(e.name.toLowerCase().includes(s)&&(n+=50),i.forEach(t=>{e.name.toLowerCase().includes(t)&&(n+=20),e.category.toLowerCase().includes(t)&&(n+=15),e.subcategory.toLowerCase().includes(t)&&(n+=15),e.tags.some(e=>e.toLowerCase().includes(t))&&(n+=10)}),e.category.toLowerCase()===s&&(n+=40),e.subcategory.toLowerCase()===s&&(n+=35),e.tags.some(e=>e.toLowerCase()===s)&&(n+=30),r.length>0){const t=c.preferredCategories.find(t=>t.name===e.category)?.score||0;n+=.1*t}if(n+=2*e.rating,t.priceRange){const{min:r,max:s}=t.priceRange;e.price>=r&&e.price<=s&&(n+=10)}return{...e,relevanceScore:n}}).filter(e=>e.relevanceScore>0).sort((e,t)=>t.relevanceScore-e.relevanceScore).slice(0,20)},[r,c]),k=R.useCallback(()=>{const e=r.length,t=new Set(r.filter(e=>e.productId).map(e=>e.productId)).size,s=r.filter(e=>"purchase"===e.action).length,n=r.filter(e=>"addToCart"===e.action).length;return{...c,totalInteractions:e,uniqueProducts:t,conversionRate:n>0?s/n*100:0,averageSessionLength:i.totalTimeSpent/60,loyaltyScore:Math.min(100,2*e+10*s),engagementLevel:c.engagementScore>50?"high":c.engagementScore>20?"medium":"low",preferredPriceRange:{min:Math.min(...r.filter(e=>e.productData?.price).map(e=>e.productData.price))||0,max:Math.max(...r.filter(e=>e.productData?.price).map(e=>e.productData.price))||0},topCategories:c.preferredCategories.slice(0,3),recentActivity:r.slice(-10)}},[r,c,i]),A=R.useCallback(async()=>{u(!0);try{await new Promise(e=>setTimeout(e,500)),o({trending:v(),personalized:b(),related:{},frequentlyBoughtTogether:{},categoryBased:{},searchBased:{},crossSell:{},upsell:{}})}catch(e){}finally{u(!1)}},[v,b]);R.useEffect(()=>{A()},[A]);const j=R.useCallback(e=>{const t=e.toLowerCase();return Dn.filter(e=>e.name.toLowerCase().includes(t)||e.category.toLowerCase().includes(t)||e.subcategory.toLowerCase().includes(t)||e.tags.some(e=>e.toLowerCase().includes(t))).sort((e,r)=>{const s=e.name.toLowerCase().includes(t),i=r.name.toLowerCase().includes(t);return s&&!i?-1:!s&&i?1:r.rating-e.rating}).slice(0,10)},[]),O={userBehavior:r,sessionData:i,analytics:c,recommendations:a,isLoading:d,trackBehavior:m,trackTimeOnProduct:p,trackScrollDepth:f,trackCartAbandonment:g,trackSearch:y,updateRecommendations:A,getRelated:e=>(a.related[e]||(a.related[e]=w(e)),a.related[e]),getFrequentlyBoughtTogether:e=>(a.frequentlyBoughtTogether[e]||(a.frequentlyBoughtTogether[e]=x(e)),a.frequentlyBoughtTogether[e]),getCategoryBased:(e,t=null)=>{const r=`${e}_${t||"all"}`;return a.categoryBased[r]||(a.categoryBased[r]=_(e,t)),a.categoryBased[r]},getCrossSell:e=>{const t=e.map(e=>e.productId).sort().join("_");return a.crossSell[t]||(a.crossSell[t]=S(e)),a.crossSell[t]},getUpsell:e=>(a.upsell[e]||(a.upsell[e]=E(e)),a.upsell[e]),getSearchRecommendations:j,getAdvancedSearchRecommendations:T,getTrending:()=>a.trending,getPersonalized:()=>a.personalized,getUserAnalytics:k,getEngagementScore:()=>c.engagementScore,getPreferredCategories:()=>c.preferredCategories,getLoyaltyScore:()=>c.loyaltyScore,getProducts:()=>Dn,getProduct:e=>Dn.find(t=>t.id===e),getSessionInsights:()=>({sessionDuration:i.totalTimeSpent,pagesVisited:i.pagesVisited.length,deviceType:i.deviceInfo.isMobile?"mobile":"desktop",engagementLevel:c.engagementScore>50?"high":c.engagementScore>20?"medium":"low"}),getVariantRecommendations:(e="default")=>{switch(e){case"popularity":return a.trending;case"personalized":return a.personalized;case"hybrid":return[...a.personalized.slice(0,6),...a.trending.slice(0,6)];default:return a.personalized.length>0?a.personalized:a.trending}}};return e.jsx(In.Provider,{value:O,children:t})}function Bn(){return e.jsxs(e.Fragment,{children:[e.jsx("a",{href:"#main",className:"sr-only focus:not-sr-only focus:fixed focus:top-2 focus:left-2 bg-brand-500 text-white px-3 py-2 rounded z-50","aria-label":"Skip to main content",children:"Skip to main content"}),e.jsx("a",{href:"#navigation",className:"sr-only focus:not-sr-only focus:fixed focus:top-2 focus:left-20 bg-brand-500 text-white px-3 py-2 rounded z-50","aria-label":"Skip to navigation",children:"Skip to navigation"})]})}class Hn extends R.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null,errorId:null}}static getDerivedStateFromError(e){return{hasError:!0,errorId:Date.now().toString(36)+Math.random().toString(36).substr(2)}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t}),"undefined"!=typeof window&&window.gtag&&window.gtag("event","exception",{description:e.toString(),fatal:!1});try{window.logSecurityEvent&&window.logSecurityEvent({type:"ui_error",severity:"high",details:`Error: ${e.message}`,metadata:{errorId:this.state.errorId}})}catch(r){}}handleReload=()=>{window.location.reload()};handleGoHome=()=>{window.location.href="/"};handleRetry=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){if(this.state.hasError){const{showDetails:t=!1,title:r,message:s}=this.props;return e.jsx("div",{className:"min-h-[400px] flex items-center justify-center p-8",children:e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-lg mx-auto text-center",children:[e.jsx(i.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(g,{size:32,className:"text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:r||"Something went wrong"}),e.jsx("p",{className:"text-foreground/70 mb-6",children:s||"An unexpected error occurred. Please try refreshing the page or contact support if the problem persists."}),e.jsx("div",{className:"bg-background border border-border rounded-lg p-3 mb-6",children:e.jsxs("p",{className:"text-sm text-foreground/60",children:["Error ID:"," ",e.jsx("code",{className:"font-mono text-xs bg-background px-2 py-1 rounded",children:this.state.errorId})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center mb-6",children:[e.jsxs("button",{onClick:this.handleRetry,className:"flex items-center gap-2 px-4 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 transition-colors",children:[e.jsx(O,{size:16}),"Try Again"]}),e.jsxs("button",{onClick:this.handleReload,className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsx(O,{size:16}),"Reload Page"]}),e.jsxs("button",{onClick:this.handleGoHome,className:"flex items-center gap-2 px-4 py-2 border border-border text-foreground rounded-lg hover:bg-background transition-colors",children:[e.jsx(P,{size:16}),"Go Home"]})]}),!!t&&this.state.error&&e.jsxs(i.details,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"text-left bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("summary",{className:"cursor-pointer text-red-800 font-medium mb-2 flex items-center gap-2",children:[e.jsx(C,{size:16}),"Technical Details"]}),e.jsxs("div",{className:"text-sm text-red-700 space-y-2",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Error:"}),e.jsx("pre",{className:"mt-1 text-xs bg-red-100 p-2 rounded overflow-auto",children:this.state.error.toString()})]}),this.state.errorInfo&&e.jsxs("div",{children:[e.jsx("strong",{children:"Component Stack:"}),e.jsx("pre",{className:"mt-1 text-xs bg-red-100 p-2 rounded overflow-auto",children:this.state.errorInfo.componentStack})]})]})]})]})})}return this.props.children}}const zn={duration:4e3,position:"top-right",style:{background:"#fff",color:"#374151",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",border:"1px solid #e5e7eb",borderRadius:"0.75rem"}},Gn=e=>{B.success(e,{duration:zn.duration,style:zn.style,iconTheme:{primary:"#059669",secondary:"#ffffff"}})},Wn=e=>{B.error(e,{duration:zn.duration,style:zn.style,iconTheme:{primary:"#dc2626",secondary:"#ffffff"}})},Vn=e=>B.loading(e,{duration:zn.duration,style:zn.style}),qn=e=>{B.dismiss(e)};function Kn(){return e.jsx(H,{position:zn.position,toastOptions:{duration:zn.duration,style:zn.style},reverseOrder:!1})}var Jn,Yn;const Zn=F(function(){if(Yn)return Jn;Yn=1;var e="undefined"!=typeof Element,t="function"==typeof Map,r="function"==typeof Set,s="function"==typeof ArrayBuffer&&!!ArrayBuffer.isView;function i(n,a){if(n===a)return!0;if(n&&a&&"object"==typeof n&&"object"==typeof a){if(n.constructor!==a.constructor)return!1;var o,c,l,d;if(Array.isArray(n)){if((o=n.length)!=a.length)return!1;for(c=o;0!==c--;)if(!i(n[c],a[c]))return!1;return!0}if(t&&n instanceof Map&&a instanceof Map){if(n.size!==a.size)return!1;for(d=n.entries();!(c=d.next()).done;)if(!a.has(c.value[0]))return!1;for(d=n.entries();!(c=d.next()).done;)if(!i(c.value[1],a.get(c.value[0])))return!1;return!0}if(r&&n instanceof Set&&a instanceof Set){if(n.size!==a.size)return!1;for(d=n.entries();!(c=d.next()).done;)if(!a.has(c.value[0]))return!1;return!0}if(s&&ArrayBuffer.isView(n)&&ArrayBuffer.isView(a)){if((o=n.length)!=a.length)return!1;for(c=o;0!==c--;)if(n[c]!==a[c])return!1;return!0}if(n.constructor===RegExp)return n.source===a.source&&n.flags===a.flags;if(n.valueOf!==Object.prototype.valueOf&&"function"==typeof n.valueOf&&"function"==typeof a.valueOf)return n.valueOf()===a.valueOf();if(n.toString!==Object.prototype.toString&&"function"==typeof n.toString&&"function"==typeof a.toString)return n.toString()===a.toString();if((o=(l=Object.keys(n)).length)!==Object.keys(a).length)return!1;for(c=o;0!==c--;)if(!Object.prototype.hasOwnProperty.call(a,l[c]))return!1;if(e&&n instanceof Element)return!1;for(c=o;0!==c--;)if(("_owner"!==l[c]&&"__v"!==l[c]&&"__o"!==l[c]||!n.$$typeof)&&!i(n[l[c]],a[l[c]]))return!1;return!0}return n!=n&&a!=a}return Jn=function(e,t){try{return i(e,t)}catch(r){if((r.message||"").match(/stack|recursion/i))return!1;throw r}}}());var Xn,Qn;const ea=F(Qn?Xn:(Qn=1,Xn=function(e,t,r,s,i,n,a,o){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[r,s,i,n,a,o],d=0;(c=new Error(t.replace(/%s/g,function(){return l[d++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}}));var ta,ra;const sa=F(ra?ta:(ra=1,ta=function(e,t,r,s){var i=r?r.call(s,e,t):void 0;if(void 0!==i)return!!i;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(var o=Object.prototype.hasOwnProperty.bind(t),c=0;c<n.length;c++){var l=n[c];if(!o(l))return!1;var d=e[l],u=t[l];if(!1===(i=r?r.call(s,d,u,l):void 0)||void 0===i&&d!==u)return!1}return!0}));var ia=(e=>(e.BASE="base",e.BODY="body",e.HEAD="head",e.HTML="html",e.LINK="link",e.META="meta",e.NOSCRIPT="noscript",e.SCRIPT="script",e.STYLE="style",e.TITLE="title",e.FRAGMENT="Symbol(react.fragment)",e))(ia||{}),na={rel:["amphtml","canonical","alternate"]},aa={type:["application/ld+json"]},oa={charset:"",name:["generator","robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]},ca=Object.values(ia),la={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},da=Object.entries(la).reduce((e,[t,r])=>(e[r]=t,e),{}),ua="data-rh",ha="defaultTitle",ma="defer",pa="encodeSpecialCharacters",fa="onChangeClientState",ga="titleTemplate",ya="prioritizeSeoTags",va=(e,t)=>{for(let r=e.length-1;r>=0;r-=1){const s=e[r];if(Object.prototype.hasOwnProperty.call(s,t))return s[t]}return null},ba=e=>{let t=va(e,"title");const r=va(e,ga);if(Array.isArray(t)&&(t=t.join("")),r&&t)return r.replace(/%s/g,()=>t);const s=va(e,ha);return t||s||void 0},wa=e=>va(e,fa)||(()=>{}),xa=(e,t)=>t.filter(t=>void 0!==t[e]).map(t=>t[e]).reduce((e,t)=>({...e,...t}),{}),_a=(e,t)=>t.filter(e=>void 0!==e.base).map(e=>e.base).reverse().reduce((t,r)=>{if(!t.length){const s=Object.keys(r);for(let i=0;i<s.length;i+=1){const n=s[i].toLowerCase();if(-1!==e.indexOf(n)&&r[n])return t.concat(r)}}return t},[]),Sa=(e,t,r)=>{const s={};return r.filter(t=>!!Array.isArray(t[e])||(void 0!==t[e]&&(t[e],console&&console.warn),!1)).map(t=>t[e]).reverse().reduce((e,r)=>{const i={};r.filter(e=>{let r;const n=Object.keys(e);for(let s=0;s<n.length;s+=1){const i=n[s],a=i.toLowerCase();-1===t.indexOf(a)||"rel"===r&&"canonical"===e[r].toLowerCase()||"rel"===a&&"stylesheet"===e[a].toLowerCase()||(r=a),-1===t.indexOf(i)||"innerHTML"!==i&&"cssText"!==i&&"itemprop"!==i||(r=i)}if(!r||!e[r])return!1;const a=e[r].toLowerCase();return s[r]||(s[r]={}),i[r]||(i[r]={}),!s[r][a]&&(i[r][a]=!0,!0)}).reverse().forEach(t=>e.push(t));const n=Object.keys(i);for(let t=0;t<n.length;t+=1){const e=n[t],r={...s[e],...i[e]};s[e]=r}return e},[]).reverse()},Ea=(e,t)=>{if(Array.isArray(e)&&e.length)for(let r=0;r<e.length;r+=1){if(e[r][t])return!0}return!1},Ta=e=>Array.isArray(e)?e.join(""):e,ka=(e,t)=>Array.isArray(e)?e.reduce((e,r)=>(((e,t)=>{const r=Object.keys(e);for(let s=0;s<r.length;s+=1)if(t[r[s]]&&t[r[s]].includes(e[r[s]]))return!0;return!1})(r,t)?e.priority.push(r):e.default.push(r),e),{priority:[],default:[]}):{default:e,priority:[]},Aa=(e,t)=>({...e,[t]:void 0}),ja=["noscript","script","style"],Oa=(e,t=!0)=>!1===t?String(e):String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),Pa=e=>Object.keys(e).reduce((t,r)=>{const s=void 0!==e[r]?`${r}="${e[r]}"`:`${r}`;return t?`${t} ${s}`:s},""),Ca=(e,t={})=>Object.keys(e).reduce((t,r)=>(t[la[r]||r]=e[r],t),t),Ra=(e,t)=>t.map((t,r)=>{const s={key:r,[ua]:!0};return Object.keys(t).forEach(e=>{const r=la[e]||e;if("innerHTML"===r||"cssText"===r){const e=t.innerHTML||t.cssText;s.dangerouslySetInnerHTML={__html:e}}else s[r]=t[e]}),N.createElement(e,s)}),Na=(e,t,r=!0)=>{switch(e){case"title":return{toComponent:()=>((e,t,r)=>{const s=Ca(r,{key:t,[ua]:!0});return[N.createElement("title",s,t)]})(0,t.title,t.titleAttributes),toString:()=>((e,t,r,s)=>{const i=Pa(r),n=Ta(t);return i?`<${e} ${ua}="true" ${i}>${Oa(n,s)}</${e}>`:`<${e} ${ua}="true">${Oa(n,s)}</${e}>`})(e,t.title,t.titleAttributes,r)};case"bodyAttributes":case"htmlAttributes":return{toComponent:()=>Ca(t),toString:()=>Pa(t)};default:return{toComponent:()=>Ra(e,t),toString:()=>((e,t,r=!0)=>t.reduce((t,s)=>{const i=s,n=Object.keys(i).filter(e=>!("innerHTML"===e||"cssText"===e)).reduce((e,t)=>{const s=void 0===i[t]?t:`${t}="${Oa(i[t],r)}"`;return e?`${e} ${s}`:s},""),a=i.innerHTML||i.cssText||"",o=-1===ja.indexOf(e);return`${t}<${e} ${ua}="true" ${n}${o?"/>":`>${a}</${e}>`}`},""))(e,t,r)}}},Ia=e=>{const{baseTag:t,bodyAttributes:r,encode:s=!0,htmlAttributes:i,noscriptTags:n,styleTags:a,title:o="",titleAttributes:c,prioritizeSeoTags:l}=e;let{linkTags:d,metaTags:u,scriptTags:h}=e,m={toComponent:()=>{},toString:()=>""};return l&&({priorityMethods:m,linkTags:d,metaTags:u,scriptTags:h}=(({metaTags:e,linkTags:t,scriptTags:r,encode:s})=>{const i=ka(e,oa),n=ka(t,na),a=ka(r,aa);return{priorityMethods:{toComponent:()=>[...Ra("meta",i.priority),...Ra("link",n.priority),...Ra("script",a.priority)],toString:()=>`${Na("meta",i.priority,s)} ${Na("link",n.priority,s)} ${Na("script",a.priority,s)}`},metaTags:i.default,linkTags:n.default,scriptTags:a.default}})(e)),{priority:m,base:Na("base",t,s),bodyAttributes:Na("bodyAttributes",r,s),htmlAttributes:Na("htmlAttributes",i,s),link:Na("link",d,s),meta:Na("meta",u,s),noscript:Na("noscript",n,s),script:Na("script",h,s),style:Na("style",a,s),title:Na("title",{title:o,titleAttributes:c},s)}},Da=[],La=!("undefined"==typeof window||!window.document||!window.document.createElement),$a=class{instances=[];canUseDOM=La;context;value={setHelmet:e=>{this.context.helmet=e},helmetInstances:{get:()=>this.canUseDOM?Da:this.instances,add:e=>{(this.canUseDOM?Da:this.instances).push(e)},remove:e=>{const t=(this.canUseDOM?Da:this.instances).indexOf(e);(this.canUseDOM?Da:this.instances).splice(t,1)}}};constructor(e,t){this.context=e,this.canUseDOM=t||!1,t||(e.helmet=Ia({baseTag:[],bodyAttributes:{},htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))}},Ua=N.createContext({}),Ma=class e extends R.Component{static canUseDOM=La;helmetData;constructor(t){super(t),this.helmetData=new $a(this.props.context||{},e.canUseDOM)}render(){return N.createElement(Ua.Provider,{value:this.helmetData.value},this.props.children)}},Fa=(e,t)=>{const r=document.head||document.querySelector("head"),s=r.querySelectorAll(`${e}[${ua}]`),i=[].slice.call(s),n=[];let a;return t&&t.length&&t.forEach(t=>{const r=document.createElement(e);for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))if("innerHTML"===e)r.innerHTML=t.innerHTML;else if("cssText"===e)r.styleSheet?r.styleSheet.cssText=t.cssText:r.appendChild(document.createTextNode(t.cssText));else{const s=e,i=void 0===t[s]?"":t[s];r.setAttribute(e,i)}r.setAttribute(ua,"true"),i.some((e,t)=>(a=t,r.isEqualNode(e)))?i.splice(a,1):n.push(r)}),i.forEach(e=>e.parentNode?.removeChild(e)),n.forEach(e=>r.appendChild(e)),{oldTags:i,newTags:n}},Ba=(e,t)=>{const r=document.getElementsByTagName(e)[0];if(!r)return;const s=r.getAttribute(ua),i=s?s.split(","):[],n=[...i],a=Object.keys(t);for(const o of a){const e=t[o]||"";r.getAttribute(o)!==e&&r.setAttribute(o,e),-1===i.indexOf(o)&&i.push(o);const s=n.indexOf(o);-1!==s&&n.splice(s,1)}for(let o=n.length-1;o>=0;o-=1)r.removeAttribute(n[o]);i.length===n.length?r.removeAttribute(ua):r.getAttribute(ua)!==a.join(",")&&r.setAttribute(ua,a.join(","))},Ha=(e,t)=>{const{baseTag:r,bodyAttributes:s,htmlAttributes:i,linkTags:n,metaTags:a,noscriptTags:o,onChangeClientState:c,scriptTags:l,styleTags:d,title:u,titleAttributes:h}=e;Ba("body",s),Ba("html",i),((e,t)=>{void 0!==e&&document.title!==e&&(document.title=Ta(e)),Ba("title",t)})(u,h);const m={baseTag:Fa("base",r),linkTags:Fa("link",n),metaTags:Fa("meta",a),noscriptTags:Fa("noscript",o),scriptTags:Fa("script",l),styleTags:Fa("style",d)},p={},f={};Object.keys(m).forEach(e=>{const{newTags:t,oldTags:r}=m[e];t.length&&(p[e]=t),r.length&&(f[e]=m[e].oldTags)}),t&&t(),c(e,p,f)},za=null,Ga=e=>{za&&cancelAnimationFrame(za),e.defer?za=requestAnimationFrame(()=>{Ha(e,()=>{za=null})}):(Ha(e),za=null)},Wa=class extends R.Component{rendered=!1;shouldComponentUpdate(e){return!sa(e,this.props)}componentDidUpdate(){this.emitChange()}componentWillUnmount(){const{helmetInstances:e}=this.props.context;e.remove(this),this.emitChange()}emitChange(){const{helmetInstances:e,setHelmet:t}=this.props.context;let r=null;const s=(i=e.get().map(e=>{const t={...e.props};return delete t.context,t}),{baseTag:_a(["href"],i),bodyAttributes:xa("bodyAttributes",i),defer:va(i,ma),encode:va(i,pa),htmlAttributes:xa("htmlAttributes",i),linkTags:Sa("link",["rel","href"],i),metaTags:Sa("meta",["name","charset","http-equiv","property","itemprop"],i),noscriptTags:Sa("noscript",["innerHTML"],i),onChangeClientState:wa(i),scriptTags:Sa("script",["src","innerHTML"],i),styleTags:Sa("style",["cssText"],i),title:ba(i),titleAttributes:xa("titleAttributes",i),prioritizeSeoTags:Ea(i,ya)});var i;Ma.canUseDOM?Ga(s):Ia&&(r=Ia(s)),t(r)}init(){if(this.rendered)return;this.rendered=!0;const{helmetInstances:e}=this.props.context;e.add(this),this.emitChange()}render(){return this.init(),null}},Va=class extends R.Component{static defaultProps={defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1};shouldComponentUpdate(e){return!Zn(Aa(this.props,"helmetData"),Aa(e,"helmetData"))}mapNestedChildrenToProps(e,t){if(!t)return null;switch(e.type){case"script":case"noscript":return{innerHTML:t};case"style":return{cssText:t};default:throw new Error(`<${e.type} /> elements are self-closing and can not contain children. Refer to our API for more information.`)}}flattenArrayTypeChildren(e,t,r,s){return{...t,[e.type]:[...t[e.type]||[],{...r,...this.mapNestedChildrenToProps(e,s)}]}}mapObjectTypeChildren(e,t,r,s){switch(e.type){case"title":return{...t,[e.type]:s,titleAttributes:{...r}};case"body":return{...t,bodyAttributes:{...r}};case"html":return{...t,htmlAttributes:{...r}};default:return{...t,[e.type]:{...r}}}}mapArrayTypeChildrenToProps(e,t){let r={...t};return Object.keys(e).forEach(t=>{r={...r,[t]:e[t]}}),r}warnOnInvalidChildren(e,t){return ea(ca.some(t=>e.type===t),"function"==typeof e.type?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":`Only elements types ${ca.join(", ")} are allowed. Helmet does not support rendering <${e.type}> elements. Refer to our API for more information.`),ea(!t||"string"==typeof t||Array.isArray(t)&&!t.some(e=>"string"!=typeof e),`Helmet expects a string as a child of <${e.type}>. Did you forget to wrap your children in braces? ( <${e.type}>{\`\`}</${e.type}> ) Refer to our API for more information.`),!0}mapChildrenToProps(e,t){let r={};return N.Children.forEach(e,e=>{if(!e||!e.props)return;const{children:s,...i}=e.props,n=Object.keys(i).reduce((e,t)=>(e[da[t]||t]=i[t],e),{});let{type:a}=e;switch("symbol"==typeof a?a=a.toString():this.warnOnInvalidChildren(e,s),a){case"Symbol(react.fragment)":t=this.mapChildrenToProps(s,t);break;case"link":case"meta":case"noscript":case"script":case"style":r=this.flattenArrayTypeChildren(e,r,n,s);break;default:t=this.mapObjectTypeChildren(e,t,n,s)}}),this.mapArrayTypeChildrenToProps(r,t)}render(){const{children:e,...t}=this.props;let r={...t},{helmetData:s}=t;if(e&&(r=this.mapChildrenToProps(e,r)),s&&!(s instanceof $a)){s=new $a(s.context,!0),delete r.helmetData}return s?N.createElement(Wa,{...r,context:s.value}):N.createElement(Ua.Consumer,null,e=>N.createElement(Wa,{...r,context:e}))}};const qa={name:"IVolex"};function Ka({children:t}){return e.jsx(Ma,{children:t})}function Ja({title:t,description:r,keywords:s,image:i,url:n,type:a="website",noindex:o=!1,canonical:c,alternateLanguages:l,structuredData:d}){const u=qa.name,h=t?`${t} | ${u}`:u,m=n||("undefined"!=typeof window?window.location.href:""),p=r||"Premium leather goods crafted with attention to detail. Shop our collection of leather bags, belts, wallets, and footwear.",f=i||"/images/og-image.jpg",g=f.startsWith("http")?f:`${"undefined"!=typeof window?window.location.origin:""}${f}`,y=["leather goods","leather bags","leather belts","leather wallets","leather footwear","premium leather","handcrafted leather","luxury accessories"],v=s?[...s,...y]:y;return e.jsxs(Va,{children:[e.jsx("title",{children:h}),e.jsx("meta",{name:"description",content:p}),e.jsx("meta",{name:"keywords",content:v.join(", ")}),c&&e.jsx("link",{rel:"canonical",href:c}),e.jsx("meta",{name:"robots",content:o?"noindex,nofollow":"index,follow"}),e.jsx("meta",{property:"og:type",content:a}),e.jsx("meta",{property:"og:title",content:h}),e.jsx("meta",{property:"og:description",content:p}),e.jsx("meta",{property:"og:image",content:g}),e.jsx("meta",{property:"og:url",content:m}),e.jsx("meta",{property:"og:site_name",content:u}),e.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),e.jsx("meta",{name:"twitter:title",content:h}),e.jsx("meta",{name:"twitter:description",content:p}),e.jsx("meta",{name:"twitter:image",content:g}),e.jsx("meta",{name:"author",content:u}),e.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"}),e.jsx("meta",{httpEquiv:"Content-Language",content:"en"}),l&&l.map(t=>e.jsx("link",{rel:"alternate",hrefLang:t.hreflang,href:t.href},t.hreflang)),d&&e.jsx("script",{type:"application/ld+json",children:JSON.stringify(d)})]})}const Ya=R.lazy(()=>q(()=>import("./index-DEuKUYMk.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]),import.meta.url)),Za=R.lazy(()=>q(()=>import("./index-RE76x7Xw.js"),__vite__mapDeps([9,1,2,3,5,4,6,8]),import.meta.url)),Xa=R.lazy(()=>q(()=>import("./index-DahDUUx4.js"),__vite__mapDeps([10,1,2,3,5,4,6,8]),import.meta.url)),Qa=R.lazy(()=>q(()=>import("./index-DiSeqCTk.js"),__vite__mapDeps([11,1,2,3,5,8]),import.meta.url)),eo=R.lazy(()=>q(()=>import("./index-Wgj6KwTe.js"),__vite__mapDeps([12,1,2,3,8]),import.meta.url)),to=R.lazy(()=>q(()=>import("./index-BhYLaJ33.js"),__vite__mapDeps([13,1,2,3,8]),import.meta.url)),ro=R.lazy(()=>q(()=>import("./index-BpR62VLZ.js"),__vite__mapDeps([14,1,2,3,8]),import.meta.url)),so=R.lazy(()=>q(()=>import("./index-DA7mI3mI.js"),__vite__mapDeps([15,1,2,3,8]),import.meta.url)),io=R.lazy(()=>q(()=>import("./index-7LxpwIIr.js"),__vite__mapDeps([16,1,2,3,8]),import.meta.url)),no=R.lazy(()=>q(()=>import("./index-BUYbulB-.js"),__vite__mapDeps([17,1,2,3,8]),import.meta.url)),ao=R.lazy(()=>q(()=>import("./index-B6nXnTW6.js"),__vite__mapDeps([18,1,2,3,8]),import.meta.url)),oo=R.lazy(()=>q(()=>import("./index-B1YrhCbm.js"),__vite__mapDeps([19,1,2,3,6,8]),import.meta.url)),co=R.lazy(()=>q(()=>import("./index-b-n7tYlV.js"),__vite__mapDeps([20,1,2,3,8]),import.meta.url)),lo=R.lazy(()=>q(()=>import("./index-BtwGgWBW.js"),__vite__mapDeps([21,1,2,3,8]),import.meta.url)),uo=R.lazy(()=>q(()=>import("./index-CDt0YFxk.js"),__vite__mapDeps([22,1,2,3,8]),import.meta.url)),ho=R.lazy(()=>q(()=>import("./TrackingPage-CWhtBZv6.js"),__vite__mapDeps([23,1,2,3,8]),import.meta.url)),mo=R.lazy(()=>q(()=>import("./AdminPanel-BH2IPLDL.js"),__vite__mapDeps([24,1,2,3,25,8]),import.meta.url)),po=R.lazy(()=>q(()=>import("./AdminLogin-tkM5htSf.js"),__vite__mapDeps([26,1,2,3,25,8]),import.meta.url)),fo=R.lazy(()=>q(()=>import("./AuthScreen-iLidhm7N.js"),__vite__mapDeps([27,1,2,3,8]),import.meta.url)),go=R.lazy(()=>q(()=>import("./index-0GozZ-s-.js"),__vite__mapDeps([28,1,2,3,8]),import.meta.url));function yo(){return e.jsxs("div",{className:"flex items-center justify-center min-h-[50vh]",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-600"}),e.jsx("span",{className:"ml-3 text-stone-600 dark:text-stone-400",children:"Loading..."})]})}function vo(){return function(){const[e,t]=R.useState({fcp:null,lcp:null,fid:null,cls:null,ttfb:null});R.useEffect(()=>{if("undefined"==typeof window)return;const e=performance.getEntriesByType("navigation")[0];if(e&&t(t=>({...t,ttfb:e.responseStart-e.requestStart})),"PerformanceObserver"in window){const e=new PerformanceObserver(e=>{const r=e.getEntries().find(e=>"first-contentful-paint"===e.name);r&&t(e=>({...e,fcp:r.startTime}))}),s=new PerformanceObserver(e=>{const r=e.getEntries(),s=r[r.length-1];t(e=>({...e,lcp:s.startTime}))}),i=new PerformanceObserver(e=>{const r=e.getEntries()[0];t(e=>({...e,fid:r.processingStart-r.startTime}))}),n=new PerformanceObserver(e=>{let r=0;const s=e.getEntries();for(const t of s)t.hadRecentInput||(r+=t.value);t(e=>({...e,cls:r}))});try{e.observe({entryTypes:["paint"]}),s.observe({entryTypes:["largest-contentful-paint"]}),i.observe({entryTypes:["first-input"]}),n.observe({entryTypes:["layout-shift"]})}catch(r){}return()=>{e.disconnect(),s.disconnect(),i.disconnect(),n.disconnect()}}},[]),R.useEffect(()=>{},[e])}(),e.jsx(Cn,{children:e.jsx(Rn,{children:e.jsx(ge,{children:e.jsx(Fn,{children:e.jsx(te,{children:e.jsx(On,{children:e.jsx(Ka,{children:e.jsx(Gi,{children:e.jsx(pi,{children:e.jsx(Re,{children:e.jsx(Sn,{children:e.jsx(Le,{children:e.jsx(An,{children:e.jsx(ln,{children:e.jsx(Yi,{children:e.jsx(D,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:e.jsx(Ni,{children:e.jsx(Nn,{children:e.jsxs("div",{className:"min-h-screen w-full h-full transition-all duration-500 flex flex-col",children:[e.jsx(Bn,{}),e.jsx($i,{}),e.jsx("main",{id:"main",className:"pt-14 w-full h-full flex-grow",children:e.jsx(Hn,{children:e.jsx(R.Suspense,{fallback:e.jsx(yo,{}),children:e.jsxs(L,{children:[e.jsx($,{path:"/",element:e.jsx(Ya,{})}),e.jsx($,{path:"/leather",element:e.jsx(Ya,{})}),e.jsx($,{path:"/electronics",element:e.jsx(Ya,{})}),e.jsx($,{path:"/furniture",element:e.jsx(Ya,{})}),e.jsx($,{path:"/shop",element:e.jsx(Xa,{})}),e.jsx($,{path:"/category/:category",element:e.jsx(Za,{})}),e.jsx($,{path:"/product/:id",element:e.jsx(Qa,{})}),e.jsx($,{path:"/cart",element:e.jsx(eo,{})}),e.jsx($,{path:"/checkout",element:e.jsx(to,{})}),e.jsx($,{path:"/customize",element:e.jsx(ro,{})}),e.jsx($,{path:"/about",element:e.jsx(so,{})}),e.jsx($,{path:"/contact",element:e.jsx(io,{})}),e.jsx($,{path:"/login",element:e.jsx(no,{})}),e.jsx($,{path:"/register",element:e.jsx(ao,{})}),e.jsx($,{path:"/auth",element:e.jsx(fo,{})}),e.jsx($,{path:"/profile",element:e.jsx(oo,{})}),e.jsx($,{path:"/account/*",element:e.jsx(lo,{})}),e.jsx($,{path:"/track/:requestId",element:e.jsx(uo,{})}),e.jsx($,{path:"/track-shipment",element:e.jsx(ho,{})}),e.jsx($,{path:"/order-confirmation",element:e.jsx(co,{})}),e.jsx($,{path:"/admin/login",element:e.jsx(po,{})}),e.jsx($,{path:"/admin/*",element:e.jsx(mo,{})}),e.jsx($,{path:"*",element:e.jsx(go,{})})]})})})}),e.jsx(qi,{}),e.jsx(Kn,{})]})})})})})})})})})})})})})})})})})})})}const bo=document.getElementById("root");W.createRoot(bo).render(e.jsx(N.StrictMode,{children:e.jsx(vo,{})}));export{fn as A,Vi as C,mn as P,hn as R,ne as S,zi as a,Gn as b,Wn as c,qn as d,Ja as e,Zi as f,mi as g,dn as h,ye as i,Wi as j,kn as k,Ne as l,En as m,pn as n,De as o,Vn as s,re as u};
//# sourceMappingURL=index-rb2YAFFb.js.map
